#include <catch2/catch_test_macros.hpp>
#include <catch2/matchers/catch_matchers_floating_point.hpp>

#include <votess.hpp>

///////////////////////////////////////////////////////////////////////////////
/// Forward Declarations                                                    ///
///////////////////////////////////////////////////////////////////////////////

template <typename T>
static void test_votess(
  std::vector<std::array<T,3>>& xyzset,
  const int k,
  const int gr
);

///////////////////////////////////////////////////////////////////////////////
/// Test Cases                                                              ///
///////////////////////////////////////////////////////////////////////////////

TEST_CASE("votess regression 0: standard", "[votess]") {

  const int k = 9;
  std::vector<std::array<float, 3>> xyzset = {
    {0.605223f, 0.108484f, 0.090937f},
    {0.500792f, 0.499641f, 0.464576f},
    {0.437936f, 0.786332f, 0.160392f},
    {0.663354f, 0.170894f, 0.810284f},
    {0.614869f, 0.096867f, 0.204147f},
    {0.556911f, 0.895342f, 0.802266f},
    {0.305748f, 0.124146f, 0.516249f},
    {0.406888f, 0.157835f, 0.919622f},
    {0.094412f, 0.861991f, 0.798644f},
    {0.511958f, 0.560537f, 0.345479f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 1: random", "[votess]") {

  const int k = 127;
  std::vector<std::array<float, 3>> xyzset = {
    {0.7888240824540148f, 0.5307363099286432f, 0.4887515662282116f},
    {0.6700657775702665f, 0.4258580302349553f, 0.5581741718122655f},
    {0.14053428439368776f, 0.7655169891580806f, 0.7277632253819307f},
    {0.540012643286218f, 0.08962538082292948f, 0.5795276801948223f},
    {0.708866549827761f, 0.5156878092405777f, 0.3398345129167476f},
    {0.40525962641412805f, 0.9321107424026711f, 0.8238842858018028f},
    {0.04611191401828507f, 0.7862799104619224f, 0.47545381750004f},
    {0.9748751052611975f, 0.8104136157546431f, 0.053928018048888915f},
    {0.8196260356632564f, 0.27145371675787255f, 0.5317773816243264f},
    {0.5997503127502979f, 0.9032307100835764f, 0.37737949611116883f},
    {0.3498800183691285f, 0.0017921517954772037f, 0.4083525960821497f},
    {0.2932464809901454f, 0.13708017211264334f, 0.3535393804025465f},
    {0.9585284261937328f, 0.6383122971309794f, 0.8179983256562645f},
    {0.5701137989163526f, 0.6864650273297392f, 0.47872515643655056f},
    {0.04037823577490862f, 0.587263641714523f, 0.7621209482460144f},
    {0.5764176110102233f, 0.8418987081629847f, 0.4936286293295069f},
    {0.24010523868581013f, 0.0900697328761405f, 0.8759299095994562f},
    {0.7804167185819638f, 0.7484675643557933f, 0.9961920302270494f},
    {0.8006987041778861f, 0.9598098069460701f, 0.4469443386008848f},
    {0.855438663791073f, 0.946334570874412f, 0.32192719282393456f},
    {0.38841123463792593f, 0.1483283652823676f, 0.7156176504706947f},
    {0.7677899504841567f, 0.7925806836918255f, 0.23916854275563082f},
    {0.965868186414994f, 0.7311909984800617f, 0.1259827699888938f},
    {0.5014661405295521f, 0.3157731671176044f, 0.06297514218132128f},
    {0.6024887507347746f, 0.043945038517550494f, 0.6287620792598145f},
    {0.12562153894464612f, 0.019693271176857707f, 0.29213423599774f},
    {0.610164498388337f, 0.4817032299057865f, 0.7004954518160909f},
    {0.3118661844654237f, 0.10298732121833398f, 0.020057179386010482f},
    {0.9411185828368667f, 0.5792986052281193f, 0.31406253816192764f},
    {0.037120158095119815f, 0.10932830043553177f, 0.32315930623888156f},
    {0.6911505395618687f, 0.8978048174066023f, 0.551274256278017f},
    {0.568409778048001f, 0.18904382944671982f, 0.4608939458486715f},
    {0.08811243970056737f, 0.1487445819066625f, 0.6232933645784191f},
    {0.6908963949878036f, 0.8198004181078372f, 0.3547587790047988f},
    {0.4109611815270253f, 0.035924752037579055f, 0.8246485512535263f},
    {0.5576864123047728f, 0.8671970851568522f, 0.14236516565466917f},
    {0.3063096392268224f, 0.7284175420490245f, 0.5938784110990578f},
    {0.9012246583388857f, 0.12661194363980466f, 0.77758776122496f},
    {0.5662673755134271f, 0.2744643777323501f, 0.7745413853081101f},
    {0.04690886432971453f, 0.7947832942566697f, 0.47370845348610946f},
    {0.4209000683977874f, 0.07417277804625211f, 0.6685346901598467f},
    {0.12614785016732355f, 0.8184314812281367f, 0.7769683563831435f},
    {0.21974600775929642f, 0.3423092794786271f, 0.9929477924026572f},
    {0.8490990783164203f, 0.49038368392592047f, 0.6002129038651158f},
    {0.9793118568206873f, 0.5121383802322869f, 0.42152757333359936f},
    {0.19546268404035072f, 0.19751713314764707f, 0.322674936093837f},
    {0.1618603980317509f, 0.18109158014371107f, 0.45613597225760416f},
    {0.9577473965864665f, 0.6157789352040999f, 0.04890393601217791f},
    {0.0641453442434059f, 0.36080836274444106f, 0.28879399125192495f},
    {0.7880626488252522f, 0.005437288610686042f, 0.11227082251262488f},
    {0.8309134046925591f, 0.9848660574365673f, 0.5917799895605756f},
    {0.6060927007097697f, 0.973067336122989f, 0.1517911590590465f},
    {0.21285014778617528f, 0.5333705539983014f, 0.41599336086557415f},
    {0.09581283908872451f, 0.18522841748471364f, 0.6306197030407557f},
    {0.945186325186187f, 0.7009736408166404f, 0.6595532719737842f},
    {0.54334918128234f, 0.10614960780266847f, 0.4840059031496855f},
    {0.3470205235414131f, 0.11973192709426805f, 0.9346042889070658f},
    {0.08942974938710369f, 0.2358659360055072f, 0.7755863205007866f},
    {0.45041550248766893f, 0.1411942300209882f, 0.778997256348827f},
    {0.7517124675089982f, 0.9724377245651545f, 0.742172111524968f},
    {0.8046056036367499f, 0.7693443591877561f, 0.7821934170262992f},
    {0.32289227771034645f, 0.9440557756617464f, 0.2752170363543306f},
    {0.12223838054197034f, 0.26042971777148616f, 0.355186984738075f},
    {0.4280452931949337f, 0.3738879607868135f, 0.1033750348411625f},
    {0.4270728721790841f, 0.552643770947419f, 0.2991444074974434f},
    {0.19783492090568022f, 0.6599389055153827f, 0.5364263043611445f},
    {0.6016643915641391f, 0.025848298319709695f, 0.5711798297044739f},
    {0.7754485994572728f, 0.4532797099069602f, 0.2953189404874287f},
    {0.5017526829934009f, 0.05304830863102583f, 0.6561485138255059f},
    {0.9829182164201893f, 0.14750007711423518f, 0.9156020459133569f},
    {0.4625376123472058f, 0.2947220338632309f, 0.2705539415021476f},
    {0.005246935282839593f, 0.19355662512399507f, 0.362066920593172f},
    {0.8238809538113158f, 0.46693521634052615f, 0.10765025309634191f},
    {0.1883239211093417f, 0.423644800926675f, 0.4756268881941923f},
    {0.22881672840447687f, 0.20779362386739286f, 0.4946291377972716f},
    {0.2172160378361726f, 0.07448148083194561f, 0.6557487017660922f},
    {0.6954734562437852f, 0.4002410038967089f, 0.6540304115301873f},
    {0.17531910606119705f, 0.34358387693690196f, 0.3818331069940034f},
    {0.3673666760746641f, 0.4600668856786144f, 0.19963573236871845f},
    {0.30006114845784915f, 0.2176886588012008f, 0.45752004366154464f},
    {0.321891610255463f, 0.8219210152977944f, 0.5155008277644249f},
    {0.36669849981967795f, 0.4468801279638345f, 0.1521405300450145f},
    {0.5562206013037415f, 0.7489363898518654f, 0.39063672071023603f},
    {0.11571077504755589f, 0.13762812553881087f, 0.9748226350641462f},
    {0.4066451467265759f, 0.44526576704954035f, 0.6958543728435189f},
    {0.030317883519111466f, 0.9805277113760279f, 0.8455219555976677f},
    {0.049369858513988785f, 0.9761331316499124f, 0.6498499789391853f},
    {0.468501068927327f, 0.5117714040818042f, 0.10477923649827325f},
    {0.7419385106769164f, 0.43793456944365505f, 0.43448017534898487f},
    {0.2783760730808017f, 0.9340115289896729f, 0.714693100358747f},
    {0.3496057203997289f, 0.47586539894549007f, 0.20784068789941468f},
    {0.8112074361352511f, 0.10136863699962129f, 0.6353775561178476f},
    {0.7015845486769668f, 0.6912899954475559f, 0.8100941030809793f},
    {0.6207465148206953f, 0.7364771298318211f, 0.21222432886490772f},
    {0.6776378676060044f, 0.9962463409787311f, 0.27690016873298606f},
    {0.6661703446007141f, 0.7283495636564004f, 0.6420229833757501f},
    {0.9906882309292958f, 0.42397084945921026f, 0.7033452195949121f},
    {0.37518219640910944f, 0.3530313373951137f, 0.6435614990417784f},
    {0.32601669900003016f, 0.5605117227070157f, 0.1419791508850915f},
    {0.13415780475393135f, 0.7078549332636597f, 0.9395534202482416f},
    {0.5988461368441113f, 0.44757831644531676f, 0.452864035632226f},
    {0.6991647431295348f, 0.02334059283132861f, 0.7547918639045218f},
    {0.3011603305081487f, 0.2315534165026799f, 0.3893524354921236f},
    {0.3117637657705228f, 0.8604471911468353f, 0.8905581296271917f},
    {0.21378236647328996f, 0.5601885298005125f, 0.41158030805574786f},
    {0.30703897895055887f, 0.8728117294408282f, 0.5668553255004617f},
    {0.4827155063706664f, 0.3100065003436763f, 0.3648428141578155f},
    {0.5610784344073523f, 0.27788841260907626f, 0.165673080351888f},
    {0.7128461405674444f, 0.8565303214597473f, 0.2800192850021308f},
    {0.41593804191703654f, 0.07994313592140645f, 0.352834652861059f},
    {0.3592056355190961f, 0.4433638887675221f, 0.45392041788439896f},
    {0.9063616781824285f, 0.4189333838054632f, 0.6154546353906862f},
    {0.5067654067785504f, 0.6030925378983977f, 0.6796530047547303f},
    {0.9033763927165592f, 0.30661917947846595f, 0.795398661585264f},
    {0.8794973082128826f, 0.7956591654577875f, 0.9797965338413908f},
    {0.151094564436284f, 0.47658355499332616f, 0.09709086740395478f},
    {0.7806302545232408f, 0.2899532098830776f, 0.5586324258279597f},
    {0.44006414595208565f, 0.8289146627698424f, 0.010272167052066683f},
    {0.7897218927096682f, 0.22915070795571113f, 0.9673930398655678f},
    {0.6473637061699604f, 0.5666362781449954f, 0.017109898978960536f},
    {0.4176819415004247f, 0.5344679193216317f, 0.6810807977658848f},
    {0.5533130824849959f, 0.7390298958361343f, 0.6902860371003091f},
    {0.612899298973357f, 0.4461795788791353f, 0.4928067625448379f},
    {0.5998591526964903f, 0.7259924643307311f, 0.0810210161761653f},
    {0.06420171347284231f, 0.9811640548358382f, 0.7835195652804208f},
    {0.746184738582705f, 0.46748720426156054f, 0.7250215191138611f},
    {0.7857921684158806f, 0.30485445286022905f, 0.2163952912824505f},
    {0.09551220761660106f, 0.855524804649347f, 0.01663791020997385f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 2: random", "[votess]") {

  const int k = 127;
  std::vector<std::array<float, 3>> xyzset = {
    {0.11989381488151529f, 0.4372466736520215f, 0.8611704643624735f},
    {0.9041514153001688f, 0.3871094904094716f, 0.3476528717386739f},
    {0.2666574379634825f, 0.20256859304859254f, 0.7063249833409682f},
    {0.36518507435349123f, 0.21574903250987798f, 0.49629178674999075f},
    {0.6089931696103137f, 0.7831249552507834f, 0.056900731958127615f},
    {0.6198520644809049f, 0.8161196861852135f, 0.7361141792964236f},
    {0.10659022993398315f, 0.7539309349831862f, 0.32198302782169186f},
    {0.00029051681593550427f, 0.18303244015235964f, 0.6751383690691989f},
    {0.9471426694636289f, 0.675562810340398f, 0.9527167294613386f},
    {0.197798881678087f, 0.6075283201057776f, 0.6870873912797978f},
    {0.814047874992323f, 0.16574036052737084f, 0.36482352171379573f},
    {0.4172636231914266f, 0.6829191555755174f, 0.20216883714436706f},
    {0.6670387042016988f, 0.9580859247181959f, 0.8372557398977534f},
    {0.6512162969650294f, 0.3011854062017031f, 0.996417487147348f},
    {0.0608842382336825f, 0.31206321558533956f, 0.8049667764430218f},
    {0.8202164040870211f, 0.5253225548819235f, 0.9375660406237253f},
    {0.8324443414707069f, 0.8153651767843075f, 0.008992491550631643f},
    {0.8127810037541736f, 0.07785386606236655f, 0.7383023606396997f},
    {0.2975051206882584f, 0.3301573536255813f, 0.497828356713112f},
    {0.8380601874567468f, 0.8834384262177064f, 0.07903941607585185f},
    {0.6616661502786784f, 0.6240055702133847f, 0.08342770471451011f},
    {0.9854093477604717f, 0.27590013735951546f, 0.3228956767086072f},
    {0.23955212922816638f, 0.7439556719006296f, 0.7274427136733647f},
    {0.2610068837609747f, 0.3775346237602617f, 0.8177778878659508f},
    {0.04218125112818594f, 0.4807255604940026f, 0.6454994887601114f},
    {0.7462352096584352f, 0.2807321037492948f, 0.9748686180851992f},
    {0.0654887463754058f, 0.5654600678121127f, 0.21313470828858383f},
    {0.3297227291903295f, 0.9107805323803643f, 0.16619512647937584f},
    {0.22277075831303172f, 0.803690426313707f, 0.13584349338201274f},
    {0.6153773144853552f, 0.26758879283357595f, 0.4196311210589231f},
    {0.7815646764942932f, 0.17310900010056185f, 0.34193901288522977f},
    {0.2132312789943398f, 0.6105493445115733f, 0.5048319194915137f},
    {0.2519784799950442f, 0.8384833197194397f, 0.764659174913998f},
    {0.4895973234649039f, 0.4909681118923169f, 0.014094786497996226f},
    {0.2751335214686276f, 0.3689372596520999f, 0.9360563103181031f},
    {0.4742357143567689f, 0.12050364128314506f, 0.7544423441332523f},
    {0.40948099981557207f, 0.23655995122487805f, 0.9071058708731998f},
    {0.6165715855471733f, 0.4156710855421607f, 0.800930532146818f},
    {0.8697400012264105f, 0.9740735745561696f, 0.8909993177351131f},
    {0.8903309521616757f, 0.9094887928617905f, 0.47899348662499686f},
    {0.9879688342423923f, 0.23366549010560533f, 0.7051217547002625f},
    {0.15718894348092605f, 0.7551295745664762f, 0.06426513617011709f},
    {0.1445918853785002f, 0.8527468246564704f, 0.014901393806651342f},
    {0.7653611039017033f, 0.4776041951901917f, 0.888214886459164f},
    {0.5380197107009131f, 0.6934373929750645f, 0.03595932600957541f},
    {0.4869843472696398f, 0.7273699127397593f, 0.3666236276407633f},
    {0.3272075876454592f, 0.48175697656376637f, 0.9353070064629493f},
    {0.5152788346520066f, 0.2733813162074733f, 0.6539165119652807f},
    {0.8943078669892564f, 0.31112766365028766f, 0.2242916825625142f},
    {0.07859249948550084f, 0.018248714603435467f, 0.34373902058435835f},
    {0.5989513866037128f, 0.14616420032920585f, 0.12553538320980806f},
    {0.9105065476864763f, 0.7652063850601443f, 0.7391236165734045f},
    {0.3802760174681591f, 0.16334841828860924f, 0.5351509855394221f},
    {0.9694366462221543f, 0.16623985797442709f, 0.30356235245625496f},
    {0.14760749047916488f, 0.2948004832875788f, 0.061742113841610324f},
    {0.722087021174828f, 0.5061495305630956f, 0.25401271973923145f},
    {0.47591907246536147f, 0.8484227864244756f, 0.5979372814660892f},
    {0.6722916520824722f, 0.11488775732733425f, 0.3088168985681121f},
    {0.2774464475140699f, 0.638261737122603f, 0.5808335093889611f},
    {0.933760914322004f, 0.5076825770146334f, 0.829495523269893f},
    {0.3503997586527461f, 0.5981268093292866f, 0.3092496024258f},
    {0.16388733300842695f, 0.17943767002634536f, 0.8619294014153814f},
    {0.5943801164773018f, 0.7391492831551454f, 0.4021015775726352f},
    {0.11312824945073063f, 0.9605062630811154f, 0.40430319379534163f},
    {0.7364129846672333f, 0.2203842424430439f, 0.37672806441622153f},
    {0.9661381946289864f, 0.7793329099134383f, 0.6877217817373515f},
    {0.17647788909770157f, 0.9645439771073264f, 0.6752477498947164f},
    {0.5299222762849233f, 0.693233063051232f, 0.26854246640372204f},
    {0.40141345917997096f, 0.08984583389217204f, 0.8891484406936645f},
    {0.9164975227550841f, 0.16042350804145167f, 0.004578176606629514f},
    {0.18062391576230152f, 0.4460685318199662f, 0.4663436079208637f},
    {0.26888313261054875f, 0.9075964269446763f, 0.9997098753896478f},
    {0.7971835680657782f, 0.9721369545252551f, 0.26882947781798616f},
    {0.32002738678513476f, 0.9279100149671358f, 0.2582195405562344f},
    {0.20383757405722447f, 0.8659510995142851f, 0.5507911384135388f},
    {0.12119865369592075f, 0.9810871177424717f, 0.3419502153661097f},
    {0.9276931718686502f, 0.03463097477189914f, 0.004140050536762363f},
    {0.4483921479278258f, 0.19573626962159185f, 0.28957772901672985f},
    {0.17308815121062882f, 0.15441937661646654f, 0.24466963885252901f},
    {0.08216135237982414f, 0.6023105132724605f, 0.5771326184568053f},
    {0.6751052605194631f, 0.11738433283000216f, 0.7124643663291214f},
    {0.14150756357506689f, 0.6542976681934863f, 0.8713800604330303f},
    {0.9212781357703133f, 0.647394343168321f, 0.6454982768461549f},
    {0.6367982204042202f, 0.7841627287116918f, 0.313179090138609f},
    {0.7463517444603515f, 0.792754732931637f, 0.1453160596893064f},
    {0.06353638422616503f, 0.5085781237343328f, 0.208227203718917f},
    {0.7189319681887605f, 0.6300963401161322f, 0.7380049784911297f},
    {0.19150379008876106f, 0.5113140162350747f, 0.16813561252533016f},
    {0.2134449739995311f, 0.7208335687299982f, 0.9001903342809191f},
    {0.7786599843997674f, 0.31523358356377496f, 0.3423419879745423f},
    {0.942828439192756f, 0.44905109802543697f, 0.4594242305333438f},
    {0.42657243820990987f, 0.09458179979254278f, 0.5821467417414027f},
    {0.7144471025728333f, 0.20123310289484675f, 0.6303070869042657f},
    {0.7147609416775054f, 0.7284513531920204f, 0.3244712916867333f},
    {0.2302338422100757f, 0.1529110490187311f, 0.24440228927768626f},
    {0.9542069531431062f, 0.5094431053501391f, 0.012904079408394331f},
    {0.7224613434164227f, 0.8302121197228673f, 0.9175658166857488f},
    {0.9416873398142446f, 0.48988409713992f, 0.13250951867765104f},
    {0.6307134348910415f, 0.558231361545892f, 0.4240576278421516f},
    {0.1685595151404753f, 0.9418681359042643f, 0.5879841352404271f},
    {0.7209363283240647f, 0.5016717285803253f, 0.27924469294071164f},
    {0.854688158294286f, 0.8589998385572222f, 0.6618418230225916f},
    {0.09767671737681416f, 0.8386463451314505f, 0.891327724445743f},
    {0.2572776972253563f, 0.08523986375898895f, 0.9855203606086504f},
    {0.5039074081081714f, 0.6898068350467074f, 0.5288105624642749f},
    {0.5074713411326135f, 0.28021049704348555f, 0.4358575740272672f},
    {0.6842054622386166f, 0.3092572081061069f, 0.7388213410639969f},
    {0.8162839792251294f, 0.82796408829371f, 0.028636000874792344f},
    {0.49155447456052004f, 0.5812255498601848f, 0.658142958083529f},
    {0.041015256928147004f, 0.8022687664147612f, 0.44130920599988954f},
    {0.08672127957506115f, 0.4137932242582204f, 0.5829617823383367f},
    {0.45599824151346546f, 0.008691606959024378f, 0.3577058465176469f},
    {0.03311481054492482f, 0.5448534139141883f, 0.8691868286396823f},
    {0.42252176626190163f, 0.8730776275996603f, 0.9994413228713042f},
    {0.6988973952121715f, 0.16266938269584996f, 0.727997905314577f},
    {0.003045120370716914f, 0.3669091224427762f, 0.04952450654968843f},
    {0.28063444776851476f, 0.04865518148799253f, 0.528707480449275f},
    {0.9276936024869267f, 0.30523706250148275f, 0.8070016981555476f},
    {0.10809537012840698f, 0.5266561587576738f, 0.9380825918802314f},
    {0.4162358693815523f, 0.05866387502314052f, 0.423051742566396f},
    {0.749339680091547f, 0.4883407359182188f, 0.35184530977256134f},
    {0.40756894914164654f, 0.046170962680480265f, 0.31734394569203517f},
    {0.7681726948777179f, 0.4748086593522719f, 0.9759128887480819f},
    {0.8665822147406924f, 0.7619584282581794f, 0.9140473481726252f},
    {0.6661847852319523f, 0.6117797672080283f, 0.11108490485805f},
    {0.30638872485104907f, 0.15038657983182002f, 0.613786499828365f},
    {0.08389385574655683f, 0.05137723207808942f, 0.6507357736598158f},
    {0.5644971012024546f, 0.8035523408230696f, 0.34392388599262724f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 3: random", "[votess]") {

  const int k = 127;
  std::vector<std::array<float, 3>> xyzset = {
    {0.5330260279539091f, 0.3041155406757291f, 0.9239587222942057f},
    {0.6798100194633311f, 0.02156799572372503f, 0.11952876950341773f},
    {0.9480198476520202f, 0.2471832685846751f, 0.8612149809191373f},
    {0.49696759046491146f, 0.5606839521991686f, 0.44039622837724923f},
    {0.3266973806226545f, 0.5688026541206405f, 0.9458054065044245f},
    {0.5722676435798596f, 0.8713831406062695f, 0.14823547932737824f},
    {0.4529445914171756f, 0.3480680549027445f, 0.5163662373005697f},
    {0.9268043520753488f, 0.7002472249595829f, 0.2927984606728714f},
    {0.8888852462116607f, 0.6466104800122455f, 0.8493775016499796f},
    {0.4281087118379402f, 0.6282312417400447f, 0.647042890287788f},
    {0.35361144510062714f, 0.28525903254668494f, 0.0946302347834348f},
    {0.7418185616635453f, 0.20896323402018036f, 0.5412588188513792f},
    {0.589696349333723f, 0.7241523301091012f, 0.5838829067042008f},
    {0.6502285007922648f, 0.01856708527455808f, 0.36444746495723424f},
    {0.9454459408490924f, 0.17850113171301263f, 0.4806980744519841f},
    {0.030048433674604302f, 0.24808935784650654f, 0.4185216724166111f},
    {0.2134548046827145f, 0.47184965680868285f, 0.30521661322291715f},
    {0.17153435895918467f, 0.9168111668786096f, 0.48024202730194165f},
    {0.6772478165223035f, 0.8893184076995287f, 0.49229384729422476f},
    {0.2392735273262364f, 0.9538601628952288f, 0.5128755400944992f},
    {0.13205180563843721f, 0.9959093554579082f, 0.199060750087803f},
    {0.79584711533109f, 0.6339672986320082f, 0.012655003159256162f},
    {0.5479824337191664f, 0.9051769511029104f, 0.5750255401503899f},
    {0.9009777513841689f, 0.4553193718218945f, 0.43964446254030753f},
    {0.18365981406109821f, 0.9493686747441973f, 0.7394084797017718f},
    {0.5128679290761972f, 0.6752439186768657f, 0.9363028209619314f},
    {0.3968188365486469f, 0.45705787407100806f, 0.6787754416544272f},
    {0.674770647301034f, 0.47933737053081693f, 0.6497962623351408f},
    {0.5874290984088643f, 0.7069310160747482f, 0.730722336928804f},
    {0.22255574703310543f, 0.17205903546005763f, 0.3156571383859723f},
    {0.9744045902073534f, 0.49342894201152476f, 0.010367550886879018f},
    {0.32210929365344865f, 0.43524206739143423f, 0.8960518917442053f},
    {0.7451083189526935f, 0.9142909643108386f, 0.8947286492990112f},
    {0.18803005993065647f, 0.653319801670556f, 0.7324787684321974f},
    {0.2800488831000604f, 0.2997811055613592f, 0.654407540301182f},
    {0.38656861799492737f, 0.46539103663306347f, 0.04303349437431159f},
    {0.6722240988235024f, 0.10963096242803683f, 0.6656324249885406f},
    {0.09665456215600887f, 0.41494659668089284f, 0.9342890519039121f},
    {0.7322444231073154f, 0.7894717728883612f, 0.778611264519656f},
    {0.6069255962882305f, 0.4262064084811351f, 0.6999919876018963f},
    {0.3821953612905632f, 0.22486359677964152f, 0.6220735007682344f},
    {0.6667290300686879f, 0.07927128302086284f, 0.5011684981547497f},
    {0.9313406778286766f, 0.6307541464661597f, 0.6929465752725962f},
    {0.6544001250863284f, 0.620632612700321f, 0.9258375732949938f},
    {0.13074736122796837f, 0.19020046644716293f, 0.03583937424221173f},
    {0.5031397087316f, 0.8347335185601813f, 0.67752929851556f},
    {0.1762299075950955f, 0.41819721787554476f, 0.13140819928390368f},
    {0.27313215779244215f, 0.4215126023547564f, 0.08514942249055124f},
    {0.6592409498608613f, 0.3011713378730422f, 0.9827803600411915f},
    {0.38713495777939533f, 0.5350671145017747f, 0.9243781825308458f},
    {0.5493757315764332f, 0.8133069649903992f, 0.1658779906460921f},
    {0.9323928812595633f, 0.9479400356088058f, 0.4629175230395831f},
    {0.7125353447019028f, 0.7238023471361962f, 0.8466822416720289f},
    {0.9697403317588045f, 0.24008360469849988f, 0.27430520202064146f},
    {0.6386915746757023f, 0.45772876965155085f, 0.2009912426490733f},
    {0.35958161173528036f, 0.264753138118906f, 0.17777822786030995f},
    {0.16487781732487927f, 0.26987054094883467f, 0.6122256386402546f},
    {0.30869506491853105f, 0.28632594719424787f, 0.534048456740996f},
    {0.40183148968858984f, 0.21141451711213444f, 0.5794147321512642f},
    {0.5286038367959823f, 0.06633315261596562f, 0.4588610899391655f},
    {0.1958815231225921f, 0.5130517452453016f, 0.6174573202973913f},
    {0.8067285156848074f, 0.9804560640720796f, 0.4536352529705252f},
    {0.27416861918153823f, 0.8443112307614091f, 0.6110593043353336f},
    {0.33372550225565667f, 0.4825618700894828f, 0.5963108918482096f},
    {0.03608305999421357f, 0.023956519095512885f, 0.7656161456575868f},
    {0.24970455743504427f, 0.287912141032875f, 0.8005620092815885f},
    {0.9077910658141338f, 0.40988131756217583f, 0.4363591917201133f},
    {0.5510963744517331f, 0.6236005385085088f, 0.302021632674184f},
    {0.24142817294114138f, 0.7221337178308938f, 0.1652365534509993f},
    {0.3892777554996555f, 0.4677068309137039f, 0.21203676043639808f},
    {0.9286920372782876f, 0.8173098282525729f, 0.6661903007241543f},
    {0.34230453070245537f, 0.6814051283948134f, 0.11955105350600648f},
    {0.9678634211404202f, 0.4731688416468206f, 0.6961311808712807f},
    {0.37749416827947435f, 0.9377425932858843f, 0.781422046814812f},
    {0.9818650213869032f, 0.9508002396519443f, 0.925227713282054f},
    {0.452518607278681f, 0.4962062328231732f, 0.0817029201430346f},
    {0.1187458537431153f, 0.8091613661771266f, 0.4787952018336544f},
    {0.42600886986348896f, 0.2083087827813681f, 0.8633042883158789f},
    {0.9142837278086526f, 0.7615001684969256f, 0.7459059161973415f},
    {0.3779052346290882f, 0.9555652307118524f, 0.49699727423773843f},
    {0.696010729748356f, 0.6333959607112734f, 0.6448516692043134f},
    {0.2727194586160817f, 0.8017700902084643f, 0.6046939761072251f},
    {0.9694806703094041f, 0.49260769382780323f, 0.8870079594165586f},
    {0.6302141596150408f, 0.8295447752398799f, 0.4755012010410873f},
    {0.9994882268975753f, 0.2863913270594798f, 0.33264529984178726f},
    {0.9220324785291988f, 0.29742171587623534f, 0.658247251458474f},
    {0.5329535958199256f, 0.12701000809536656f, 0.6041261307891616f},
    {0.3355075067327018f, 0.24509635439510846f, 0.5713944984395277f},
    {0.23466239330702365f, 0.09800927991800212f, 0.7099693417995673f},
    {0.9468424046550582f, 0.02307285063498954f, 0.47798238570024076f},
    {0.069116925875643f, 0.23197174792708108f, 0.15088125484080972f},
    {0.15541720717046548f, 0.07196377214243133f, 0.052467109992793914f},
    {0.3310681805725879f, 0.9457703359302783f, 0.03368292713277121f},
    {0.47296194420024096f, 0.3349133303703625f, 0.6045891875480448f},
    {0.6978805665046179f, 0.7807470497543683f, 0.24758760759712217f},
    {0.16723551522554148f, 0.22611139169176453f, 0.6809319564130177f},
    {0.41492841593425867f, 0.8817678909889399f, 0.6353984658471217f},
    {0.5289336502615892f, 0.761381980296832f, 0.9259271772910013f},
    {0.9719037071147748f, 0.44991027013592744f, 0.6629171044043602f},
    {0.8191215739779368f, 0.7578853522631206f, 0.9949341530692023f},
    {0.5619346318732389f, 0.876795140577829f, 0.2673814554745644f},
    {0.19094373289812216f, 0.05936653263871716f, 0.8423690895176055f},
    {0.6743924186525739f, 0.10669920574144764f, 0.2346839486548875f},
    {0.31673230164885047f, 0.17487731449060784f, 0.8504033894188375f},
    {0.2608555502518135f, 0.26937760275419254f, 0.25513418157939927f},
    {0.057836260931525496f, 0.24188373932168727f, 0.10105145740831356f},
    {0.08157171521494022f, 0.11674670322469649f, 0.002760588009063758f},
    {0.4905314026280069f, 0.11726996894320385f, 0.41409978148236515f},
    {0.9613800737215915f, 0.08472639266370852f, 0.5365157460306678f},
    {0.42974783445004683f, 0.46154626976863056f, 0.6758506302873306f},
    {0.030549897766252943f, 0.16346340921573088f, 0.5550548973177012f},
    {0.26436484917092284f, 0.38551380948699154f, 0.5507244876249651f},
    {0.05168125109076038f, 0.7492068204574811f, 0.900701789971162f},
    {0.42355567781041303f, 0.817855023338623f, 0.4468403159547224f},
    {0.8980085279508325f, 0.6553354599334119f, 0.7853590281021856f},
    {0.5556372142484378f, 0.903610066725113f, 0.6300477830470089f},
    {0.01450656941841999f, 0.5758245635215737f, 0.6313166060047865f},
    {0.550879602643027f, 0.5035536572952576f, 0.8230182453933661f},
    {0.9124207177076834f, 0.32859725080563273f, 0.78285844278349f},
    {0.403457468978337f, 0.3612983398476104f, 0.33311925362594874f},
    {0.4846393583974965f, 0.5500960991954081f, 0.5809654003340496f},
    {0.20112986237848507f, 0.6993276127588944f, 0.9437402950953541f},
    {0.8153786032987321f, 0.3974923344419584f, 0.34706642304834134f},
    {0.4921482750675312f, 0.8846776818122102f, 0.2538415583967203f},
    {0.8630010030890521f, 0.5074899488133223f, 0.4925967731489489f},
    {0.9883365120415802f, 0.0750752551787256f, 0.486426990193047f},
    {0.8553681898716874f, 0.7563067993742967f, 0.11852199344902614f},
    {0.7362735226155331f, 0.5938663707191078f, 0.3811509001700597f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 4: random", "[votess]") {

  const int k = 127;
  std::vector<std::array<float, 3>> xyzset = {
    {0.7228667637001777f, 0.021707185574654786f, 0.8111932113910337f},
    {0.2724838010583104f, 0.28617585936719525f, 0.6955564206061934f},
    {0.7339984083622108f, 0.6053790124751856f, 0.017764529569903154f},
    {0.3766161222616793f, 0.72648475212421f, 0.49908232213715087f},
    {0.3238621201280524f, 0.9679258016673784f, 0.04198326565018229f},
    {0.9350542502374529f, 0.21307441923121417f, 0.494599614587494f},
    {0.5766444200801162f, 0.6070867106801754f, 0.8518890281587401f},
    {0.11378339421927652f, 0.7897820855150798f, 0.6621443024314482f},
    {0.42534138184759873f, 0.410565762763735f, 0.7875527301048919f},
    {0.3034985779190795f, 0.4493796066765502f, 0.32587607822019815f},
    {0.49741251986336965f, 0.020883747536432407f, 0.6646325706066225f},
    {0.5233362847309011f, 0.7577508855200024f, 0.8635773150785093f},
    {0.3573519518447935f, 0.788292474312181f, 0.45430927920872965f},
    {0.532456627347316f, 0.34744683099304563f, 0.2970238408438921f},
    {0.5456870114550929f, 0.8962790381635662f, 0.8723237354203615f},
    {0.7052030315886231f, 0.8890673555180437f, 0.4946215374788081f},
    {0.492194003303422f, 0.4748559869160629f, 0.41312925344867757f},
    {0.25965813019546435f, 0.6502856204932408f, 0.2703827298741851f},
    {0.9775344058939538f, 0.26671355151740994f, 0.8296283958635516f},
    {0.29255304433388907f, 0.0005899505796144178f, 0.8314574670722021f},
    {0.33864739422211576f, 0.2711411078144803f, 0.8468728272428209f},
    {0.9389422183699142f, 0.6497164981695841f, 0.8323636069978358f},
    {0.29122881911030896f, 0.32948688472274923f, 0.1542762445871919f},
    {0.24595342101288808f, 0.2863360374576266f, 0.41320291213635185f},
    {0.5280615424578285f, 0.007397740714950141f, 0.9112488603987834f},
    {0.6958421979304668f, 0.3643723394665691f, 0.3267082299592341f},
    {0.8217595535142485f, 0.24704194214559583f, 0.8393157046967281f},
    {0.08987764265167031f, 0.7909143352731308f, 0.7537701316580127f},
    {0.49851112680055787f, 0.15648005277526844f, 0.6063519345730403f},
    {0.2736529284118886f, 0.6855821114368139f, 0.8351839911564559f},
    {0.43283974825995375f, 0.5016978353581504f, 0.6965579133192658f},
    {0.2548025092280253f, 0.6087722356394707f, 0.5992830625831617f},
    {0.6559134008879798f, 0.3803405320241129f, 0.9198302006141077f},
    {0.48729388121120065f, 0.14541839903524534f, 0.06858396063767103f},
    {0.07420099980826833f, 0.8723381233511649f, 0.4928785652396619f},
    {0.5222043186364332f, 0.5946633454940787f, 0.7791643119263825f},
    {0.8843265534795053f, 0.02519803871553994f, 0.19924281990883363f},
    {0.25548970682025973f, 0.6346685237120027f, 0.491635937515029f},
    {0.06264360097083554f, 0.23544025705616634f, 0.443755619507175f},
    {0.4832286986649871f, 0.4358233209797009f, 0.9337891775433551f},
    {0.11355648863922974f, 0.7094527551460121f, 0.08791484721807097f},
    {0.43026311071483503f, 0.11100950141226285f, 0.5008179806059125f},
    {0.509984130770664f, 0.4615332333358373f, 0.4595833597583767f},
    {0.4025886096008806f, 0.7982323509544541f, 0.5387650622367784f},
    {0.11797905412655862f, 0.18119331054610988f, 0.8048440879284875f},
    {0.09593094021801507f, 0.05621078047101691f, 0.6121418031463989f},
    {0.3796893860689121f, 0.3090978976204749f, 0.8970155839441071f},
    {0.8509817396248873f, 0.36552555646974494f, 0.22762834875933602f},
    {0.4942008967808682f, 0.6514787431699467f, 0.34307088354882287f},
    {0.27681202558210394f, 0.0411910111668915f, 0.8404912066465668f},
    {0.9892172952266629f, 0.3443291360333025f, 0.3204142611898615f},
    {0.7579955687778118f, 0.2395922493168373f, 0.7966095044865407f},
    {0.80730692750524f, 0.10270441544904019f, 0.24568006815672083f},
    {0.8453401652227263f, 0.4452340145819358f, 0.8635260390384351f},
    {0.7452407909677088f, 0.08461968212562387f, 0.8366050485502157f},
    {0.28527803623060843f, 0.4586292811573284f, 0.030550680163678456f},
    {0.17028368708548636f, 0.7163749761083523f, 0.34783259303849345f},
    {0.8837916497822389f, 0.07911602067364931f, 0.2612927729754384f},
    {0.683891603841368f, 0.10853438000083138f, 0.41534595265899776f},
    {0.35617449545251845f, 0.30888910359622157f, 0.9367591995602279f},
    {0.9951482335548677f, 0.5463516781730903f, 0.2306366316981585f},
    {0.8958432034244331f, 0.23782759056884717f, 0.13739581500812004f},
    {0.6262643044465299f, 0.05101174061059133f, 0.3471812863959587f},
    {0.7078905046964473f, 0.5994282973321904f, 0.5553263737855726f},
    {0.947499679942594f, 0.6642452430760579f, 0.4213647262850756f},
    {0.24166222702578688f, 0.6121993414133282f, 0.4259553274099437f},
    {0.31556756047853696f, 0.12441422121888623f, 0.4692349854681114f},
    {0.8331197584742438f, 0.5379540953693832f, 0.44629121870180066f},
    {0.10531237918826386f, 0.3753520798029909f, 0.5424276748480341f},
    {0.3456971892438552f, 0.6026400821791608f, 0.6241897767470731f},
    {0.6747896905506563f, 0.8555209273819792f, 0.18460832931411686f},
    {0.021734446707162625f, 0.8844247161058825f, 0.8465821914295331f},
    {0.8731640754600052f, 0.35200487807099257f, 0.42330002665047406f},
    {0.44624025067439377f, 0.6990819692380129f, 0.9321073556408636f},
    {0.6446420815162267f, 0.18328361829884854f, 0.8248441556915292f},
    {0.732101883699675f, 0.8608113294093055f, 0.958095708717847f},
    {0.39568225999681106f, 0.46897845104538516f, 0.1481768670750092f},
    {0.5147066058864607f, 0.40655554416609885f, 0.935090454912419f},
    {0.9823465473169086f, 0.8672665454377636f, 0.3888982061229044f},
    {0.20074035310948035f, 0.22576276764335412f, 0.34000269339590194f},
    {0.12299306140315425f, 0.1817259806072289f, 0.270310180270802f},
    {0.10292462173016204f, 0.16490174941192903f, 0.1596236039229616f},
    {0.3326031954187011f, 0.14668107804291086f, 0.808033410635702f},
    {0.5769389543783893f, 0.89557618425498f, 0.03720757190681068f},
    {0.9634266755583761f, 0.49757646844040826f, 0.7115018851714804f},
    {0.85231448048719f, 0.923542038040389f, 0.006670431670873556f},
    {0.423023328351281f, 0.435166694802141f, 0.06031713904466762f},
    {0.49643511788476835f, 0.22298326006255542f, 0.28524088650544854f},
    {0.47008365427636056f, 0.01909250434707266f, 0.7555234761093508f},
    {0.6836663888120998f, 0.2048173083513144f, 0.8460730683765764f},
    {0.8869777284672031f, 0.09198015342310717f, 0.859607961782791f},
    {0.45812472761082534f, 0.8307725547051575f, 0.7166494534522823f},
    {0.977707037279113f, 0.5445929783094345f, 0.5249214540268302f},
    {0.1222132294047692f, 0.8270943926421022f, 0.5912829017142767f},
    {0.5338009464645654f, 0.17241549393341937f, 0.7098340595887906f},
    {0.8782071990776078f, 0.6343026456294807f, 0.4507478364125771f},
    {0.6307408308537602f, 0.30002532718225394f, 0.05457861641941186f},
    {0.4429964238127895f, 0.11667184295264066f, 0.8311735052943193f},
    {0.7279429221464359f, 0.3174821518024028f, 0.5436123813062201f},
    {0.1323967697914772f, 0.8550979518864279f, 0.5642329661604433f},
    {0.660187490344059f, 0.5320281829300625f, 0.22594299580902621f},
    {0.23221088005590118f, 0.8592342816872985f, 0.8920740025903218f},
    {0.8274987716864043f, 0.9323540626596923f, 0.013045210268796792f},
    {0.034878718473006054f, 0.7405803542463695f, 0.7112162589072243f},
    {0.7405213828940825f, 0.4933386012201234f, 0.26483683762045074f},
    {0.1810693227872474f, 0.6135060534597949f, 0.41637409918245016f},
    {0.664637621019676f, 0.8155098722518614f, 0.4551016811290649f},
    {0.7635994926935673f, 0.3509890839494709f, 0.06310558788226828f},
    {0.2808669273703116f, 0.6196869960097992f, 0.16603961591252814f},
    {0.2804966343796459f, 0.41532151044258236f, 0.5875566370951375f},
    {0.4389111638561246f, 0.4161116068903784f, 0.7017111376238695f},
    {0.9667453288346486f, 0.28316283470210046f, 0.5759462019171617f},
    {0.9521924559013462f, 0.5883339736015435f, 0.5454186232811722f},
    {0.16649062507933277f, 0.5886935814256454f, 0.2622973099295952f},
    {0.0759629917036484f, 0.8892954772323164f, 0.22673343195553375f},
    {0.8653764665799788f, 0.10801227289569737f, 0.5129444160289293f},
    {0.8088237322898827f, 0.5180474505018217f, 0.7316756999049802f},
    {0.1713103895630791f, 0.8862907093990192f, 0.23636573843789344f},
    {0.14309229672815216f, 0.490514526208212f, 0.22710932909827664f},
    {0.6352125223822223f, 0.9619506534946405f, 0.08786510954390758f},
    {0.9513804432515823f, 0.409797063975335f, 0.17621364084026092f},
    {0.9057260495988587f, 0.3674584777178729f, 0.5703457508290487f},
    {0.12249414888765608f, 0.32847696908832946f, 0.6568268917444002f},
    {0.37341967660647735f, 0.9634861128788343f, 0.6230229084252468f},
    {0.08722798017848932f, 0.6982227040999329f, 0.42210924015182394f},
    {0.937798588811016f, 0.15575225903467416f, 0.664663035749933f},
    {0.5634944319440456f, 0.5992612936020699f, 0.24830973865977812f},
    {0.7921312090961949f, 0.5287976027875831f, 0.5075598507205462f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 5: random", "[votess]") {

  const int k = 127;
  std::vector<std::array<float, 3>> xyzset = {
    {0.14975333176189598f, 0.022963167319235755f, 0.023503760921450678f},
    {0.8806556058544306f, 0.5116391192978f, 0.7610302512189021f},
    {0.0006869482830457185f, 0.6532877068544206f, 0.834191924393163f},
    {0.2650166077545201f, 0.9497333793834467f, 0.8397440411492223f},
    {0.5638865732867485f, 0.5067355010526101f, 0.43480980196571817f},
    {0.8968020840639702f, 0.251121345336764f, 0.4253103047590755f},
    {0.9025267650459741f, 0.05678564894015703f, 0.19962612334854912f},
    {0.8408865284513568f, 0.19941328950810167f, 0.19985394036095938f},
    {0.29876801697718336f, 0.05226366680956751f, 0.8444379063515929f},
    {0.9637771167917285f, 0.9096404434741873f, 0.9044045510948531f},
    {0.453773633660161f, 0.6568721037546548f, 0.38159705158247625f},
    {0.504928364418596f, 0.004548622650225598f, 0.7679714144315776f},
    {0.6646869029743803f, 0.06604762201180925f, 0.3519963630786017f},
    {0.23109028447031355f, 0.5524988273273278f, 0.3267247486245223f},
    {0.0007231793602120451f, 0.4968643846300337f, 0.3119869539089938f},
    {0.8439795623054914f, 0.8897502149897761f, 0.7298168821685512f},
    {0.3746843385438787f, 0.9906556365255291f, 0.04936491072722338f},
    {0.9316973989159988f, 0.5557827635931104f, 0.7202323168009548f},
    {0.030386488739026385f, 0.12042055826484022f, 0.7148090810050972f},
    {0.6194059328405972f, 0.8282368182777019f, 0.43737800180941366f},
    {0.5441652295673918f, 0.7418517516664879f, 0.20379465537122987f},
    {0.2249949588669814f, 0.7669765170274535f, 0.13269465418822768f},
    {0.37671271865714695f, 0.07409361603852205f, 0.9106836764718917f},
    {0.518972107848316f, 0.6692563969592833f, 0.9437751535291862f},
    {0.058918325281947626f, 0.10944416059227047f, 0.3953547735835482f},
    {0.14437310292999417f, 0.012178706471585588f, 0.43786356617213307f},
    {0.36947165796267667f, 0.7852368587428964f, 0.011092540774341297f},
    {0.8099689948584987f, 0.38442566307930404f, 0.8805249695653667f},
    {0.19220160799012054f, 0.4663562453100154f, 0.8227160240882544f},
    {0.6385728558624861f, 0.7978332823058522f, 0.8915333825705553f},
    {0.3917468215074644f, 0.6183843145404794f, 0.11997884548315318f},
    {0.07937613677349598f, 0.6425866678847794f, 0.4863727736748119f},
    {0.08857289558775439f, 0.22859030702940897f, 0.7283920961867765f},
    {0.30957882489815414f, 0.2606569889303507f, 0.8321394442545359f},
    {0.6500260067889713f, 0.3211404439194041f, 0.009104845135348705f},
    {0.5835473895333232f, 0.39508222188910325f, 0.3865264290275757f},
    {0.6519643602750997f, 0.37038450004245804f, 0.642263059020879f},
    {0.5079984488494587f, 0.412165579860026f, 0.123236861392235f},
    {0.39301520544872826f, 0.03971063354474447f, 0.3815426414029981f},
    {0.0008830341778240935f, 0.4308362715576781f, 0.18454885601846727f},
    {0.11488456138027348f, 0.09671546677331833f, 0.022606451423242246f},
    {0.49828358376616f, 0.5497606640143122f, 0.16311237432684955f},
    {0.2879375976144467f, 0.3567929913505836f, 0.8276586016133747f},
    {0.39616941235294756f, 0.9242103667314769f, 0.323019950915433f},
    {0.5806137053938453f, 0.7521887268593225f, 0.7512782036827079f},
    {0.5841925287537344f, 0.5363974036342298f, 0.8579242379995593f},
    {0.0231145637450364f, 0.07339477175368248f, 0.9210751936130683f},
    {0.4420892322290141f, 0.4364595732959953f, 0.6824790736266168f},
    {0.5338672570303554f, 0.010996965637246503f, 0.05651840279527054f},
    {0.17526786934159722f, 0.2520162297371251f, 0.5055925947653747f},
    {0.4871160850867525f, 0.49839408069728386f, 0.525754780021022f},
    {0.6814819842221924f, 0.1988358694318697f, 0.3906601200257551f},
    {0.2022525759642838f, 0.16243762400075912f, 0.9593926429401225f},
    {0.10271302484256029f, 0.5085284300123709f, 0.2676351246908758f},
    {0.3459483934756644f, 0.9007943824728776f, 0.20695425191415784f},
    {0.2109192304096672f, 0.2445788895312896f, 0.8965420433964124f},
    {0.5837466398549283f, 0.019294938428259245f, 0.41450026316953115f},
    {0.6937243071706428f, 0.49487491624928626f, 0.2974939056207627f},
    {0.841105426553185f, 0.5950453340163121f, 0.9817064916774082f},
    {0.5564488973462418f, 0.5437835261254756f, 0.26654436430741746f},
    {0.9258570984265438f, 0.6706095527635726f, 0.9021172084724306f},
    {0.46458457246517115f, 0.21527910500456027f, 0.804793569362107f},
    {0.18940791713964078f, 0.9972047536772066f, 0.9321910770746026f},
    {0.36162937827040265f, 0.3407858282817777f, 0.6787664737110604f},
    {0.13727158732795053f, 0.9066903573328521f, 0.735409981228926f},
    {0.092936625223205f, 0.14711216577630482f, 0.9450827563934375f},
    {0.47024600842001385f, 0.587786607742865f, 0.4863385439022816f},
    {0.7739228952823046f, 0.2478787629103436f, 0.23221160591514922f},
    {0.8865053838113375f, 0.9490559917915115f, 0.4411940587502503f},
    {0.5709190624296318f, 0.8051141565792258f, 0.47282579217592235f},
    {0.8367054320386513f, 0.6129417482820559f, 0.21661510264290484f},
    {0.7304311182257942f, 0.057916553086389655f, 0.31322898489572737f},
    {0.9383878981675958f, 0.3116846534489699f, 0.9404646114485824f},
    {0.8513493633789135f, 0.23814896346898928f, 0.3090040282504882f},
    {0.9989163355317126f, 0.44828753760561657f, 0.52997269105312f},
    {0.6687966128127829f, 0.6987463998383853f, 0.324540037903987f},
    {0.7121075832024257f, 0.4074164512736005f, 0.7070969389312569f},
    {0.6700608894312063f, 0.05594431599939875f, 0.911059129099263f},
    {0.9127363475728117f, 0.932451077802285f, 0.20524933912178156f},
    {0.7656376571455762f, 0.6833990777172215f, 0.7119358816565937f},
    {0.9399076408531322f, 0.797994363656178f, 0.49613905733279673f},
    {0.6929244344659854f, 0.5288793885277928f, 0.2482582335223702f},
    {0.6090570275968525f, 0.02582804694850227f, 0.03371113226471345f},
    {0.8349414275655767f, 0.49659095795755215f, 0.8296106100493277f},
    {0.8568489840317117f, 0.8717781064099812f, 0.1286545312098928f},
    {0.16764190198437645f, 0.007295767887445459f, 0.9872055600151247f},
    {0.7257884294282875f, 0.3512055239994203f, 0.19200882924588225f},
    {0.548178411005931f, 0.3985018225946829f, 0.1357967348057174f},
    {0.3904575442258852f, 0.5030786855157211f, 0.12889387835461907f},
    {0.8806676653889051f, 0.14863243943404392f, 0.09495762225307425f},
    {0.3593630667053147f, 0.4530739395709281f, 0.45838424386991194f},
    {0.9919779543910341f, 0.707680093175903f, 0.614477871094883f},
    {0.04827926949689443f, 0.4443785695525303f, 0.11148884411872906f},
    {0.45697740801889974f, 0.868794676833572f, 0.9454202363303809f},
    {0.8493101725874996f, 0.976575474968673f, 0.06877981971181357f},
    {0.9621615072107788f, 0.8047265834785936f, 0.6160075304901509f},
    {0.7464026763873638f, 0.4303302009534896f, 0.7859772211791689f},
    {0.6186453623130532f, 0.8845497325504791f, 0.4896698499660034f},
    {0.21331880601534536f, 0.5129499753367125f, 0.7961005631336346f},
    {0.6111881018029385f, 0.9277631732306973f, 0.00014478488139746393f},
    {0.5505000831350458f, 0.24239416281791826f, 0.15529773750755815f},
    {0.9069857605536611f, 0.010047166590122947f, 0.5512655748730326f},
    {0.5562680380240117f, 0.06741869690929136f, 0.04347052830552134f},
    {0.02003022017180789f, 0.6075210486162804f, 0.7326388506508057f},
    {0.9178437816586685f, 0.26238438167198164f, 0.6294203883375198f},
    {0.01037606700487026f, 0.37228994948891136f, 0.13199445618886319f},
    {0.33566686251572386f, 0.622861303222474f, 0.6065348783182805f},
    {0.13916601362212744f, 0.550904221820165f, 0.18723517876936713f},
    {0.8219235062237263f, 0.8223203208093818f, 0.0992326702930112f},
    {0.318419834407872f, 0.13772333785800273f, 0.6846608007658312f},
    {0.9613563221882215f, 0.8355814614769764f, 0.13088357549334062f},
    {0.6309760488106372f, 0.28139114686143096f, 0.7004481430818558f},
    {0.4685512157899201f, 0.3173268845263636f, 0.8416433133290593f},
    {0.3335441288598813f, 0.7615234366918703f, 0.3497324892783019f},
    {0.43272854389072757f, 0.22464051936727458f, 0.9496110517462181f},
    {0.914254623561671f, 0.31179869010525885f, 0.4721575829836421f},
    {0.01246446886551833f, 0.6772783599352888f, 0.3167367429472394f},
    {0.7277366080218364f, 0.3242813814448203f, 0.761912471090069f},
    {0.8483622980718452f, 0.6690882834702369f, 0.9356967563433729f},
    {0.6430438537862179f, 0.20272486959798586f, 0.8888899371581699f},
    {0.6409354930683884f, 0.2752699043644615f, 0.34077060958472816f},
    {0.3237800269273049f, 0.7355843502831094f, 0.8756323604147394f},
    {0.3915543621005848f, 0.7215134514053455f, 0.07266421136829071f},
    {0.3553041157767358f, 0.7206820566320532f, 0.9835309877226144f},
    {0.5983946607286061f, 0.682489339609886f, 0.4153352784299569f},
    {0.6098131076646293f, 0.20959800562585673f, 0.8168304758282816f},
    {0.5409121350094477f, 0.8099320234606827f, 0.8030737476659814f},
    {0.6638275593168738f, 0.6552288465445564f, 0.9772581988669972f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 6: random", "[votess]") {

  const int k = 127;
  std::vector<std::array<float, 3>> xyzset = {
    {0.762488340319842f, 0.6341223360716413f, 0.5977103059567501f},
    {0.7808830347178737f, 0.8572440815925162f, 0.08140720327958617f},
    {0.7438401024559627f, 0.7020523885084134f, 0.96705261538002f},
    {0.08777721360246771f, 0.688014487804754f, 0.8259586247825031f},
    {0.2877800092692623f, 0.4666381707755487f, 0.843935460201486f},
    {0.3993719687987425f, 0.2566544582963428f, 0.8557691156629758f},
    {0.7479372178042772f, 0.7336457078319706f, 0.026401254112778716f},
    {0.3435727187057305f, 0.9651894000029954f, 0.16100302091681307f},
    {0.4401731419335223f, 0.4500986694700283f, 0.14143553153486876f},
    {0.15785064801819415f, 0.7325428432533273f, 0.7318929240225163f},
    {0.8086579179222614f, 0.5192621616756247f, 0.11517645910319141f},
    {0.3117167606661062f, 0.5298291422113467f, 0.5858588971333989f},
    {0.340494103696088f, 0.033664167374218845f, 0.5489754668217163f},
    {0.6684736556212986f, 0.7559915372906958f, 0.41237098108602055f},
    {0.8435696181608263f, 0.5470956556328739f, 0.48079944373467665f},
    {0.7163253222326004f, 0.3489383089942564f, 0.8076108081153125f},
    {0.01243661265630669f, 0.9013989229361921f, 0.7867034651630244f},
    {0.1558381619698278f, 0.1426431302496921f, 0.312986455789091f},
    {0.16228929740460263f, 0.42364469758121126f, 0.2178103220158737f},
    {0.25147426771398196f, 0.9069199180878751f, 0.39933687891541314f},
    {0.7749809811604004f, 0.6677494171794455f, 0.8065167554711051f},
    {0.8475164626777784f, 0.9153356095716623f, 0.7984304808678573f},
    {0.364101382202197f, 0.10894248775920168f, 0.42171711404663714f},
    {0.001306028579095897f, 0.9913803361405318f, 0.7255331972765444f},
    {0.7590587864977211f, 0.5931295258777198f, 0.6402473019849207f},
    {0.3806808233775947f, 0.5357415501959003f, 0.12382879548987502f},
    {0.9747381218516501f, 0.29148868431987573f, 0.6193395068012912f},
    {0.11757747543735908f, 0.579068591028492f, 0.7769025825201196f},
    {0.06142857416069436f, 0.39126313413776126f, 0.9090619450497573f},
    {0.0008022253821228231f, 0.8874006356123609f, 0.7779872535740264f},
    {0.9632725478865988f, 0.8040820425218647f, 0.051031335940780465f},
    {0.05598640993817938f, 0.5417916601850625f, 0.2521186680855979f},
    {0.662473852643264f, 0.026582118451715653f, 0.36525811415414533f},
    {0.23427938001289772f, 0.9540499043591637f, 0.22866747869899473f},
    {0.6043742310122266f, 0.6658069578095993f, 0.2583060636262561f},
    {0.4661466978324268f, 0.50746889826742f, 0.8460905489092592f},
    {0.16081910471219696f, 0.42800655614727345f, 0.7802155166212924f},
    {0.6278020871167331f, 0.2466148450650042f, 0.6241840124337503f},
    {0.25255875382882875f, 0.42298988030037465f, 0.298059567905562f},
    {0.8653873775831151f, 0.7223402526498061f, 0.9637057680335986f},
    {0.8263508349815992f, 0.9758239928207489f, 0.3708774186781918f},
    {0.6264759613260982f, 0.10787087990671418f, 0.8374875187632707f},
    {0.750282390110377f, 0.08717452595739461f, 0.7328845233888456f},
    {0.612380522140748f, 0.7944486045705024f, 0.8516029209255294f},
    {0.3431822915614401f, 0.3113614370356853f, 0.08308639106522386f},
    {0.9030933197733397f, 0.612642784951747f, 0.7344240094790672f},
    {0.35493579451302826f, 0.8950967181196375f, 0.26510203139752997f},
    {0.2042416759231399f, 0.6321871860709175f, 0.9813318868110453f},
    {0.09633780339871889f, 0.06420854057791647f, 0.06531606198401141f},
    {0.22191854260438015f, 0.058860080474048115f, 0.1426237664613571f},
    {0.1677589290662369f, 0.22757170063983312f, 0.8329537521021336f},
    {0.8997353518439406f, 0.3820912118354186f, 0.498190650924338f},
    {0.4377166333819319f, 0.835887427704304f, 0.19331095190266123f},
    {0.9777671608511712f, 0.4254240558657978f, 0.7707115798121716f},
    {0.8437417488886028f, 0.5474659311782393f, 0.9556655358934539f},
    {0.7770491657978624f, 0.18292489634393883f, 0.7296479399034708f},
    {0.025652657339794827f, 0.1680986980810142f, 0.7156239335598577f},
    {0.11407311416879351f, 0.18591445919813498f, 0.03804647294587549f},
    {0.19887170578347413f, 0.513532024089432f, 0.5645848583432235f},
    {0.8904683093407069f, 0.4021078758031602f, 0.4727068086489684f},
    {0.7383196103940909f, 0.47310225702126363f, 0.5259195072977866f},
    {0.5941780859303871f, 0.520007323829061f, 0.6600668557127051f},
    {0.9778131041145165f, 0.9674707921302739f, 0.14176651683910702f},
    {0.7981827286586896f, 0.5941158453667345f, 0.7829640420514946f},
    {0.8600353879296988f, 0.5218045271818291f, 0.6043463082690652f},
    {0.3670457485151144f, 0.7643783410085815f, 0.258189354865758f},
    {0.7525317392744729f, 0.5664788685876196f, 0.9303028533494144f},
    {0.5891044670834091f, 0.9395680753361979f, 0.0440137222482031f},
    {0.32401877914121646f, 0.2815923026757503f, 0.3091015495158079f},
    {0.07082105162480212f, 0.7566478238736785f, 0.7200806137669887f},
    {0.2718151363062775f, 0.49600453787197807f, 0.9333160013552874f},
    {0.5707786389266193f, 0.05926184574906168f, 0.7742934774642857f},
    {0.5410194565890629f, 0.4272677505930591f, 0.3107780790922021f},
    {0.9631041294107765f, 0.25173046834501434f, 0.6357664004217122f},
    {0.15531928613945611f, 0.6230627245733764f, 0.9847989447241936f},
    {0.9954000929723459f, 0.07176051923394411f, 0.9490554079828627f},
    {0.3054469626964823f, 0.041809059628651f, 0.843921961797357f},
    {0.353080154500498f, 0.14851062623874967f, 0.0657793814796761f},
    {0.7590709960492776f, 0.04783090641985965f, 0.9200426445929487f},
    {0.6058829940908583f, 0.25036434408688346f, 0.9556430502906259f},
    {0.8354419226484874f, 0.5154291027958855f, 0.8334988059748849f},
    {0.26296436082414f, 0.006919149537472857f, 0.06235863069389236f},
    {0.5809647358152862f, 0.3893743295218365f, 0.026244601242180643f},
    {0.15709913247746254f, 0.9416021282082395f, 0.27689915343786575f},
    {0.28469406183395096f, 0.9736032037718003f, 0.9692100956656398f},
    {0.9501035299668743f, 0.35257996004995606f, 0.12339326112506599f},
    {0.6940520933086304f, 0.40566424118177336f, 0.5120484460410409f},
    {0.1851805935009515f, 0.04963391466401146f, 0.2194876447009746f},
    {0.7535211984189452f, 0.17154104479395083f, 0.6811229230614202f},
    {0.4972157711778563f, 0.3058307556834886f, 0.708688521547738f},
    {0.3863366084944643f, 0.33229341262047296f, 0.5405117981959213f},
    {0.21360109112055026f, 0.2986766846317527f, 0.0727525836310029f},
    {0.8355070316187636f, 0.02290777694628876f, 0.07216531946585536f},
    {0.32481615441202927f, 0.10618537292036967f, 0.8741552591366657f},
    {0.6579465361974174f, 0.3194652148035181f, 0.008335230295109297f},
    {0.17558208256581964f, 0.41975706025589643f, 0.7893163488826701f},
    {0.8952989348868315f, 0.6877163764731358f, 0.20198178357323948f},
    {0.35005016332876837f, 0.2274484614054768f, 0.9339083492716697f},
    {0.8417653586299397f, 0.8339380325289844f, 0.7615581600972553f},
    {0.7547540484794476f, 0.33343437970086987f, 0.009713807000260588f},
    {0.710081610755862f, 0.09724034161288486f, 0.0520862087716204f},
    {0.12671402447018454f, 0.7291876759792365f, 0.4048809954988958f},
    {0.1416917564281801f, 0.6379391056044039f, 0.7273630281700688f},
    {0.9133583278862589f, 0.8186846608509714f, 0.7588945951423043f},
    {0.8464975520975352f, 0.6616357545853746f, 0.6048486483409202f},
    {0.8937627705457548f, 0.0659170731717541f, 0.02921364606728183f},
    {0.27310913500567313f, 0.3238155189689744f, 0.7372111107398758f},
    {0.3851247156629656f, 0.4273468489952693f, 0.867387835968069f},
    {0.27030288784888357f, 0.11693947537555416f, 0.32104520226948896f},
    {0.05665700292972331f, 0.49560312633271375f, 0.23311349880979604f},
    {0.6973615014367741f, 0.289446093786879f, 0.18035929574227993f},
    {0.16017126572570684f, 0.7389308963918197f, 0.8615184252986333f},
    {0.27616340014334095f, 0.5146722589940047f, 0.26936649959305403f},
    {0.9902501425721913f, 0.7891313549272002f, 0.16426377559249716f},
    {0.3550768776440094f, 0.5271109999866675f, 0.8003123530301177f},
    {0.34036089695010263f, 0.7135300697292084f, 0.41232828075894556f},
    {0.6907801396137986f, 0.055767090686349885f, 0.9183652959202798f},
    {0.052400436023986585f, 0.3016047412674925f, 0.365621386959494f},
    {0.13026953819778864f, 0.822555439537026f, 0.5267572838118413f},
    {0.8073866080878712f, 0.004465185368216051f, 0.3443534785020673f},
    {0.06602439626070611f, 0.5956572791887899f, 0.3108423462618478f},
    {0.33709347452278304f, 0.11206669809647007f, 0.6949492965503078f},
    {0.43847843779150786f, 0.8367392833240932f, 0.15737741235765967f},
    {0.7903537316669672f, 0.22991429718993184f, 0.35662528421881956f},
    {0.13770173889288184f, 0.28390759536745125f, 0.17260367861497483f},
    {0.6727189090808178f, 0.35246781325305754f, 0.21833499688126634f},
    {0.6527805818380527f, 0.8951472228404374f, 0.7406115709951355f},
    {0.7111120389879395f, 0.3494470375976967f, 0.5506806514978665f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 7: random", "[votess]") {

  const int k = 127;
  std::vector<std::array<float, 3>> xyzset = {
    {0.7141380619754011f, 0.2722498754178656f, 0.9228504096710797f},
    {0.6182891211793397f, 0.11364779166479344f, 0.13977411053726818f},
    {0.24066746162360886f, 0.4679560777124474f, 0.8139243106436076f},
    {0.2744069922749377f, 0.24060568664712367f, 0.7341984804209347f},
    {0.8040973773162151f, 0.8681341258351621f, 0.4620078015157214f},
    {0.25848749477066457f, 0.5472928875224353f, 0.6290962243196018f},
    {0.9479956295736657f, 0.027334337647075047f, 0.1209217175350038f},
    {0.1319042576883659f, 0.41305073750805044f, 0.33967126905825074f},
    {0.42317311322526563f, 0.09393940649956534f, 0.6298712686827762f},
    {0.7333056194526836f, 0.11217071755001617f, 0.8986360705289806f},
    {0.563969876338414f, 0.9971297998495617f, 0.6964906523138737f},
    {0.4458559796702145f, 0.31943819747736213f, 0.44405080928690066f},
    {0.025471665945287936f, 0.42992816583237825f, 0.4738254966418506f},
    {0.10665212438798022f, 0.24483216803401864f, 0.22668150499887874f},
    {0.6579511592329013f, 0.5324937889057834f, 0.03409715138386571f},
    {0.996934970569062f, 0.2493326579265157f, 0.9726381226784855f},
    {0.8988333194668009f, 0.21204247854999925f, 0.8518185761639383f},
    {0.49979022506268345f, 0.21579698680030623f, 0.2539098309418115f},
    {0.019168380338434376f, 0.16003155195342944f, 0.4350867973862744f},
    {0.12292402788645906f, 0.5674370581955097f, 0.23377118045741851f},
    {0.6576361074826487f, 0.32093381785168806f, 0.7943165124690222f},
    {0.884200999142661f, 0.9057240758082244f, 0.5669812422675071f},
    {0.3772176526321612f, 0.6541839587837074f, 0.7281176469583517f},
    {0.6711381250134096f, 0.9267873606811609f, 0.4379396946329275f},
    {0.23425331388912707f, 0.8940515291664519f, 0.03429367761934676f},
    {0.5647773265406055f, 0.6099385045119867f, 0.7145168906413788f},
    {0.11000827270988145f, 0.15521389913388173f, 0.05569843690945642f},
    {0.7174836970667332f, 0.43211203614731464f, 0.20998428558774762f},
    {0.8030643594382147f, 0.9223806123902153f, 0.8305942007762566f},
    {0.17615763785565286f, 0.8333398293091625f, 0.7840778068078468f},
    {0.901155524104415f, 0.5803075294854166f, 0.35001386441008664f},
    {0.7340516330408611f, 0.7477256305981299f, 0.5560908396286053f},
    {0.6688095618927657f, 0.05959295214943139f, 0.501544705649233f},
    {0.9746581448901379f, 0.5367413531842197f, 0.2992104432748043f},
    {0.6879122001841916f, 0.7227902292305103f, 0.35841072134246243f},
    {0.1405738899259663f, 0.5690025524798348f, 0.43209006395952265f},
    {0.5915584528633894f, 0.6168776812725352f, 0.06947216428268432f},
    {0.5301514355229692f, 0.30929198890309073f, 0.8536388997966265f},
    {0.23797228526502745f, 0.5009064950562158f, 0.42951243394267136f},
    {0.48455514013319745f, 0.9344283579075394f, 0.5377814883638531f},
    {0.5784119937869207f, 0.7312221008421895f, 0.6389772623181205f},
    {0.5502732244212403f, 0.25871056444508833f, 0.8286014371120644f},
    {0.608943726578062f, 0.8536580155811344f, 0.6139031145118724f},
    {0.6326826263849311f, 0.9232021851850098f, 0.01890456768399551f},
    {0.796048310435901f, 0.4991824309783185f, 0.4693678995371541f},
    {0.12901789312981127f, 0.39869615889604704f, 0.048978311864987134f},
    {0.16730801648562588f, 0.6331419175264311f, 0.8819052299240084f},
    {0.4612933633844354f, 0.8610459276398648f, 0.7970378051127547f},
    {0.28795860160543196f, 0.32870435508220164f, 0.9476626466124336f},
    {0.32081014810410646f, 0.6665641938310202f, 0.507263979969263f},
    {0.5980959894971717f, 0.5473323731374458f, 0.7972291241310883f},
    {0.03990992451652542f, 0.3229070349987946f, 0.5565330602263983f},
    {0.2514973968693799f, 0.35503871256270225f, 0.7408360246522004f},
    {0.35499038862844734f, 0.005777482657009947f, 0.07676077378757751f},
    {0.1255081070041888f, 0.49009705629602196f, 0.8205878264043636f},
    {0.3172773279926f, 0.8361116652939097f, 0.8208012499853665f},
    {0.8741703774762561f, 0.5359383985775316f, 0.4422838071893245f},
    {0.33462235581569544f, 0.8252131742156601f, 0.35327745109608155f},
    {0.8877289641123017f, 0.9172152128981327f, 0.011854609662116045f},
    {0.6411106383148939f, 0.9260570305961412f, 0.38455759626812536f},
    {0.7206038998961022f, 0.34353491584597406f, 0.3269819031631439f},
    {0.6591143828518742f, 0.854342582630176f, 0.9310855978699148f},
    {0.03102448717129691f, 0.9950977746442319f, 0.06060886628306339f},
    {0.1264687762594705f, 0.5603226612093796f, 0.4075726629183396f},
    {0.37320388584199715f, 0.0011697094888356574f, 0.509529057369103f},
    {0.35478883705376263f, 0.902419242382317f, 0.10934456852774022f},
    {0.9812261139668171f, 0.49108259487841344f, 0.7389612082229146f},
    {0.4519036325356214f, 0.8675715136729361f, 0.381843891659828f},
    {0.7675620404792002f, 0.14700177917605683f, 0.1999913928075825f},
    {0.5330201170161614f, 0.2652050984690302f, 0.5054498722114671f},
    {0.4212980066755201f, 0.5256181211270328f, 0.8432235463452699f},
    {0.49521322814163193f, 0.5064728901260905f, 0.9097918269891114f},
    {0.4713731065221479f, 0.03132185455292291f, 0.14901224726843054f},
    {0.9422834023205563f, 0.4948625130372647f, 0.9024202273389351f},
    {0.5770036096543719f, 0.46342222143526046f, 0.1904309156727434f},
    {0.38270946716644016f, 0.9451029509533936f, 0.91166361716145f},
    {0.9959752787888289f, 0.4069605032945449f, 0.9990591258035739f},
    {0.3909271157183166f, 0.41780661360021976f, 0.2730657064420159f},
    {0.16434566278845997f, 0.7344220007374594f, 0.8897180092024215f},
    {0.2620624632518044f, 0.6193430296640949f, 0.3140023745217454f},
    {0.4371650369700646f, 0.054547453226256426f, 0.048199726289979705f},
    {0.6998005916229991f, 0.05896405391258985f, 0.928909885989526f},
    {0.92666988605235f, 0.6798919149160635f, 0.41347660436195666f},
    {0.1787738363590058f, 0.2680036346985616f, 0.6884966128205824f},
    {0.6791634840020727f, 0.795030691073487f, 0.8535985267032334f},
    {0.9153461365475555f, 0.6058650812736226f, 0.6142717578884822f},
    {0.8350357851854798f, 0.664855809478206f, 0.025040670646547913f},
    {0.7823280766696525f, 0.5973842644079578f, 0.7029254576628539f},
    {0.14262982274767788f, 0.7646871072093584f, 0.19975192305200384f},
    {0.14121613312820347f, 0.9376672253244296f, 0.0833897249606873f},
    {0.8179594341655408f, 0.4606264333005824f, 0.9523903270133168f},
    {0.37057038026180933f, 0.051061208646469014f, 0.29061339944378173f},
    {0.6983951971621108f, 0.9375096407865058f, 0.5464552769123943f},
    {0.7123282756672753f, 0.6011965769939901f, 0.08553259249072076f},
    {0.22011261125441106f, 0.4358972034360922f, 0.3333570724877888f},
    {0.525623412867945f, 0.7478203448915482f, 0.849381650475853f},
    {0.936185110270316f, 0.08651725144992428f, 0.5089034586198175f},
    {0.6524663978080738f, 0.5141843644825334f, 0.5083126109907319f},
    {0.2671249784640024f, 0.6082150067027157f, 0.46947745538847807f},
    {0.8247727495004793f, 0.6608896364678164f, 0.2917866297825322f},
    {0.16312817072320196f, 0.10500902265473555f, 0.757699092904951f},
    {0.16970455300839504f, 0.9777866277114369f, 0.8304154599602043f},
    {0.8507852551490568f, 0.7652720565048944f, 0.9561870140531054f},
    {0.15261384696126867f, 0.28376641511922707f, 0.5167352721524427f},
    {0.6837110454396215f, 0.09473636876305536f, 0.9922986823203617f},
    {0.705506017060522f, 0.13097617755893176f, 0.9634587062719171f},
    {0.2914380195728238f, 0.10881063595280815f, 0.118889199336635f},
    {0.08134058545821932f, 0.9940289766521174f, 0.8228864222166336f},
    {0.6790727868660925f, 0.39104642654261035f, 0.7442339018826413f},
    {0.9120804494992603f, 0.6047965438089534f, 0.47844919295259514f},
    {0.3531863060516951f, 0.2841915245286136f, 0.6627900386472749f},
    {0.4773819733163842f, 0.43649850308076077f, 0.051189832169328375f},
    {0.852725184937796f, 0.21113365055847078f, 0.7849722554475288f},
    {0.3700139310081325f, 0.7666924692855752f, 0.5450284408889221f},
    {0.2785501922289806f, 0.027401202308746653f, 0.05896507050955935f},
    {0.2746513440654874f, 0.16960509610943186f, 0.9459730273254193f},
    {0.6985043967256407f, 0.220390199702163f, 0.7822463441723346f},
    {0.13734088762266505f, 0.9042666657282336f, 0.5268369267782259f},
    {0.7051439100584538f, 0.22913531305325907f, 0.6463341200232713f},
    {0.8708147549895845f, 0.5846035063507509f, 0.44653878486366305f},
    {0.6914125660418742f, 0.5430587739273142f, 0.47572151571323074f},
    {0.1797087011603088f, 0.31884250362346556f, 0.33014444322666625f},
    {0.7873468779626325f, 0.09066994906496884f, 0.20063976600824418f},
    {0.8654235581591107f, 0.6511619157651863f, 0.8962128528610064f},
    {0.46351507603137376f, 0.30476189406912935f, 0.7852699398182933f},
    {0.8832202161087737f, 0.6185310972715505f, 0.7599382457203585f},
    {0.8019545672733678f, 0.14358436028366717f, 0.0937237733903642f},
    {0.34167219602058807f, 0.7316336005991984f, 0.9059476501920367f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 8: random", "[votess]") {

  const int k = 127;
  std::vector<std::array<float, 3>> xyzset = {
    {0.308596156217985f, 0.40116075469185664f, 0.1732416472304602f},
    {0.738946190450589f, 0.8416642490436347f, 0.7503109664267321f},
    {0.43268284379138433f, 0.26756891165860464f, 0.3567736091231384f},
    {0.3368410422922071f, 0.7476737984414431f, 0.5466903656552061f},
    {0.4782757693454751f, 0.37046800710932426f, 0.9121722590441997f},
    {0.8589762355826157f, 0.4823717181168836f, 0.5729020409614176f},
    {0.3362976587037828f, 0.31524982403460045f, 0.3502929783818801f},
    {0.3920131878629194f, 0.6988484520864354f, 0.6770613307918365f},
    {0.6042690754638395f, 0.58225861428167f, 0.7788748547380724f},
    {0.04154372093110004f, 0.40598080906559997f, 0.23916870214407548f},
    {0.16894136862252918f, 0.915581463328303f, 0.8157239841355312f},
    {0.9244986964884855f, 0.9225316289008683f, 0.28153836464125714f},
    {0.41955458525994005f, 0.3152068923805521f, 0.002672303712122792f},
    {0.73367593751046f, 0.9603260274065111f, 0.9196675818462982f},
    {0.9525069072353697f, 0.1619621154599672f, 0.5554797257110137f},
    {0.28351865628880324f, 0.29187927249346146f, 0.4082309183099072f},
    {0.2794077835919623f, 0.4037229629535848f, 0.8615760323207556f},
    {0.34949392834464355f, 0.610821304500066f, 0.3990760547576102f},
    {0.7830819122321084f, 0.9282174232698069f, 0.7587668983771947f},
    {0.5837533622069513f, 0.05176047100845915f, 0.7443083089242039f},
    {0.7896475611781992f, 0.09402770995810505f, 0.8493458623405264f},
    {0.9602971970838149f, 0.2467868051402572f, 0.12230305063138613f},
    {0.496730988334666f, 0.6208192073258312f, 0.5539075599393821f},
    {0.5722340523037878f, 0.19130664585774126f, 0.1455736172090888f},
    {0.6467272205415092f, 0.9462516703358231f, 0.37046416180336283f},
    {0.9348444931815013f, 0.07320495539967109f, 0.9647503059179409f},
    {0.06522343045918899f, 0.41376303927984603f, 0.30657103378810713f},
    {0.30963518101845533f, 0.7761814716833911f, 0.6656847853050444f},
    {0.11363465631030223f, 0.4193815123722717f, 0.6271400131446121f},
    {0.13607256467858408f, 0.6837269170094735f, 0.24359895940587506f},
    {0.601597016232382f, 0.6231014033978256f, 0.4012415276773814f},
    {0.5809363473016088f, 0.33182511926317504f, 0.6261836556292947f},
    {0.21428788678832966f, 0.43129152913300006f, 0.6901281363779633f},
    {0.655420916463705f, 0.9219948877646491f, 0.6466046599538168f},
    {0.007173342792605508f, 0.6964997470228841f, 0.18000746158401215f},
    {0.8160479342596452f, 0.8740367133058276f, 0.48478413371733553f},
    {0.6912506880031593f, 0.25225048626564794f, 0.4021990835974433f},
    {0.534939301905601f, 0.027647046831738797f, 0.9426775237943608f},
    {0.7823757779813849f, 0.6514124168897889f, 0.22618193297674294f},
    {0.6678628262876061f, 0.10479167479593299f, 0.03152466054336023f},
    {0.8696931725336169f, 0.6796831743372299f, 0.2159761024045559f},
    {0.7228263247831443f, 0.5611412309870404f, 0.5932247439553372f},
    {0.42901575444914775f, 0.6655500693408951f, 0.5582828540310882f},
    {0.2414823457917844f, 0.6916222193872628f, 0.11778364447712764f},
    {0.045238428901542616f, 0.431603609053993f, 0.3258434045886198f},
    {0.1945742618301054f, 0.527075646635596f, 0.5716419434252067f},
    {0.3815700175001788f, 0.7137338417980971f, 0.6903532377517059f},
    {0.650235618979649f, 0.31662239002577064f, 0.7283538075590325f},
    {0.33650289056541505f, 0.32538473853890126f, 0.31557731853282145f},
    {0.9022902257426629f, 0.12482960652815933f, 0.6478639205303872f},
    {0.6876632935465914f, 0.6713211099608827f, 0.0297661959256168f},
    {0.880271252105792f, 0.6039182173836404f, 0.4067212815968808f},
    {0.5534625494653839f, 0.06108984991584865f, 0.5054682597042233f},
    {0.7414491542746896f, 0.25041333245561315f, 0.8693032513668935f},
    {0.8619624169203332f, 0.30203304850670243f, 0.4009445108482358f},
    {0.21633209650641294f, 0.6408086758222331f, 0.9095262203909925f},
    {0.06742067678085384f, 0.3191217856940478f, 0.25956360359095243f},
    {0.5089891015481469f, 0.1264850197720393f, 0.08348359954404061f},
    {0.05717052256993793f, 0.6703825687934001f, 0.9990386128165292f},
    {0.5149813070876208f, 0.7163113823113397f, 0.5586635831480529f},
    {0.14807041969981072f, 0.49995207020463284f, 0.13932682256649376f},
    {0.2456424356558803f, 0.38234848520255993f, 0.256317468858988f},
    {0.22354201468534085f, 0.8313442444989936f, 0.6288800293853857f},
    {0.16641035728862075f, 0.8233697752082612f, 0.9097037141617844f},
    {0.3777786386688383f, 0.914162270299626f, 0.18569731728655914f},
    {0.38992095280833083f, 0.21162403525111795f, 0.3603502440119213f},
    {0.5286216807612267f, 0.33196757318878956f, 0.0106963741313022f},
    {0.6484292022982775f, 0.18044366996982952f, 0.4147063629661699f},
    {0.367724815960347f, 0.819060804249593f, 0.4821317753431221f},
    {0.7402715894058243f, 0.4484222153584625f, 0.18954022637136203f},
    {0.9136000632716414f, 0.9675509764874063f, 0.20002341656310318f},
    {0.028108056878266896f, 0.83012825769198f, 0.7254098871532049f},
    {0.007168918978263661f, 0.5003044353667522f, 0.5705844592423036f},
    {0.8193899837668732f, 0.4501643741843345f, 0.4502567117550471f},
    {0.48464381939057477f, 0.9680148177250683f, 0.011995998718339784f},
    {0.30595925582374894f, 0.6910523710119421f, 0.022505732070094542f},
    {0.19529539604768764f, 0.3256476046495801f, 0.39130763816336167f},
    {0.3600226730715266f, 0.16193260827014777f, 0.9778140347529125f},
    {0.549718162290646f, 0.23943960127837438f, 0.6398700005835098f},
    {0.2796116714632133f, 0.4734729925572656f, 0.8367667926794328f},
    {0.381011783527026f, 0.5235693737226847f, 0.4480093953457598f},
    {0.5335887935975184f, 0.562922276293421f, 0.3854684819781995f},
    {0.4853000576194467f, 0.12116416549197273f, 0.8081507322767141f},
    {0.9913774933417793f, 0.2068491221170704f, 0.7992460106334904f},
    {0.4832208820178904f, 0.23509858200779143f, 0.3753972009494895f},
    {0.3921755702070766f, 0.7718735439199433f, 0.1898359991190708f},
    {0.3416357535279606f, 0.5983879917569759f, 0.6000739152934275f},
    {0.6024695992883986f, 0.45678405085351814f, 0.7627543438718191f},
    {0.1803661934144991f, 0.06392986698581793f, 0.7979481833708639f},
    {0.3333864343975722f, 0.8685965099207313f, 0.22718492774769605f},
    {0.17837096837666722f, 0.7743934997401191f, 0.035688356649435704f},
    {0.16886013769101682f, 0.0010467966427177844f, 0.5763607686238312f},
    {0.5492663279875425f, 0.8232237681365232f, 0.048112281535805046f},
    {0.2713239496826121f, 0.13464284714457975f, 0.4051653722694444f},
    {0.2710944857771441f, 0.3372853803972641f, 0.14365338653895177f},
    {0.6553093613860996f, 0.1964780703052179f, 0.2097030985191628f},
    {0.6075558445157909f, 0.6665620791968185f, 0.6047372925701779f},
    {0.7331900864068593f, 0.6705817244631036f, 0.9253233069069838f},
    {0.6004100986844136f, 0.1359158423958583f, 0.3914371716488737f},
    {0.4243219323973656f, 0.27271752136758287f, 0.8788494037325154f},
    {0.3831292044129594f, 0.9684646375293862f, 0.29307005372057915f},
    {0.2779347780497713f, 0.05733711849778467f, 0.3680492978549885f},
    {0.6456918349426418f, 0.10618609836786441f, 0.0811258948570801f},
    {0.5900364026185655f, 0.8253318979034099f, 0.23199414533674134f},
    {0.3431347840954335f, 0.0055393629176442305f, 0.977601683784156f},
    {0.8216988214723313f, 0.7757426609892175f, 0.05715617402926254f},
    {0.8239641671060935f, 0.6350739831894184f, 0.9049285169695911f},
    {0.39846810451942305f, 0.07566120919212027f, 0.5773929601210872f},
    {0.5385012898385526f, 0.6872605894223192f, 0.4760992396899988f},
    {0.21514990008483736f, 0.4139566909841429f, 0.9998512020041178f},
    {0.12848223117917423f, 0.6285922471436572f, 0.07750031509647015f},
    {0.9547025616371343f, 0.8984426859919532f, 0.2894616654548139f},
    {0.8314443478771861f, 0.8417919472317368f, 0.8856326052398932f},
    {0.1202279147350771f, 0.620633705547622f, 0.016730055614113448f},
    {0.9938783508949787f, 0.040659788431563704f, 0.03292584920781694f},
    {0.6116797961625983f, 0.2768292351032814f, 0.9398037182305453f},
    {0.19932119142432936f, 0.11403709342087687f, 0.15359974757095451f},
    {0.7188579908756016f, 0.8615161924849742f, 0.6226151940221939f},
    {0.5513761877518618f, 0.1509961654571238f, 0.7198491697715051f},
    {0.12866790911986148f, 0.047390420238788034f, 0.2677582512895297f},
    {0.1042148802684697f, 0.09967760069993037f, 0.12858426909698006f},
    {0.5309573304330187f, 0.12597358226304656f, 0.5129025806617464f},
    {0.3337955874889196f, 0.8483512318741341f, 0.12189315964274472f},
    {0.24818130696394203f, 0.11907397134943243f, 0.5063706912756926f},
    {0.7806452287962575f, 0.7354485202997719f, 0.7455887590048798f},
    {0.4603719560659876f, 0.16993691869404737f, 0.04076613744049651f},
    {0.30916890846100153f, 0.10691754321763391f, 0.4881218599463397f},
    {0.5143068923223145f, 0.6948698832224486f, 0.14540332772947262f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 9: random", "[votess]") {

  const int k = 127;
  std::vector<std::array<float, 3>> xyzset = {
    {0.3870804995254168f, 0.4184981743023395f, 0.1415154051322205f},
    {0.4067329443719314f, 0.5391485275591906f, 0.04651392380478514f},
    {0.3891775545683088f, 0.1609584250764866f, 0.022482489569708775f},
    {0.9853210555142274f, 0.13728324155666005f, 0.4614583052020693f},
    {0.6975515490402034f, 0.037365022079622556f, 0.6844203555157595f},
    {0.23365634412933023f, 0.22274938779501718f, 0.8104439730369377f},
    {0.5416702904050986f, 0.29545266528077496f, 0.4436600970825467f},
    {0.02156222131954999f, 0.7039036037936167f, 0.9650532985792604f},
    {0.515703820260997f, 0.3717436929515483f, 0.6110289924938481f},
    {0.7884694385037416f, 0.8128432803671278f, 0.8022835080079088f},
    {0.5317356221614055f, 0.41074135859852345f, 0.10951180760960288f},
    {0.2014383933770233f, 0.44439648412907296f, 0.19391417469373395f},
    {0.5268015915291537f, 0.8536981706599277f, 0.44287399859612564f},
    {0.6256727075327287f, 0.6458917654909246f, 0.9118246356399552f},
    {0.9444543962663182f, 0.3378520486630534f, 0.40100251753602656f},
    {0.5222003205858494f, 0.5304412092343697f, 0.6240365601717253f},
    {0.45232719469695526f, 0.5499508896180468f, 0.8298440193272834f},
    {0.7093508240857567f, 0.932400686216634f, 0.5744340594751702f},
    {0.5315591917799053f, 0.6181284832946177f, 0.8825188366706506f},
    {0.4567220633151362f, 0.02574451863418481f, 0.4951269882463245f},
    {0.4448351082746804f, 0.3203714045400129f, 0.8976530155557978f},
    {0.5966963389633279f, 0.4729091286064575f, 0.4136284496219014f},
    {0.026092965218313835f, 0.15843123566710826f, 0.3546528287516172f},
    {0.41742996268997434f, 0.8745237117769484f, 0.793262176859836f},
    {0.009190690077879538f, 0.552916985836049f, 0.3882516723761529f},
    {0.9175919711174392f, 0.5600867061399957f, 0.024526561423673487f},
    {0.6910191582312655f, 0.5189059622830279f, 0.4431097590597324f},
    {0.22726938977526523f, 0.7700344796581059f, 0.6002936862985613f},
    {0.8023080682416452f, 0.0005070326710386874f, 0.37867776955726906f},
    {0.8587742170573902f, 0.6844296860398391f, 0.004728477977985257f},
    {0.09050548218628862f, 0.2642628446086891f, 0.9929135425339368f},
    {0.09382711408024358f, 0.5871334476007315f, 0.8590035286122141f},
    {0.4947676786696047f, 0.5110185520365818f, 0.2806970778995789f},
    {0.7951143942805416f, 0.7499142416201428f, 0.19536449217647556f},
    {0.8219059227048044f, 0.321097251685048f, 0.09266807669565735f},
    {0.23287032000843366f, 0.4907490980198358f, 0.26767489376395215f},
    {0.13572676555648955f, 0.3068678086632439f, 0.3180671493021119f},
    {0.6595369169007882f, 0.5935101024622766f, 0.6507717602254687f},
    {0.08558561746248738f, 0.9538825431824756f, 0.8175650177994765f},
    {0.41014621908818494f, 0.27583950181427164f, 0.2905665827521168f},
    {0.19086129408531838f, 0.4685727336942539f, 0.1939973670122087f},
    {0.9654260179631947f, 0.1603886477378429f, 0.550718642696878f},
    {0.27897501519739454f, 0.22435873040092902f, 0.7120242072229644f},
    {0.8179222042555525f, 0.4158117573262732f, 0.4139212056237723f},
    {0.11755017368921694f, 0.6571967324199354f, 0.2954240397901087f},
    {0.23844256558653354f, 0.3406259103927667f, 0.17144824831467598f},
    {0.8727057949114114f, 0.6531823028483169f, 0.5151092962346753f},
    {0.1963769633547494f, 0.7985804713741436f, 0.09501116671844279f},
    {0.5778260532737167f, 0.005278796225866689f, 0.5693140167563244f},
    {0.36624258635494344f, 0.1338427515999333f, 0.5960782774998136f},
    {0.019453380994714053f, 0.07304428175421518f, 0.48486060560707134f},
    {0.7272336867804698f, 0.08864377453186867f, 0.7755159235616428f},
    {0.44837091508240334f, 0.9195628903310363f, 0.7115579607606726f},
    {0.31268286076319984f, 0.12176955500839326f, 0.49605512820595155f},
    {0.5173885296502071f, 0.5257416246340068f, 0.9559598840894167f},
    {0.004275028083741028f, 0.5686402353734642f, 0.5930712300185401f},
    {0.7612444693359774f, 0.939152818550338f, 0.3065649427650161f},
    {0.6105426169745117f, 0.510631195483239f, 0.0646141642276783f},
    {0.8249508127000362f, 0.8014313310558328f, 0.5148205980809959f},
    {0.5717766704294763f, 0.4048022431617885f, 0.2973453302555126f},
    {0.45179670699537555f, 0.7027108861499026f, 0.11522340499848172f},
    {0.6069936695645559f, 0.47430804858342435f, 0.27331138782547504f},
    {0.725764559953432f, 0.6073321402390168f, 0.7790702651300199f},
    {0.794340904964811f, 0.2592341025810191f, 0.7002336298153042f},
    {0.4560050086229914f, 0.9388519888604622f, 0.7614751959311445f},
    {0.18266779559566004f, 0.15787012563086344f, 0.12594743661229812f},
    {0.8379841357592243f, 0.9758079616812197f, 0.7626406352340025f},
    {0.9658650574192975f, 0.03197632623100133f, 0.16982367776324037f},
    {0.4705726301058355f, 0.22116016073679834f, 0.5548078320292924f},
    {0.49689222775924935f, 0.11278968062111361f, 0.47736730672359984f},
    {0.5379556944381839f, 0.9884759803616031f, 0.8401376736986934f},
    {0.7524483808346357f, 0.6405946181874077f, 0.0778614145706854f},
    {0.2256968768812354f, 0.23403833748795055f, 0.6437080675527475f},
    {0.14300984145300777f, 0.7843939703596975f, 0.33249320308956143f},
    {0.9159056215315503f, 0.8807019029443773f, 0.3359971867605318f},
    {0.718976538841195f, 0.6993307774169965f, 0.4562926799018011f},
    {0.6680017631118148f, 0.2778288045631173f, 0.31283742939038284f},
    {0.9013162357600488f, 0.48492846174329185f, 0.29092126341556035f},
    {0.6303609365215197f, 0.0020440159139715197f, 0.17025163030132895f},
    {0.3816862194365921f, 0.7708223815703092f, 0.8845396954938496f},
    {0.7979543487833447f, 0.9021430952835812f, 0.44706433305542836f},
    {0.6612505320908466f, 0.8002828442599252f, 0.7870976872854596f},
    {0.30859389516418667f, 0.038266133061196084f, 0.4059267354158853f},
    {0.8233058669025938f, 0.7820861215004513f, 0.26595050052240354f},
    {0.5311593586344696f, 0.09995674100029595f, 0.3669457782305552f},
    {0.9595761298830041f, 0.6879851612745342f, 0.5330961968452664f},
    {0.5676457086601406f, 0.1547101654531744f, 0.36066947765725976f},
    {0.09019124587002791f, 0.9421517326267895f, 0.3416751751483389f},
    {0.4480313212048087f, 0.17326203576193078f, 0.82527102562911f},
    {0.2730218911743161f, 0.6156960273248079f, 0.48850330734776704f},
    {0.8907604767622427f, 0.47388854210275067f, 0.17159138465886248f},
    {0.588668564771153f, 0.1138279505880081f, 0.9923438939816697f},
    {0.5581942235605288f, 0.5268307897322695f, 0.31856892119390245f},
    {0.8846921856675689f, 0.4175867102478279f, 0.7375151335688471f},
    {0.43362818448651497f, 0.5143530976863963f, 0.15590011199356457f},
    {0.9713421306550629f, 0.6195369978123724f, 0.6408018195218732f},
    {0.7172384245727229f, 0.6251848347689093f, 0.7944800043407585f},
    {0.4695535313490232f, 0.7971661530006384f, 0.8824639173407971f},
    {0.9975003403931937f, 0.8153888245432906f, 0.49735683745398784f},
    {0.44774615137938145f, 0.42630225077327355f, 0.10356526150107104f},
    {0.27518649409451224f, 0.8718709024659199f, 0.9070335578783737f},
    {0.13190311865884652f, 0.11661961080622718f, 0.6777346446039695f},
    {0.7453513464384991f, 0.024025534908891033f, 0.7978762204039394f},
    {0.12077820663335037f, 0.049597860952611206f, 0.9531470121679959f},
    {0.6681747013004528f, 0.43555037452689527f, 0.6410714333749349f},
    {0.5626510751727888f, 0.6931147237753083f, 0.6160184360048403f},
    {0.973829141584967f, 0.10499901994258398f, 0.6284022633981063f},
    {0.8999568661225307f, 0.49341239187065367f, 0.8774320044892231f},
    {0.06318036278368067f, 0.4143265598663657f, 0.7868985584861928f},
    {0.9732369825464824f, 0.7689434099105666f, 0.40760969810825853f},
    {0.6483633875670016f, 0.5924774225043499f, 0.6930177885311318f},
    {0.12224162464301747f, 0.9312633842190915f, 0.9034080318206068f},
    {0.8286212723389189f, 0.643317875705889f, 0.9176377339170416f},
    {0.24068592414631507f, 0.12760539513162683f, 0.9730430256230823f},
    {0.1276388848225416f, 0.3081435900579963f, 0.8178719996389449f},
    {0.7856585086433469f, 0.5536325429016383f, 0.5365376894920673f},
    {0.6501556598227356f, 0.17530411362664167f, 0.9769484286870256f},
    {0.23784699010141164f, 0.5014024354598406f, 0.15150472781012225f},
    {0.46599150496535535f, 0.20493835255590476f, 0.0037711944699806432f},
    {0.474504088278246f, 0.6565718219937001f, 0.5001507042226637f},
    {0.07415517665373716f, 0.5417837887286928f, 0.472928394882951f},
    {0.16570506511401129f, 0.9942414897133521f, 0.5148058474852962f},
    {0.5134275650446165f, 0.8076446506365852f, 0.8019385664746708f},
    {0.829610358078468f, 0.3586985139504528f, 0.9493159980313807f},
    {0.9419893695911706f, 0.8057715200554959f, 0.7769030990859719f},
    {0.3961498353073275f, 0.8940828667288891f, 0.9434962501335191f},
    {0.2254647166904521f, 0.9022537014460774f, 0.7302787663404915f},
    {0.261646359269911f, 0.9804712280556617f, 0.22053416854057328f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 10: random", "[votess]") {

  const int k = 127;
  std::vector<std::array<float, 3>> xyzset = {
    {0.23352881368997436f, 0.2785244047814208f, 0.06977356342500862f},
    {0.6264460096278899f, 0.4172269638461039f, 0.2558788393896415f},
    {0.2701416120887684f, 0.823015821969451f, 0.8981716897368928f},
    {0.07553602071017274f, 0.7154909952035322f, 0.8461690265132494f},
    {0.9453648581195279f, 0.22205000611558323f, 0.988142419306572f},
    {0.34732574412158423f, 0.38153427557102815f, 0.5860488837754207f},
    {0.9061013446013797f, 0.24287292787752324f, 0.8755840829412949f},
    {0.8498338878912076f, 0.3711569033158941f, 0.682950520579408f},
    {0.6939810435817084f, 0.5315261198736545f, 0.8768034389776515f},
    {0.008016503748105142f, 0.871594630180899f, 0.2656211246572714f},
    {0.5175023673341258f, 0.8937306026154267f, 0.8908019081730263f},
    {0.7889306995718864f, 0.7545609786749281f, 0.7066756799325348f},
    {0.3675545881447786f, 0.7761102391894247f, 0.14761795030843738f},
    {0.17960484650866437f, 0.8541363312706673f, 0.7146359405470963f},
    {0.20534522548859568f, 0.9212368697681679f, 0.3978640592178113f},
    {0.14777056953992962f, 0.45346497145047093f, 0.3047584723068988f},
    {0.9056617070750835f, 0.6005412893679888f, 0.8747077843646592f},
    {0.2650022118174372f, 0.9459948599006026f, 0.0625174921377204f},
    {0.31483915482140123f, 0.5323624613482206f, 0.566732611457703f},
    {0.11549389948077426f, 0.6202753903296384f, 0.6192115407847434f},
    {0.32996464882534726f, 0.9055885210644707f, 0.9203748209747608f},
    {0.8356839836198222f, 0.037952304324033626f, 0.2670137407089399f},
    {0.06662040979487016f, 0.8796912721904634f, 0.5553143012878882f},
    {0.21263027966022396f, 0.5381037291564588f, 0.15779724257354877f},
    {0.15830457013405652f, 0.15127927724390033f, 0.3397814463818801f},
    {0.9125528168647306f, 0.8221197988953992f, 0.8617999402856448f},
    {0.3319778535935003f, 0.08556509629039633f, 0.8416038207946371f},
    {0.21534430915284808f, 0.28014347924587124f, 0.4926593124875672f},
    {0.006818214428623737f, 0.8606125404124123f, 0.7098845371132967f},
    {0.5721600768130489f, 0.2533887212795136f, 0.5696906629225116f},
    {0.5927893376427051f, 0.27098077414087585f, 0.6751177940226553f},
    {0.8391341597831172f, 0.7453300612381542f, 0.6565849327717642f},
    {0.7909661628511442f, 0.18378619468647517f, 0.8956452610871177f},
    {0.542076110402116f, 0.7039827014194227f, 0.08513215239025373f},
    {0.40374309454059376f, 0.9435235549445519f, 0.4542338649083798f},
    {0.33610035832673724f, 0.5683086161985877f, 0.22021303599629516f},
    {0.44270928473344806f, 0.06007498056353777f, 0.33199921759544704f},
    {0.7032653160294874f, 0.5162565386026807f, 0.5569363378057788f},
    {0.8882646847195369f, 0.8627982074204193f, 0.4670690258590042f},
    {0.3051167098073816f, 0.14404293333222773f, 0.578156106268356f},
    {0.5726793322626991f, 0.1896733173004771f, 0.27761671559719237f},
    {0.7304880591989207f, 0.6009849134238617f, 0.6869785696121379f},
    {0.5521712847878627f, 0.37514426168174275f, 0.03707691127446966f},
    {0.38728291671378356f, 0.6765918330298277f, 0.1322575172439614f},
    {0.4670150631767155f, 0.3220735556195712f, 0.2278247515559989f},
    {0.5867040282383447f, 0.43883054875928496f, 0.24654183128702123f},
    {0.3049200893567159f, 0.7232818214773273f, 0.08660721350393819f},
    {0.5599872449746675f, 0.4670185785844775f, 0.690316839086781f},
    {0.5183807619058847f, 0.5954676002365403f, 0.6641058899526352f},
    {0.4421441450397977f, 0.1510634211226698f, 0.6787279806859785f},
    {0.5415941024299229f, 0.1461217252002921f, 0.9096282495353103f},
    {0.06232086604389264f, 0.5867799733686291f, 0.10048518126485373f},
    {0.4110937799696487f, 0.5490175498505397f, 0.43006735842264043f},
    {0.6189854253217103f, 0.8874040312094087f, 0.26527335288966425f},
    {0.12632185677409624f, 0.7058113523347801f, 0.3330313205541514f},
    {0.469633306013841f, 0.3655302593534976f, 0.4454519641318918f},
    {0.21826568209754282f, 0.3549957731233794f, 0.0343212742464547f},
    {0.10369278369462542f, 0.27416563309376996f, 0.1728556176778775f},
    {0.06968924993351744f, 0.6882597969051439f, 0.3094779721402152f},
    {0.487542664213937f, 0.18503627595575933f, 0.30399681350898f},
    {0.7622103519286975f, 0.005378782952839889f, 0.05667142756242005f},
    {0.20311637609442923f, 0.5282450865093874f, 0.7034241302397876f},
    {0.1343601070223549f, 0.8819020758037993f, 0.13348449907175464f},
    {0.012503777531863824f, 0.36174687294445307f, 0.2595382759187409f},
    {0.31821906742250616f, 0.9558130963361178f, 0.25806233584358307f},
    {0.07888393942797733f, 0.22251612210274563f, 0.9141458280706447f},
    {0.9751258595428367f, 0.8939360883160992f, 0.4050003454113391f},
    {0.4904896073566726f, 0.3870036575338114f, 0.05838380974363511f},
    {0.25937303491708597f, 0.4844330758660109f, 0.4896224038149747f},
    {0.27626784975754215f, 0.5236621334395849f, 0.31988890360493716f},
    {0.07931933683317371f, 0.02007622529224029f, 0.9486553075645808f},
    {0.4650668400859419f, 0.5370045135516259f, 0.5309718990445125f},
    {0.8144161089373473f, 0.46975507966977714f, 0.1722448002472532f},
    {0.7580908131732774f, 0.8125819830538574f, 0.29326852266033343f},
    {0.13901952247109417f, 0.8947153020135915f, 0.12291214608134926f},
    {0.03012830420744761f, 0.8671760309531631f, 0.5681682195166896f},
    {0.2236705565944329f, 0.30690809633793215f, 0.14182413556224438f},
    {0.825340186835439f, 0.32178743718366365f, 0.5946399800298081f},
    {0.4553405087400294f, 0.47612892708206234f, 0.4003127236961459f},
    {0.8412822679561748f, 0.4107471727433535f, 0.8778968098891792f},
    {0.8536390826275384f, 0.456390756156142f, 0.45624466188715396f},
    {0.05746856279340273f, 0.8553714146436777f, 0.12135989557013604f},
    {0.8617206555488023f, 0.8330885059473203f, 0.06936744133788275f},
    {0.5979687464063684f, 0.2868368117587152f, 0.47478336328884496f},
    {0.3999461124276784f, 0.8170837142633193f, 0.9727337849618732f},
    {0.09595092408019879f, 0.25324582054286016f, 0.12779646202143813f},
    {0.03999065487243192f, 0.30579764573549706f, 0.6742441349116802f},
    {0.16185845213542893f, 0.8846097683743721f, 0.7046886295377018f},
    {0.7421768277719618f, 0.2918639496650324f, 0.9793731510551731f},
    {0.01022893856158602f, 0.11727267628685711f, 0.20700291907310153f},
    {0.18375927662789782f, 0.28139170607512964f, 0.7749890551475164f},
    {0.6339038017102617f, 0.16890632371526626f, 0.9831265089116151f},
    {0.8165853784907958f, 0.09648453641737198f, 0.5550928477893483f},
    {0.1142694949501506f, 0.959259601656451f, 0.42175172319438325f},
    {0.26049960411654405f, 0.653998953577818f, 0.8054514549738179f},
    {0.6546997237162889f, 0.21432723136175058f, 0.1558481184743351f},
    {0.5647897605520547f, 0.2947344207704481f, 0.34544795128248185f},
    {0.9604324599150388f, 0.07068716364922101f, 0.6323392649662408f},
    {0.1351922711170116f, 0.333584620579766f, 0.492279551678351f},
    {0.40929862378357573f, 0.3892036898547443f, 0.3151102888491437f},
    {0.5691325910345614f, 0.875093598209302f, 0.862747252984888f},
    {0.45276982707788516f, 0.3250951009185521f, 0.57797604283846f},
    {0.4333492929650924f, 0.6642520800398545f, 0.014510364894546268f},
    {0.06372176434417998f, 0.6716899263082542f, 0.8987827394181362f},
    {0.9672926232472066f, 0.7154341562244882f, 0.8306709349201358f},
    {0.36922008664008465f, 0.4166299895301072f, 0.46044190632473503f},
    {0.6207061966906146f, 0.5347043298756988f, 0.7126143011028706f},
    {0.3891133689541091f, 0.4710228562178773f, 0.11453826451166205f},
    {0.23734810933709694f, 0.28919865775172227f, 0.1611860487751281f},
    {0.8612717268775849f, 0.9340423610304839f, 0.10314014496050639f},
    {0.8795192801022025f, 0.8128356379464393f, 0.8203179802693011f},
    {0.9530855546635514f, 0.17422946676927087f, 0.24107944364371114f},
    {0.04070772037654602f, 0.5617406467260672f, 0.5772906555062091f},
    {0.2582296262329825f, 0.43272166753519015f, 0.40549320444797676f},
    {0.37741339530001405f, 0.7610046454103522f, 0.4873806616973302f},
    {0.8374967610419594f, 0.8887715943431548f, 0.4960798061077085f},
    {0.5241583346591024f, 0.23064172942638272f, 0.019152386667997345f},
    {0.07910275384400478f, 0.48851500089416566f, 0.4377304799404751f},
    {0.08192587244825789f, 0.9678156727295173f, 0.11720223490432724f},
    {0.3912162452128747f, 0.00906051458750079f, 0.19134283009051845f},
    {0.9561098329564918f, 0.5439795453398018f, 0.1466561450020758f},
    {0.5502212837950129f, 0.6034181504229865f, 0.6443889460438547f},
    {0.22155324996788373f, 0.4631614256818275f, 0.8499685080859175f},
    {0.36477608640507597f, 0.8176108535149198f, 0.49229978826019505f},
    {0.9221042295738555f, 0.40505292377486f, 0.6233027018152202f},
    {0.9619899865574199f, 0.5472237300594734f, 0.12775408362064755f},
    {0.43459495103664203f, 0.27885158930840614f, 0.016391535333159513f},
    {0.5286920048289171f, 0.9265166252320802f, 0.9330075697236034f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 11: random", "[votess]") {

  const int k = 127;
  std::vector<std::array<float, 3>> xyzset = {
    {0.9201439098671129f, 0.8242479076471689f, 0.09094205786567455f},
    {0.5490269510749053f, 0.4700776332653702f, 0.9888455350389479f},
    {0.2842926452257877f, 0.9031908274290372f, 0.8654084666094743f},
    {0.5593278875897604f, 0.1824521418255124f, 0.1497536391390819f},
    {0.3331233133736182f, 0.5685806969079275f, 0.5977640394301813f},
    {0.8878225913408241f, 0.16645931349197995f, 0.31979112041769175f},
    {0.17453644552010616f, 0.9303505315732743f, 0.3167319033826298f},
    {0.5986017720826198f, 0.6254956368083715f, 0.0030426689091521686f},
    {0.6965389730398573f, 0.18231680065026945f, 0.7838283292728363f},
    {0.42045360503916096f, 0.16262086118184538f, 0.34098580217282703f},
    {0.6315914242854365f, 0.4655269426928702f, 0.09733364230412611f},
    {0.4790410049869417f, 0.6298234868234823f, 0.28559414647577497f},
    {0.7263545682771376f, 0.6513474942923201f, 0.8745230598155962f},
    {0.6360202949357991f, 0.003698642479565195f, 0.547847128491777f},
    {0.9652921225996063f, 0.5075553169372367f, 0.9143662424689031f},
    {0.48488817717401955f, 0.019952485946114984f, 0.7577216825074824f},
    {0.7124793953829179f, 0.5979275016247882f, 0.7739389855803694f},
    {0.7901754240167959f, 0.4574455433911112f, 0.37490270152343474f},
    {0.9777320778382033f, 0.25668643011206416f, 0.847173072061378f},
    {0.8996128026574136f, 0.5717491974143785f, 0.5874799482548212f},
    {0.9095286117429872f, 0.07005778257613293f, 0.6529803241749139f},
    {0.6295958130598281f, 0.29173034223435834f, 0.7316433594707809f},
    {0.20973648957098612f, 0.01959917100275499f, 0.3412762122963313f},
    {0.7812296964166869f, 0.32547638855831296f, 0.7564049068007541f},
    {0.2222730833599953f, 0.1714635912109348f, 0.7823553733194024f},
    {0.2007775944080421f, 0.7696116410497262f, 0.40542779211632285f},
    {0.7706838870664792f, 0.9443007857683824f, 0.1088656036511646f},
    {0.9194226807663336f, 0.5545727973775303f, 0.7551008904022323f},
    {0.7015891912248313f, 0.7163240157148322f, 0.6511651830692073f},
    {0.15938848357064272f, 0.5515546981406957f, 0.3659330055615545f},
    {0.7190693353184f, 0.7921154832307399f, 0.17728863286547525f},
    {0.8112360574212617f, 0.14503096974446805f, 0.3626089231166738f},
    {0.8900882863299773f, 0.49307796013326044f, 0.2443058304769663f},
    {0.7644897778171148f, 0.5184278229850184f, 0.8577723333972964f},
    {0.42161442941335503f, 0.3215766455895792f, 0.326051364405039f},
    {0.5203228666663653f, 0.6208821364182716f, 0.9450547072584592f},
    {0.5512327363520529f, 0.5566160145169369f, 0.84295744896388f},
    {0.775063947932332f, 0.8402465485154281f, 0.036370208165868334f},
    {0.8219176536537929f, 0.48902731474492f, 0.4453591863584113f},
    {0.07854878891628758f, 0.634566473537794f, 0.28577056582503124f},
    {0.9347442396539358f, 0.5404491514285489f, 0.01804982896208107f},
    {0.35744405115734834f, 0.07693523410749248f, 0.6722221791550289f},
    {0.9030970755967926f, 0.42588628178685983f, 0.5169944892956336f},
    {0.21039690222642093f, 0.2350949942970182f, 0.1739317853929112f},
    {0.670784983313174f, 0.9588297332054386f, 0.573421120622632f},
    {0.466521790028271f, 0.25634260778244944f, 0.34657901945554004f},
    {0.9629561366266842f, 0.5680385258205007f, 0.8730094398504278f},
    {0.2662835873388475f, 0.16472956084138968f, 0.47793424341229596f},
    {0.3845994343910304f, 0.5279862835859134f, 0.31639598042479156f},
    {0.24771108498669436f, 0.43248556060600374f, 0.080710340052074f},
    {0.21411557540256443f, 0.8341216185313175f, 0.3190774721567724f},
    {0.46412575888566976f, 0.4441919090004378f, 0.6707858217049328f},
    {0.582740854512515f, 0.08082112458533053f, 0.3931454391812592f},
    {0.20250315183174594f, 0.467865718724809f, 0.2741354527009835f},
    {0.2768514828401759f, 0.4374001906331093f, 0.4781022227851408f},
    {0.3990040605689932f, 0.8963784053806105f, 0.5405178377810513f},
    {0.584107630074237f, 0.05650608660920464f, 0.5060067918139486f},
    {0.9394469788678858f, 0.14095573983950505f, 0.3821507326142678f},
    {0.5509363852392867f, 0.3856939513919333f, 0.2769039062697062f},
    {0.22665125203646275f, 0.21324815560435129f, 0.5524025651113056f},
    {0.3824696537455855f, 0.22882680994855387f, 0.08744592657355377f},
    {0.536265499414936f, 0.4367392945594428f, 0.3090626281560709f},
    {0.38952953840766935f, 0.6131929826806369f, 0.25119781666237706f},
    {0.6181734499100642f, 0.8526437620747386f, 0.6722649104582753f},
    {0.5264621351628579f, 0.3132504367637887f, 0.3290137105648142f},
    {0.6299063798633621f, 0.2762795814730934f, 0.8002515820788885f},
    {0.8490571944472758f, 0.5503277797585688f, 0.7037301691570804f},
    {0.2503997751018112f, 0.5165987777714227f, 0.8620446674288235f},
    {0.8055161819709339f, 0.46883108663403084f, 0.7693124064905166f},
    {0.21361977567840706f, 0.5413653290314202f, 0.8334330008569849f},
    {0.2464646686579035f, 0.22553190570579418f, 0.5447058112762198f},
    {0.3265921770724812f, 0.33245364664937616f, 0.13034513288172622f},
    {0.011174361592168225f, 0.5658132685176139f, 0.18130734893975808f},
    {0.7055536562262562f, 0.5267923594720678f, 0.5833207262401077f},
    {0.78890364939294f, 0.4108777982521874f, 0.5795564753317607f},
    {0.6096892384841939f, 0.8904312293702207f, 0.13587798646196314f},
    {0.9851486945665221f, 0.7148948981984444f, 0.3877246114844911f},
    {0.8251546779033953f, 0.35730636911709557f, 0.4363971126032259f},
    {0.03259571857938415f, 0.15349069566557694f, 0.09939133749364637f},
    {0.10462495287131246f, 0.4706417372162712f, 0.17095083649752207f},
    {0.29635981169909154f, 0.4088793909914513f, 0.19118132089331374f},
    {0.8024244260121342f, 0.7349033708462522f, 0.8402598123189816f},
    {0.021943411245408773f, 0.8169788719139646f, 0.8945913620247198f},
    {0.4908564119241374f, 0.5128311098472482f, 0.111263901053965f},
    {0.32199890493001937f, 0.8734440288348606f, 0.33051852131463544f},
    {0.9653581940234137f, 0.5299442999111424f, 0.9006418881840328f},
    {0.32160537421446f, 0.1873821128165094f, 0.6030689953024108f},
    {0.6577877226349494f, 0.20505237962355138f, 0.6759819248090356f},
    {0.1941724250073944f, 0.4973960497782478f, 0.9912676295257662f},
    {0.06530086189597839f, 0.2110657893179344f, 0.12623011439947407f},
    {0.9559416706365147f, 0.05436294437221301f, 0.14980132519377776f},
    {0.5893420357988228f, 0.7260617196219f, 0.6741653810773699f},
    {0.4590145254805823f, 0.8871821150095941f, 0.5680205123923244f},
    {0.1739273364608368f, 0.2866298551071981f, 0.45476896996749405f},
    {0.08369656891319421f, 0.1422610620094077f, 0.8275956271610143f},
    {0.648092523592907f, 0.8774833008057833f, 0.29790744490673027f},
    {0.7992619916977983f, 0.9570939479462246f, 0.45216819654121043f},
    {0.5578669392646418f, 0.1931780540621275f, 0.9986905351955453f},
    {0.5196831984020884f, 0.14088342841167967f, 0.4041648481102649f},
    {0.4156603351055933f, 0.4700714436039688f, 0.27382077647910263f},
    {0.7549714475655319f, 0.16400040546665084f, 0.13384585024355422f},
    {0.7105111754943692f, 0.40195542864116274f, 0.19113487030665932f},
    {0.9570610849842051f, 0.7794442274379927f, 0.13946196756200535f},
    {0.8040068217180038f, 0.7587711502302895f, 0.771224495848154f},
    {0.10654758701025435f, 0.036667768922820976f, 0.3445129069353272f},
    {0.31348807499965126f, 0.7712709160048559f, 0.41250859767269765f},
    {0.3367781586531132f, 0.246773536909779f, 0.5356333694333496f},
    {0.8999302741067513f, 0.6803740294491467f, 0.5717270380827851f},
    {0.6625161983643821f, 0.016318506014421974f, 0.7954712575015991f},
    {0.6027136774226084f, 0.5786343576834999f, 0.2586929880915678f},
    {0.47757950444081443f, 0.9271016413356306f, 0.8614259043742355f},
    {0.8133015067681513f, 0.13505696254598187f, 0.17323695386704752f},
    {0.35766458085264785f, 0.07805891323019343f, 0.2987934537521886f},
    {0.06402277710253834f, 0.4652110097291605f, 0.2776170430138353f},
    {0.4810118291735148f, 0.6050835876208382f, 0.6987122085880918f},
    {0.971249067153563f, 0.8757029184259757f, 0.9262271428998784f},
    {0.6853924750517455f, 0.09916348510903283f, 0.7415826467168897f},
    {0.07460144965899362f, 0.7894191143884162f, 0.3719283597524763f},
    {0.6646544815231807f, 0.3927667438427862f, 0.19132797910200094f},
    {0.12290347031724413f, 0.8963038127089393f, 0.9721079271470284f},
    {0.8375588828630863f, 0.544915638164109f, 0.07509517457081116f},
    {0.3963772265763147f, 0.1405154834398178f, 0.09802505273592665f},
    {0.9675745402100342f, 0.17717824867706367f, 0.3111017021112057f},
    {0.3897996578407563f, 0.6916654573573027f, 0.4784170694101314f},
    {0.9071367048662893f, 0.27942543137900755f, 0.020011278335876015f},
    {0.4553996755745514f, 0.7767578102514396f, 0.4860537822961196f},
    {0.5062648243819514f, 0.8962059500922909f, 0.5573355403553196f},
    {0.9235968311460157f, 0.09112223964208765f, 0.27999642240584866f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 12: random", "[votess]") {

  const int k = 127;
  std::vector<std::array<float, 3>> xyzset = {
    {0.01998152864067826f, 0.956897380920644f, 0.43684699131989213f},
    {0.6709770133874158f, 0.02919697950472655f, 0.7792278480557735f},
    {0.8478180739690899f, 0.6348119165165806f, 0.04663338445684906f},
    {0.8678515595656298f, 0.9745399207008063f, 0.23704103269416266f},
    {0.7011775583847318f, 0.22173120116002953f, 0.45356940432841697f},
    {0.9319901241997575f, 0.8305654416173776f, 0.4537759408777593f},
    {0.9547940384204856f, 0.5035732219603376f, 0.9739156292071752f},
    {0.35959474162897176f, 0.7294209896117219f, 0.4529690683469988f},
    {0.8312623432349098f, 0.36601271914910893f, 0.6163180926779781f},
    {0.05373768819338898f, 0.3620441113642129f, 0.02324280463502837f},
    {0.21269448876109698f, 0.4450138751946874f, 0.6654890781795916f},
    {0.9585988187988503f, 0.3685958684256473f, 0.13434696739575014f},
    {0.3879673941284415f, 0.672932585948722f, 0.20649298977457897f},
    {0.24716974044530826f, 0.7955282012337497f, 0.27731939553701945f},
    {0.6939448184628905f, 0.9569736540671662f, 0.009172904628800826f},
    {0.9806992161169986f, 0.8382099626609543f, 0.3547946129739098f},
    {0.16678403444640844f, 0.11205298407207165f, 0.09910895266144426f},
    {0.39435832486542466f, 0.5995526357249177f, 0.2944754598751599f},
    {0.7141226828768444f, 0.1291725512827817f, 0.1078406705128816f},
    {0.43239298981610164f, 0.35941722782537255f, 0.36628142135780595f},
    {0.6934973727382695f, 0.7861134919673993f, 0.12740346409302772f},
    {0.9902787848596385f, 0.17253100880399075f, 0.9250577899867959f},
    {0.10120218475622644f, 0.9364971591167264f, 0.39788624049622656f},
    {0.7646348743246061f, 0.41290427083378767f, 0.4926107746725019f},
    {0.30520261517562586f, 0.14156554693350076f, 0.2747978671561123f},
    {0.10594159735585362f, 0.05447534275721011f, 0.7193102916540982f},
    {0.42400555201788104f, 0.8320702848056406f, 0.8703243588719455f},
    {0.6515885104534577f, 0.19919443841458473f, 0.22574831072623747f},
    {0.20731320283084376f, 0.059389525327292136f, 0.9180813867399988f},
    {0.0741564012259095f, 0.7413682448526773f, 0.13252270019513113f},
    {0.7443426371096199f, 0.4402489291253251f, 0.8938929961315479f},
    {0.6782358372178992f, 0.11384037246094958f, 0.41400919034230454f},
    {0.8265202481396097f, 0.44249097707747265f, 0.020592969767133762f},
    {0.8578534268473921f, 0.5805240219983052f, 0.4564861957925761f},
    {0.3557285693603791f, 0.1676527866481674f, 0.85605019556824f},
    {0.9943265767844527f, 0.2125871425843059f, 0.8361752568069704f},
    {0.2983102773765576f, 0.20629503272402105f, 0.9355535547413479f},
    {0.33253876360154155f, 0.05118679183115371f, 0.33232938487937946f},
    {0.07944140465655258f, 0.3689612625391495f, 0.5016476652215761f},
    {0.7251757801613872f, 0.15892349403288086f, 0.7771049524507121f},
    {0.8003613499540022f, 0.5938878435838837f, 0.6550855056186751f},
    {0.9647178801048805f, 0.26941180624125616f, 0.760576370098207f},
    {0.735695235989291f, 0.3328098890750416f, 0.6632702862874231f},
    {0.11202038433826211f, 0.16389439918965165f, 0.7356920439334784f},
    {0.4847439926866671f, 0.782094829505225f, 0.3636986596904609f},
    {0.29961795066518937f, 0.5025980467740861f, 0.6909282689555153f},
    {0.6209007891720012f, 0.644011321155663f, 0.7710922987996044f},
    {0.46332271771751654f, 0.15349478529425997f, 0.5393231618236565f},
    {0.8848034795906543f, 0.9212808850424916f, 0.018865134877322998f},
    {0.5000814719657495f, 0.7965156706221431f, 0.43794847984667606f},
    {0.4575942677383463f, 0.48274249274459347f, 0.5611038774430392f},
    {0.6732052095823724f, 0.7963123490785675f, 0.8851681453397372f},
    {0.8188628297508335f, 0.060812696206923866f, 0.5301867825516554f},
    {0.9652720684634639f, 0.9089560997573951f, 0.5656564319081325f},
    {0.4354074132890736f, 0.3733299879595824f, 0.07976846359171252f},
    {0.8331196005357843f, 0.5220350927530231f, 0.2993355449499018f},
    {0.5605694854498366f, 0.29802408961293125f, 0.8117175247177066f},
    {0.7238036528003928f, 0.6839278330935801f, 0.816324336870012f},
    {0.8391044420941637f, 0.18455000603953653f, 0.0715114194087848f},
    {0.12562134879457065f, 0.734316890556537f, 0.4242839733051985f},
    {0.7251471900556657f, 0.7480851175309977f, 0.9831654306642114f},
    {0.5886063183105741f, 0.26850434007694435f, 0.08511384734101801f},
    {0.08930006089801823f, 0.3372491995914366f, 0.20026755280426922f},
    {0.6528132592247183f, 0.48736989581999135f, 0.014308154718829957f},
    {0.9967342842989481f, 0.9682788588690582f, 0.16273948727794907f},
    {0.8396324306964968f, 0.8240484797916308f, 0.49946436182166754f},
    {0.05012572467319998f, 0.7672432578143404f, 0.11998384169772858f},
    {0.5049557186270227f, 0.6213115759136757f, 0.04777893210373407f},
    {0.05101978412558117f, 0.36052675511721943f, 0.853061937271123f},
    {0.8297293259472504f, 0.30248641814902355f, 0.21985260785657867f},
    {0.8038335959504623f, 0.7048434341116757f, 0.44176980348816397f},
    {0.3469197543833258f, 0.7448044968617277f, 0.13461402550742874f},
    {0.14319859971323168f, 0.6814690191832925f, 0.9646018855088982f},
    {0.11721950371845791f, 0.3888699415065162f, 0.3803880577882812f},
    {0.7834119045182375f, 0.21071267677230665f, 0.13485140323843114f},
    {0.13510034493164014f, 0.8869966339528483f, 0.952368417152352f},
    {0.452711479321248f, 0.0710302719158955f, 0.4404900633310075f},
    {0.8076816210973022f, 0.8779482550607776f, 0.07248022703165447f},
    {0.11372776324746636f, 0.40483389199003816f, 0.41948149002030066f},
    {0.337647436068529f, 0.4669807761170687f, 0.5852733903309705f},
    {0.22760032730173174f, 0.27525150800480225f, 0.9149800085910536f},
    {0.3892675794843945f, 0.38229466190319694f, 0.06259643929054359f},
    {0.165201825577732f, 0.8984604488839664f, 0.925912729230768f},
    {0.4476497859260754f, 0.347027296166162f, 0.1657954533976086f},
    {0.19831844620382533f, 0.39450647361321733f, 0.021123480822283103f},
    {0.2905080212768859f, 0.6734228502989276f, 0.0031654742566810112f},
    {0.7963874049311161f, 0.23187809112506974f, 0.4396775083724356f},
    {0.8463008829333608f, 0.779360985151798f, 0.2445186909489282f},
    {0.1707097000816704f, 0.21268582251638235f, 0.27261662029779155f},
    {0.30757053738546347f, 0.46860507882508784f, 0.49916920363972483f},
    {0.26928672309870827f, 0.5633991848366927f, 0.029841301835693335f},
    {0.932098079909311f, 0.5373856616615872f, 0.4147619310299173f},
    {0.2027657756934399f, 0.35437579316206014f, 0.597458180731658f},
    {0.17086251598591184f, 0.714155531552537f, 0.43045144225205567f},
    {0.8264314307484594f, 0.14972735722244868f, 0.550027587376692f},
    {0.9604189484924404f, 0.21119032501807367f, 0.6245578698034127f},
    {0.8051579166088791f, 0.1473065531341109f, 0.8452721463252504f},
    {0.05657544462875186f, 0.8184963505859287f, 0.6731094124462869f},
    {0.33023040632469813f, 0.28174987231760873f, 0.4595170863979474f},
    {0.07051111476606842f, 0.6609660368280572f, 0.7750259554668913f},
    {0.9142388865617818f, 0.0064204424037449526f, 0.6193085065286971f},
    {0.00020579824362021437f, 0.6669202885623886f, 0.27411608425682055f},
    {0.23580790491639403f, 0.38015754708759375f, 0.9207058940990583f},
    {0.3599732893566221f, 0.27322572306033477f, 0.3065569542958142f},
    {0.8420870562047464f, 0.3561978991411081f, 0.668221288122075f},
    {0.3289556955379985f, 0.2433673976443741f, 0.634751204294021f},
    {0.2932673078848649f, 0.23453110760539364f, 0.4018896676861059f},
    {0.03136395566659722f, 0.09650428667638933f, 0.31081595444860055f},
    {0.23346099760410643f, 0.23211640610526496f, 0.4525646473683499f},
    {0.4189557590701122f, 0.34442076151412215f, 0.2679747732599801f},
    {0.8821441778968673f, 0.5006254540785914f, 0.9253147963158534f},
    {0.3865303889454069f, 0.7535858134767194f, 0.3895590928190966f},
    {0.7277129126650014f, 0.7686856492327042f, 0.9363636212497517f},
    {0.10085881113435358f, 0.304747109849128f, 0.31603225188754336f},
    {0.2968386940112082f, 0.6786254379191512f, 0.6841841835352283f},
    {0.810260773236176f, 0.8160554040513587f, 0.22972705637271984f},
    {0.13566551874936594f, 0.6497784826566974f, 0.21464317736841243f},
    {0.6577809697415549f, 0.03974150014989586f, 0.20264351152752702f},
    {0.8563550414677515f, 0.21583008502899803f, 0.0981886245614958f},
    {0.48257836033000023f, 0.014734787314531483f, 0.9515053106670306f},
    {0.7769390786691357f, 0.17423535505656862f, 0.13981023721033203f},
    {0.07926818782243006f, 0.7905734814715855f, 0.08576397492480237f},
    {0.8738030018027428f, 0.43396802208226604f, 0.000697253653865415f},
    {0.04788518879154191f, 0.6221646068989505f, 0.29351793567603923f},
    {0.2503220115351451f, 0.5150881095895743f, 0.5592861714493892f},
    {0.9096764684841204f, 0.37723377911879996f, 0.29647781908356186f},
    {0.17801167794110828f, 0.8613575935751129f, 0.3650226216947684f},
    {0.9122585434857412f, 0.33518197506085434f, 0.5534398647556279f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 13: random", "[votess]") {

  const int k = 127;
  std::vector<std::array<float, 3>> xyzset = {
    {0.5802816475105852f, 0.4302477384551534f, 0.22450285381887913f},
    {0.6302606097969623f, 0.13591610109329022f, 0.9157430772234131f},
    {0.19922107678376277f, 0.32337895876580314f, 0.22773852898782931f},
    {0.6135021444944089f, 0.39311211276021973f, 0.3531112636267826f},
    {0.7094431814049444f, 0.5631207415662285f, 0.3378924678860986f},
    {0.8206099730878775f, 0.2098299910285063f, 0.2475477026585583f},
    {0.5091058762699793f, 0.720285260103792f, 0.6947948239136441f},
    {0.4913114687243737f, 0.756915980510009f, 0.35759522627555407f},
    {0.7394807485522356f, 0.9305462289724601f, 0.15477302096780987f},
    {0.9916645165155661f, 0.8406564756074919f, 0.15775780175070597f},
    {0.8369165388858085f, 0.9391527901791076f, 0.5021205548192278f},
    {0.37430279060207794f, 0.44632311376380496f, 0.4296792516574025f},
    {0.29508466702992664f, 0.47527188596270264f, 0.8422020289731207f},
    {0.7740527627894067f, 0.7406187667926865f, 0.38268022197325835f},
    {0.7362983338189727f, 0.21492709812744193f, 0.4473470047466651f},
    {0.0809329235822499f, 0.22279510690908444f, 0.5219692947562641f},
    {0.30963388587277085f, 0.6498036247720549f, 0.9568904510205998f},
    {0.032290873882180215f, 0.2776236368274503f, 0.5290590310578797f},
    {0.003761180333121783f, 0.4469742135068303f, 0.39243179873512757f},
    {0.17347738715331684f, 0.36007143726380275f, 0.10193152807774775f},
    {0.8101542328976137f, 0.5301066460527539f, 0.8568550130679976f},
    {0.4934737747176322f, 0.9354647916510969f, 0.8317066962893364f},
    {0.5298444156958009f, 0.5985643317568439f, 0.9485350132729187f},
    {0.773731585258885f, 0.5638561541507559f, 0.5316056038797057f},
    {0.029370897142240837f, 0.636025564930601f, 0.49686062305728207f},
    {0.3834640905317248f, 0.23367162343505388f, 0.038901799610849275f},
    {0.7301409534605925f, 0.3552174427111108f, 0.5362016880626708f},
    {0.1730707311575339f, 0.22244511811070877f, 0.8654835391839268f},
    {0.8017468628038142f, 0.7315265743168651f, 0.8470954301904389f},
    {0.16717598245063947f, 0.5310635898213747f, 0.41377460609004013f},
    {0.5936820691103099f, 0.7118058501189264f, 0.7732348034890778f},
    {0.274351847476616f, 0.11785953234961788f, 0.1239011727335475f},
    {0.9479193185472452f, 0.6719846367866882f, 0.5918907668868101f},
    {0.16598756409515214f, 0.8321770838238286f, 0.7241941073220179f},
    {0.18767765392961988f, 0.8737469160252985f, 0.5535637950081518f},
    {0.5389078377051015f, 0.6421297560731514f, 0.5181484621074194f},
    {0.14497461376579834f, 0.33069278395195245f, 0.7187336081122735f},
    {0.4737819661234909f, 0.4052938618937296f, 0.04282382429131415f},
    {0.01333707877019652f, 0.010270890966796453f, 0.9166458431097553f},
    {0.5037895457638829f, 0.7401065908191663f, 0.10654273696155081f},
    {0.7509688285768384f, 0.2912031246415644f, 0.7303155644298169f},
    {0.3469434844325744f, 0.8698361536183887f, 0.3691004535562449f},
    {0.8157973778203702f, 0.6122257105020921f, 0.26931309676325277f},
    {0.7622560879945103f, 0.696857474812767f, 0.48298793948435637f},
    {0.9381829752547777f, 0.5383175385579717f, 0.6901924731986675f},
    {0.3419530218731094f, 0.8425868457011778f, 0.7390294137517902f},
    {0.41744280908684184f, 0.1447552661042607f, 0.6574243550703562f},
    {0.7247651410238745f, 0.2455843822122108f, 0.055231299835718506f},
    {0.9603563789328646f, 0.5588614262036755f, 0.13243021076083017f},
    {0.8143775306480394f, 0.11297846839383963f, 0.5903837494151147f},
    {0.6984451508626087f, 0.8033406310237126f, 0.899958177202289f},
    {0.601990146043814f, 0.47890886526333687f, 0.1922959454333979f},
    {0.9808541487185707f, 0.22776975400352018f, 0.12654868552499432f},
    {0.7358031453639768f, 0.6097299377423946f, 0.7546777493644515f},
    {0.4574408470614292f, 0.3511788327976746f, 0.5785159468430401f},
    {0.35046621364705155f, 0.5825488520940957f, 0.17015054358832793f},
    {0.7680300106604904f, 0.7213784445080864f, 0.07169912409468304f},
    {0.36876888166553956f, 0.05609450110014791f, 0.19707149809185198f},
    {0.32850265440799453f, 0.3944175469532969f, 0.09251408290441276f},
    {0.3614346327910558f, 0.3072336391665329f, 0.4764133760405639f},
    {0.6039706296898085f, 0.9365214817794278f, 0.4887653898947003f},
    {0.47461273663988557f, 0.22789090133600942f, 0.03389186660155563f},
    {0.02435582887099652f, 0.21930717766805896f, 0.11183947252059101f},
    {0.4796360539508123f, 0.8249138307531231f, 0.7542914807142089f},
    {0.9186600585659268f, 0.5422175199740051f, 0.05190016186771229f},
    {0.7086535895558742f, 0.10966516660201531f, 0.07157201851392392f},
    {0.5792947273321902f, 0.5560629752142184f, 0.20383357699670746f},
    {0.21028725921275693f, 0.9076085913063687f, 0.7128877527195377f},
    {0.9755384492166904f, 0.531073846197972f, 0.3219832784804699f},
    {0.0013272112409413728f, 0.966670919426368f, 0.16947205435729074f},
    {0.8013792865523536f, 0.9147933728649317f, 0.052331100001598685f},
    {0.33176582821727374f, 0.8631113293781434f, 0.8707460429889535f},
    {0.11394257111351846f, 0.6522315831948635f, 0.39510116050286603f},
    {0.90295326388216f, 0.7543795633379866f, 0.2675142785628455f},
    {0.9768796539220863f, 0.723566233532603f, 0.5073643802718725f},
    {0.01308612874474202f, 0.409509858080203f, 0.3362233042259154f},
    {0.3783438486723205f, 0.6982723621153346f, 0.6958621364054953f},
    {0.5245199637054505f, 0.7351218738941715f, 0.8090282086558471f},
    {0.4406827785112477f, 0.34070527700931263f, 0.8345953288858288f},
    {0.15664343455821061f, 0.5925812244127296f, 0.3402830400370721f},
    {0.7370363499775847f, 0.6879636674965559f, 0.8379998632597946f},
    {0.5237962755775426f, 0.6285818042563975f, 0.6730558839991649f},
    {0.25560999746165747f, 0.6467936684674301f, 0.5716338171971282f},
    {0.014107759620169968f, 0.65943224843769f, 0.5254225920124055f},
    {0.38865909128763076f, 0.9172712651111992f, 0.9772927341684613f},
    {0.07615773179248209f, 0.262251535216228f, 0.5667440168315875f},
    {0.3573565143205587f, 0.07155068547208165f, 0.6859341288996645f},
    {0.9077238106995331f, 0.1799212483682433f, 0.51846688916691f},
    {0.16380510252052316f, 0.8919796964924951f, 0.5588438851370721f},
    {0.12800961201953964f, 0.5936987548074723f, 0.411724088285086f},
    {0.6847579598761353f, 0.018368285522204597f, 0.4150111929274518f},
    {0.20552193311053735f, 0.36651745969422544f, 0.32725638995828543f},
    {0.997957045181669f, 0.07536030272734295f, 0.3887991377214829f},
    {0.6400276092680656f, 0.870848649156931f, 0.5265097260797896f},
    {0.26441426405437407f, 0.47761915392388254f, 0.7149838992046237f},
    {0.3115438586485476f, 0.5385469101427675f, 0.7804305094533079f},
    {0.1462952838637146f, 0.8006977820685353f, 0.6827509107954022f},
    {0.7633675495063157f, 0.33754260902389976f, 0.6705681418387746f},
    {0.8348328769907967f, 0.04645593615121557f, 0.24999897203648858f},
    {0.13751556983253688f, 0.45375233077589705f, 0.18517846482192468f},
    {0.24366891454077777f, 0.8784108092846282f, 0.6380673943326439f},
    {0.039289173271354505f, 0.8216232566190053f, 0.32807782721420664f},
    {0.9784457153417288f, 0.6416767317561638f, 0.8488385787689319f},
    {0.30488024370178335f, 0.653723595774887f, 0.5869551968492324f},
    {0.29778314831681707f, 0.6844777620338017f, 0.24141682555782895f},
    {0.3662523821380995f, 0.5491973596913868f, 0.19114033635621397f},
    {0.8157964002528957f, 0.25669719260283685f, 0.20325171229205774f},
    {0.2541241169151922f, 0.9013161591867151f, 0.9263814565919324f},
    {0.9689890122469395f, 0.5139981214073129f, 0.9434188931019234f},
    {0.599290122727509f, 0.04524918150611679f, 0.11572497653199809f},
    {0.37152117161014664f, 0.7790961019169906f, 0.11380070600157732f},
    {0.3124746912828019f, 0.2001684172242083f, 0.325518797524321f},
    {0.16224429207119484f, 0.9084026670922801f, 0.08283256360828228f},
    {0.4527856461928488f, 0.6075271374344071f, 0.8123889203484164f},
    {0.4118584200893671f, 0.017538325694413492f, 0.9365060967240394f},
    {0.8688840894798924f, 0.05687807184940641f, 0.31679181302203563f},
    {0.629571276606565f, 0.21852976547888792f, 0.0394382452779517f},
    {0.011041510978522906f, 0.808033602148203f, 0.3022901463203763f},
    {0.8065569141471879f, 0.16164954381098096f, 0.06929866257299055f},
    {0.06867816656502579f, 0.5431657166154462f, 0.10533809719469867f},
    {0.1386574217864731f, 0.5719012618702859f, 0.09445327897294487f},
    {0.2152326361410185f, 0.6761400751606567f, 0.7842920074577843f},
    {0.5330823553835223f, 0.9626225510532037f, 0.5219557117345971f},
    {0.7595828587679211f, 0.602956513638961f, 0.2894366581033637f},
    {0.8603407380010524f, 0.46653579457079963f, 0.021469767107192617f},
    {0.06377286371006574f, 0.5228625776884372f, 0.2559987382172271f},
    {0.940498871406324f, 0.4348347908443163f, 0.024259914296716922f},
    {0.7004694628915259f, 0.576133643877952f, 0.31158041966078476f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 14: random", "[votess]") {

  const int k = 127;
  std::vector<std::array<float, 3>> xyzset = {
    {0.17611350796088088f, 0.5826007110928249f, 0.2912896245754705f},
    {0.9192245285492585f, 0.2565839918698616f, 0.1950017351500294f},
    {0.15865344356447242f, 0.9708401763552619f, 0.9752972831332594f},
    {0.17019351858149112f, 0.6170367789842641f, 0.8595495921300055f},
    {0.07076257388940699f, 0.47332009362175087f, 0.6023301060555225f},
    {0.5592741077810263f, 0.017824289370594215f, 0.07181220125572507f},
    {0.19131690810066015f, 0.19845177140988557f, 0.7727334999709061f},
    {0.46757550202647913f, 0.000566824095106333f, 0.6200223007813997f},
    {0.17908305722483742f, 0.7564960090775392f, 0.7298786910319653f},
    {0.42588791313634367f, 0.6926902929870306f, 0.47532005070946015f},
    {0.5932781859360207f, 0.10374703252505146f, 0.6698941613723937f},
    {0.7528052866831914f, 0.18212322181681595f, 0.8955885120651076f},
    {0.8766970301759619f, 0.039957269250686545f, 0.14850349949309816f},
    {0.30893144921375737f, 0.06815907369366192f, 0.34084796058255185f},
    {0.5626044746232554f, 0.6941180650806861f, 0.2608454904375982f},
    {0.007246973488056363f, 0.06492798795925503f, 0.5696567639760582f},
    {0.6141155336645665f, 0.9326489679520876f, 0.39289769465158475f},
    {0.3132808790809857f, 0.9468892388592198f, 0.020866581523863337f},
    {0.9835694836312364f, 0.046924720936751374f, 0.6377073322749953f},
    {0.6868033817476326f, 0.7722198116966343f, 0.09916216916867893f},
    {0.2655492977130678f, 0.5480986790129139f, 0.06405044044819241f},
    {0.8876021769568708f, 0.6899707117488565f, 0.7206662267560743f},
    {0.7128498560831792f, 0.24279778053950285f, 0.39193663523296773f},
    {0.7413507040028975f, 0.9344079598052605f, 0.7730582453119696f},
    {0.17726822329892367f, 0.03617796704887166f, 0.9581710910411959f},
    {0.8649073783954269f, 0.2837075348895939f, 0.9554255215748939f},
    {0.3135856134136148f, 0.9840455536714023f, 0.9083602931807142f},
    {0.47985561472467375f, 0.46539441779989077f, 0.7332055461584162f},
    {0.3458597229617203f, 0.9411672756078768f, 0.23345394053550494f},
    {0.613379658147193f, 0.04596713343046599f, 0.7682419146942008f},
    {0.9683964992550242f, 0.915008834781194f, 0.8831058910672893f},
    {0.17632532937745815f, 0.03642924998336172f, 0.9368570869057742f},
    {0.23486093836518218f, 0.881486223429978f, 0.6630351999007402f},
    {0.6459742320345716f, 0.839819979833992f, 0.09212505531283599f},
    {0.16290771034619156f, 0.16181110846572955f, 0.7681672917712724f},
    {0.7960796161795726f, 0.5275200779552722f, 0.6825168115813361f},
    {0.32185173336134376f, 0.615050885418504f, 0.4701400584698533f},
    {0.19782351833476886f, 0.951942992320103f, 0.05567154148573472f},
    {0.10487503397263842f, 0.478687491392935f, 0.12466063739537736f},
    {0.7627447940261418f, 0.0785239319736164f, 0.5948558178860389f},
    {0.1254002009774764f, 0.5951222044099052f, 0.48017255848385054f},
    {0.13448535060888223f, 0.7944515424368033f, 0.1588489838237902f},
    {0.05671861168560055f, 0.4130323120571566f, 0.7764489823078594f},
    {0.8002572600649747f, 0.15989689873724466f, 0.9459747860606733f},
    {0.185325353267088f, 0.728642357028407f, 0.575155821776016f},
    {0.19382636018069255f, 0.40248735378633027f, 0.781792115843902f},
    {0.9973641852909035f, 0.7346554529904091f, 0.9561936282899619f},
    {0.7912339897474769f, 0.5761215073617604f, 0.25863134874458815f},
    {0.8840064040327739f, 0.7791525727327215f, 0.6802143686811446f},
    {0.5251503238023562f, 0.4079948458744318f, 0.5889478217965585f},
    {0.8597232980310401f, 0.1088027431587466f, 0.36488260067052847f},
    {0.842455382771356f, 0.5462913186564533f, 0.003264891221370747f},
    {0.8549133351644119f, 0.48349742343800794f, 0.06860939696593105f},
    {0.5233408887623904f, 0.2967392541971662f, 0.6834965697840839f},
    {0.8510034203834032f, 0.09177807101736102f, 0.7705288604897571f},
    {0.6837612841497009f, 0.4736722783890849f, 0.9869643922140132f},
    {0.1371332451833288f, 0.5348326873742058f, 0.2176816424867709f},
    {0.1044986608705295f, 0.09087645383908227f, 0.8543167725701797f},
    {0.162058058692644f, 0.49099742500549715f, 0.6920273610177672f},
    {0.7645321015804941f, 0.8715896266804993f, 0.5432965080352302f},
    {0.26523391765384297f, 0.8390769007341142f, 0.17935757282743225f},
    {0.6418963771738172f, 0.5064856923139422f, 0.49536611395275587f},
    {0.12032322868834122f, 0.23537430856608565f, 0.7248613944531099f},
    {0.28927113650971203f, 0.47340853921169024f, 0.6360476734003199f},
    {0.5784381376043503f, 0.1332607449605725f, 0.4151039006470111f},
    {0.30751575294571876f, 0.7054903589623489f, 0.9629625957255928f},
    {0.014179871822883383f, 0.540341808358403f, 0.09124727284418277f},
    {0.8584466616189121f, 0.5180143005112173f, 0.13481510655474838f},
    {0.8759410008013185f, 0.20914674351632245f, 0.5044106393553918f},
    {0.49641365871122367f, 0.05112363577340917f, 0.5749448139907769f},
    {0.9046836059387544f, 0.08000813891262393f, 0.41580468549357297f},
    {0.28801791403098065f, 0.36580103167992684f, 0.3714702840465469f},
    {0.8290701898308714f, 0.3918297895789735f, 0.7481602532152536f},
    {0.5735931596435817f, 0.07233998484997317f, 0.14658464554439843f},
    {0.31568012572141235f, 0.5647755062755704f, 0.156938332870997f},
    {0.36642196070961186f, 0.906152812770253f, 0.8703672149640818f},
    {0.7154844707302049f, 0.40299432086431786f, 0.5440819754992943f},
    {0.6542284101267621f, 0.1358646529861054f, 0.8711644697260937f},
    {0.1293368242509525f, 0.7275969561983571f, 0.6503467407752843f},
    {0.4999453902277049f, 0.0037660299815048814f, 0.39742533073869424f},
    {0.2658411024312102f, 0.5503352862694304f, 0.9692293461050425f},
    {0.27025084303178903f, 0.73882672619456f, 0.7459717386174916f},
    {0.4367757510693623f, 0.4359460791543348f, 0.901170762730433f},
    {0.27092867979538793f, 0.190645279823201f, 0.09268382568077904f},
    {0.1667818331924794f, 0.1643515041805711f, 0.37080965997443704f},
    {0.9217674342005074f, 0.08419957913587306f, 0.9433853714591924f},
    {0.48534191306410224f, 0.16610477431510395f, 0.18436052506656653f},
    {0.8199932220210631f, 0.8350526829126117f, 0.9879351976444307f},
    {0.8746229401855726f, 0.879241295361186f, 0.29695251844964454f},
    {0.9216217645089217f, 0.15733173508294407f, 0.5924579928831422f},
    {0.33400886583531864f, 0.16108555617585507f, 0.9036794730556827f},
    {0.38823113749925486f, 0.0994094587672274f, 0.41108577414547964f},
    {0.058443320864603465f, 0.8536402036615185f, 0.008281228511645922f},
    {0.08193183249630509f, 0.8330335905773117f, 0.6830817377228386f},
    {0.904532576174519f, 0.20018760974028904f, 0.885351160816532f},
    {0.5909955038414195f, 0.5533787518918498f, 0.053876349705013205f},
    {0.3516343374772595f, 0.5571651096749021f, 0.8934923842188469f},
    {0.34616939663349244f, 0.09099137170891758f, 0.5476053236251595f},
    {0.6305647385705672f, 0.7830513203074257f, 0.6584493053946725f},
    {0.6112773558743234f, 0.27902999073788826f, 0.8866389168433148f},
    {0.271253826336886f, 0.589470281441059f, 0.9390958906571465f},
    {0.25804823683768563f, 0.5572733004621239f, 0.42759102874456156f},
    {0.8683444369613917f, 0.45705788593206753f, 0.5866680826601255f},
    {0.4276257171731682f, 0.021693894317087126f, 0.8840458552886921f},
    {0.626585098302407f, 0.7785078130584845f, 0.23078900350118725f},
    {0.4674513810824049f, 0.3714282723107306f, 0.8502567396864203f},
    {0.493141723416867f, 0.6468139335522564f, 0.44199352565209304f},
    {0.5013926524454438f, 0.37140907773445986f, 0.5109633616109458f},
    {0.10758863543221597f, 0.4149790361340344f, 0.5122985846700664f},
    {0.8212550732288492f, 0.5390267773537283f, 0.3775351832229368f},
    {0.43853007231384455f, 0.11808879973954145f, 0.6656258847793478f},
    {0.08513178354005901f, 0.7328310774199728f, 0.1607486846010776f},
    {0.6621381573668365f, 0.6058605677525895f, 0.31921489654845137f},
    {0.581408712647841f, 0.5428529638009598f, 0.9604268943129453f},
    {0.8855481111411074f, 0.45930960817455857f, 0.01856223305022553f},
    {0.5340454719260432f, 0.1945854701487132f, 0.10292381467777512f},
    {0.6610478864310027f, 0.32765160697815565f, 0.14354793635683727f},
    {0.602873542887778f, 0.6311999743303105f, 0.5043709145190343f},
    {0.9897389135210422f, 0.33278891205389294f, 0.5915205216048856f},
    {0.21501019105389785f, 0.3509568791540396f, 0.9891589624046018f},
    {0.6588328214955704f, 0.14844429472777576f, 0.25616125405155543f},
    {0.4721149297915602f, 0.5313510693937123f, 0.6377079342590964f},
    {0.35591041579903016f, 0.1391849318655004f, 0.2209038501270829f},
    {0.9960428088742738f, 0.713478260172187f, 0.19035684377132256f},
    {0.9943095436131193f, 0.8306402671563099f, 0.5116854439542612f},
    {0.11800356085010621f, 0.5445079046871131f, 0.12743812252772235f},
    {0.7878067534977912f, 0.2071010257769773f, 0.09586388197764495f},
    {0.7823810354292343f, 0.48156124104581277f, 0.3467573556592781f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 15: random", "[votess]") {

  const int k = 127;
  std::vector<std::array<float, 3>> xyzset = {
    {0.35853372590257493f, 0.9444006641241596f, 0.5943596867154277f},
    {0.12519571053764167f, 0.08164310529105334f, 0.8327755595425959f},
    {0.7319467000911489f, 0.793640631793954f, 0.7891373957465728f},
    {0.4015984963414363f, 0.9817653573805342f, 0.8311900119904299f},
    {0.21914623733724314f, 0.11913245457424582f, 0.2521554062717233f},
    {0.9218416964936728f, 0.38142561234715977f, 0.5553241070205084f},
    {0.07446205265711259f, 0.8573800918121106f, 0.7862836340772409f},
    {0.6501929350410043f, 0.531431034357727f, 0.7095762535958688f},
    {0.20727720560163598f, 0.8605001171321673f, 0.22285585755764614f},
    {0.04970384396283156f, 0.7457693876821162f, 0.08001244771748495f},
    {0.24993901697415855f, 0.7589582230191871f, 0.11787877238722921f},
    {0.864627877700969f, 0.6127480335478656f, 0.1198014443068095f},
    {0.3259142554638166f, 0.6267001398401805f, 0.23409279903810332f},
    {0.6644066706531393f, 0.9561065681492846f, 0.9272099152655998f},
    {0.2015469452575912f, 0.837175825753138f, 0.9222662345747784f},
    {0.8068235172233547f, 0.7686770167698874f, 0.34084847708374844f},
    {0.7139611083151963f, 0.6028330839381993f, 0.19137849005404517f},
    {0.7609113571392405f, 0.4334224707849831f, 0.8481848210064731f},
    {0.8280308413156713f, 0.4157290211574133f, 0.47418329949328086f},
    {0.6161974718533865f, 0.9485733151475312f, 0.8450868183525876f},
    {0.5852017567236603f, 0.6070234793393658f, 0.006314761414118353f},
    {0.7537661271392447f, 0.6904070123660642f, 0.9021877429364371f},
    {0.5340388328939643f, 0.7223746362885365f, 0.4850830475651722f},
    {0.35217930495739735f, 0.7865981175665061f, 0.7933941400155545f},
    {0.8594469453637508f, 0.24991291754871203f, 0.42083510943913816f},
    {0.0975306707990653f, 0.6768844485825543f, 0.1605878664282796f},
    {0.31901584811446604f, 0.4230499784284474f, 0.14620230762450026f},
    {0.35722692311378035f, 0.7882650628952288f, 0.2587203258684432f},
    {0.3525210458207595f, 0.21370742168992074f, 0.8253697412678966f},
    {0.5815903164594816f, 0.4035490714487233f, 0.8491329644115095f},
    {0.9788680376477046f, 0.678259487713527f, 0.8316728502508508f},
    {0.29582545404435f, 0.07547760640744727f, 0.4792426742127054f},
    {0.9399040426002695f, 0.804771460372298f, 0.8332456612853886f},
    {0.36286448760466783f, 0.5218117654484283f, 0.706241798808374f},
    {0.419194245711893f, 0.5995752679214617f, 0.21149189811907387f},
    {0.49462983500050595f, 0.7920779748922393f, 0.2205924045413582f},
    {0.9266154240222264f, 0.3926536867959104f, 0.9923850264879139f},
    {0.17407006578680984f, 0.23664683926057073f, 0.619946407658583f},
    {0.25736434057073776f, 0.05411862603986062f, 0.1090696970823023f},
    {0.46679604508646766f, 0.8650793067644519f, 0.75776331937656f},
    {0.15848452894105547f, 0.09014103712221067f, 0.5866244350462707f},
    {0.11224650808471004f, 0.16816278405387497f, 0.899356824776461f},
    {0.05434953158996991f, 0.449046566338948f, 0.4938894987856355f},
    {0.7625159208512703f, 0.7629685925644505f, 0.37993237785079703f},
    {0.9977448087743968f, 0.19097216952066598f, 0.6404089209599406f},
    {0.6723468393125309f, 0.7397773397889644f, 0.33177126689779124f},
    {0.0838111246131309f, 0.34272815188235783f, 0.6010270414984373f},
    {0.6348707799649437f, 0.11095679790494162f, 0.25559700532903173f},
    {0.7624267747914144f, 0.926856909634059f, 0.5923091315853626f},
    {0.12314003435221899f, 0.7872044095808577f, 0.9800566583794234f},
    {0.7785483449125628f, 0.7756356866577518f, 0.5663721665861478f},
    {0.9781575203362054f, 0.4715846082310583f, 0.8968350388385611f},
    {0.19556168491444337f, 0.5551880436054349f, 0.021183868293834673f},
    {0.18191976089667328f, 0.6375248782064872f, 0.8412654855695164f},
    {0.6697981986497974f, 0.19048556116747695f, 0.2615091301771397f},
    {0.6552206744738666f, 0.7775394852055697f, 0.06927520537442f},
    {0.6021389457983327f, 0.23405437861770517f, 0.44852176887297435f},
    {0.4994067497694561f, 0.08772778279419002f, 0.8586730068697543f},
    {0.5349131846718537f, 0.6668952709976819f, 0.4328684134249561f},
    {0.3591247641180908f, 0.24412279051883157f, 0.9998480931084459f},
    {0.2578662097148724f, 0.1466962831347941f, 0.23880922902772728f},
    {0.5112409554183309f, 0.6017396302898804f, 0.6546260653719426f},
    {0.2576433800162252f, 0.7754373095021146f, 0.8044612739268884f},
    {0.6224058760694118f, 0.36160560347302384f, 0.7566885478971158f},
    {0.9829533239289114f, 0.123689768516144f, 0.19129533213697048f},
    {0.5799861829359699f, 0.24615728033541573f, 0.15602565165040239f},
    {0.5406805140594881f, 0.40325527036676667f, 0.04388666823081744f},
    {0.6422251830791987f, 0.6519259056275012f, 0.9984160487537741f},
    {0.21185853457696147f, 0.38168184619368295f, 0.5303766956880199f},
    {0.36475311188552306f, 0.28737773090147967f, 0.3365138927328557f},
    {0.1303550095628866f, 0.09303360915635572f, 0.09997049486921983f},
    {0.35527217793309085f, 0.871681803955518f, 0.4290651863592849f},
    {0.8675431618544366f, 0.16660994019615194f, 0.16228790600012954f},
    {0.9039066035314551f, 0.9199468877177166f, 0.8860762977869897f},
    {0.7654980215722516f, 0.659257535555781f, 0.13622198373436045f},
    {0.6163088288585694f, 0.11870904177188213f, 0.3807870467198521f},
    {0.9179813035439371f, 0.06964260274487344f, 0.27021970979055776f},
    {0.22737910475504763f, 0.543621553762507f, 0.7201404741131233f},
    {0.40803143823208776f, 0.9865078918275016f, 0.20053275557364758f},
    {0.0689214033759944f, 0.4257591272122161f, 0.9199622296886909f},
    {0.7129060519005959f, 0.792454713951533f, 0.16281373430038482f},
    {0.5463246330430755f, 0.31748078619240405f, 0.6921605642332185f},
    {0.9311776544783793f, 0.049652966913086516f, 0.46583257789669563f},
    {0.679807023405725f, 0.740048840171427f, 0.32705840014701193f},
    {0.13819120147614183f, 0.7045849985858094f, 0.3336002007101061f},
    {0.0033662064118250568f, 0.0111757027672571f, 0.24128841146855828f},
    {0.7941510324741595f, 0.7258166127182869f, 0.8938157646612007f},
    {0.9958621431006878f, 0.34625115146183827f, 0.0943999631708885f},
    {0.8859761703469803f, 0.9019114775334997f, 0.3383579126808568f},
    {0.27081488451171287f, 0.030191423263915773f, 0.3265281955547459f},
    {0.17434000667857108f, 0.7092351355819243f, 0.7040786878940299f},
    {0.741259105688415f, 0.180368119567211f, 0.548429863490275f},
    {0.14167115617018455f, 0.5442330566856088f, 0.42849337524752606f},
    {0.822342632099909f, 0.6861843631648271f, 0.3324703137345898f},
    {0.038029282437256784f, 0.261714841888136f, 0.30068742899403667f},
    {0.6763682932517078f, 0.060968535270691904f, 0.3903466159624027f},
    {0.3199848507936912f, 0.8751577622115716f, 0.9946790501034903f},
    {0.5308763571568741f, 0.5938984585929166f, 0.000792130172428851f},
    {0.6672022502170347f, 0.364071725762116f, 0.2489420085112476f},
    {0.4640169562958021f, 0.14424072551396594f, 0.6113880218584109f},
    {0.873423430687164f, 0.3418836924410704f, 0.9336369268544664f},
    {0.4749422513002143f, 0.4297939308428764f, 0.7911094133833324f},
    {0.023466413680379605f, 0.31668019223529065f, 0.3053541434337126f},
    {0.8386106329589857f, 0.4597684925701875f, 0.09933130047863015f},
    {0.3128415812438047f, 0.42825202855496547f, 0.5905486396661933f},
    {0.46257311382697885f, 0.6770045622456006f, 0.001148167915136722f},
    {0.41496029224425934f, 0.3420484229757935f, 0.638923600974479f},
    {0.2705322465032389f, 0.3218371525209809f, 0.3507674030151672f},
    {0.3932791763187531f, 0.9447780613450578f, 0.13032013410914267f},
    {0.8143133621444376f, 0.5974182120354061f, 0.44823336739190955f},
    {0.5208217889833796f, 0.9938265900360349f, 0.43640848107784214f},
    {0.8367249604750592f, 0.5717298895463905f, 0.5347294006054241f},
    {0.8717170320816717f, 0.7488748475334432f, 0.22800753898007697f},
    {0.2716694335907296f, 0.8608382127339258f, 0.23196388603452933f},
    {0.6960986421923555f, 0.7181381278118459f, 0.9709306144852973f},
    {0.16543274356195636f, 0.39031083711745207f, 0.7012442054855901f},
    {0.7222892389132903f, 0.8237121573741341f, 0.766069457973168f},
    {0.047318503421434066f, 0.13229036877698896f, 0.4648140642746603f},
    {0.2502048558131087f, 0.049070659885068646f, 0.9257871527105002f},
    {0.25969437898245784f, 0.11365338376024114f, 0.6854701571877939f},
    {0.2908852325740029f, 0.29681791383746214f, 0.5732119306068754f},
    {0.6288925871507208f, 0.7812621551681678f, 0.6080948610709179f},
    {0.7292929440276812f, 0.5502309053913832f, 0.2632329178041406f},
    {0.03046730408015441f, 0.4790573366419575f, 0.6690847587922202f},
    {0.14669949679113392f, 0.08608524112752669f, 0.7764209895522025f},
    {0.4039704502465855f, 0.19676862859002864f, 0.20881062289221386f},
    {0.4541954525378602f, 0.42077488293686305f, 0.8043952291084181f},
    {0.3440688142545997f, 0.18175873649074226f, 0.6707635336646125f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 16: random", "[votess]") {

  const int k = 127;
  std::vector<std::array<float, 3>> xyzset = {
    {0.672380963773445f, 0.21331312298152927f, 0.3635877563303477f},
    {0.9363336267895005f, 0.11932159707061396f, 0.31708841595485937f},
    {0.9390315306698085f, 0.5297336189772448f, 0.02780900465859626f},
    {0.44977335295478227f, 0.9062135655560238f, 0.7128180998296689f},
    {0.5083507029649675f, 0.07803374690847531f, 0.5393345529683433f},
    {0.5164280034686157f, 0.73308365536479f, 0.24980849697399066f},
    {0.3946250393391071f, 0.03594864948252319f, 0.1677969208827237f},
    {0.3468661113508925f, 0.010514906755986653f, 0.7296065183666628f},
    {0.8404844417198932f, 0.07472890928693232f, 0.027887080976410017f},
    {0.6362135556874831f, 0.6675934032458362f, 0.12751027564157458f},
    {0.7355895441356584f, 0.7767376883340602f, 0.3098536282924208f},
    {0.13686958563421991f, 0.12731899865465013f, 0.1567800530374851f},
    {0.8910356504446086f, 0.89231131907613f, 0.1378299998925817f},
    {0.5920497051948581f, 0.7730703383659616f, 0.7965959179228594f},
    {0.7888498948622507f, 0.25829427919032566f, 0.5593777446273076f},
    {0.18707902407189714f, 0.8082499595398551f, 0.800030713826721f},
    {0.1374505474332267f, 0.25420221284872224f, 0.5056806847606549f},
    {0.01150983178966447f, 0.49181959461090774f, 0.8343790549772614f},
    {0.6738286048313059f, 0.6860257599362113f, 0.3252304780785392f},
    {0.04027592749920861f, 0.1352004010018102f, 0.7490752314050939f},
    {0.7130911526513707f, 0.03148140612726891f, 0.7781275152453343f},
    {0.6454426963095203f, 0.30566609621666596f, 0.06655521722582247f},
    {0.791206495323378f, 0.8283546253005735f, 0.8682296177293748f},
    {0.37014753134308f, 0.536370098086456f, 0.8807279501923477f},
    {0.29036905237052557f, 0.3905999882436606f, 0.03355169302831906f},
    {0.3943264129763616f, 0.22910550342114377f, 0.7475251430780154f},
    {0.3664355809062103f, 0.36649105700857565f, 0.49252696499586346f},
    {0.9225328391263241f, 0.576563681630266f, 0.4181189831144465f},
    {0.20018573914305038f, 0.1573307193507275f, 0.668956963913314f},
    {0.8546985006305365f, 0.9361385381961549f, 0.6504840953884675f},
    {0.36490188635457255f, 0.18127461894988695f, 0.04129758750892021f},
    {0.008377624289059526f, 0.5614212265786002f, 0.7458662921984142f},
    {0.21181425546107902f, 0.0935113260293482f, 0.2172591951157825f},
    {0.33106633483383907f, 0.5264532300744919f, 0.44747021239672347f},
    {0.679986648816254f, 0.9831827053334422f, 0.17508485504300197f},
    {0.5109535472020791f, 0.6198150161344892f, 0.3575695836421202f},
    {0.006345886129012768f, 0.6143408156300363f, 0.28502972135233906f},
    {0.812112327577773f, 0.7939380896353463f, 0.01667853339419534f},
    {0.582714320674311f, 0.12108182777670728f, 0.13210863536123463f},
    {0.49030440524292274f, 0.8533470256843466f, 0.16536048587135999f},
    {0.06911984257878057f, 0.777947756639074f, 0.46190081881419254f},
    {0.20610438499674422f, 0.14137454795626758f, 0.994981460028623f},
    {0.9178957264891066f, 0.29310537778484114f, 0.5909421170516093f},
    {0.830290075629803f, 0.6395386144395716f, 0.18865672812258238f},
    {0.20610292475303837f, 0.22170376828928795f, 0.5932668792180501f},
    {0.6187642672919234f, 0.41990145655358513f, 0.1250493284962425f},
    {0.7029869028719496f, 0.486422441047321f, 0.9678230133367323f},
    {0.05691354873997334f, 0.4092890792463788f, 0.7440154228003104f},
    {0.03262910420548415f, 0.052617682461907234f, 0.6315536842030793f},
    {0.9727724137315198f, 0.8590099595190827f, 0.7477983534560879f},
    {0.845323349758596f, 0.19590691383792413f, 0.2506545951235061f},
    {0.23022228301920278f, 0.2943675657190834f, 0.8153291227750368f},
    {0.13714992039801166f, 0.2714762859104376f, 0.35885962601249943f},
    {0.31368716399378294f, 0.37165483228984075f, 0.02754931730385768f},
    {0.025489853662033712f, 0.9766389113103484f, 0.12880556482770733f},
    {0.46151439939430694f, 0.9684398316027313f, 0.3363382735133227f},
    {0.8028857415971331f, 0.34899965573548275f, 0.9880886328894004f},
    {0.9837806688602888f, 0.6527610155390278f, 0.8518174082434649f},
    {0.5594605972911084f, 0.8772775587118393f, 0.05473900563076739f},
    {0.18710540489050465f, 0.7098925508152769f, 0.9521482811240967f},
    {0.9912928142655846f, 0.800682756662414f, 0.6772376840057227f},
    {0.8839091048239531f, 0.594144111687014f, 0.44340684553875653f},
    {0.8575459836360088f, 0.8505726119085196f, 0.7653576345496027f},
    {0.03868633887353268f, 0.4022241223738413f, 0.39513210207105687f},
    {0.9485497027370254f, 0.7862847193876494f, 0.6274710190084543f},
    {0.39400532942108235f, 0.10449148876610326f, 0.017050661071919104f},
    {0.9794813332217605f, 0.047567206373600346f, 0.21622227123549442f},
    {0.06573075113111748f, 0.859232527853608f, 0.21178269052647924f},
    {0.9001093138125673f, 0.1480990376664162f, 0.5712805655258252f},
    {0.6984493242235174f, 0.003405264513939743f, 0.7833684626138799f},
    {0.563515395320612f, 0.9945700967058891f, 0.6384605736290486f},
    {0.2586875577480895f, 0.07919976080732816f, 0.8260292989216295f},
    {0.25124659172754715f, 0.22157041849960057f, 0.5871660601590227f},
    {0.1168219035162239f, 0.4384794499379664f, 0.6475516146508543f},
    {0.5916388143776383f, 0.4435220762467298f, 0.49227943397135887f},
    {0.2856042238817996f, 0.07502027154436375f, 0.02788214911057829f},
    {0.09727221969907096f, 0.9439633691757651f, 0.26077621657910666f},
    {0.12357604089705343f, 0.4496434671778561f, 0.3873802171042383f},
    {0.40386602652710657f, 0.9558139079722737f, 0.19160482005915813f},
    {0.3744777648075449f, 0.46822502704914015f, 0.2865199613602101f},
    {0.2932479133394901f, 0.057393356407115514f, 0.5904901948698188f},
    {0.6550330348655856f, 0.39948019360279374f, 0.7748019046359136f},
    {0.3213642221418269f, 0.036937802087190885f, 0.09044244332635254f},
    {0.7498339789548125f, 0.16370664173187f, 0.5873113234172126f},
    {0.43004160956285553f, 0.37037817701852915f, 0.06797625716067246f},
    {0.4837732403242603f, 0.944893155649932f, 0.364431306469192f},
    {0.6017963965462283f, 0.749474872888347f, 0.46620092737525143f},
    {0.26072341016448675f, 0.8131633404390582f, 0.12558806641300047f},
    {0.12434049455212604f, 0.3740772448554536f, 0.21226839070158576f},
    {0.8954702657920417f, 0.49474913711419555f, 0.3426457659258021f},
    {0.16082899779665927f, 0.6591055177718427f, 0.16764332503998525f},
    {0.5968314253244469f, 0.17047468801098864f, 0.6875704281456761f},
    {0.7637291201637374f, 0.6465561816756461f, 0.9483682603693014f},
    {0.7829857463709057f, 0.9367901219873919f, 0.23709294064367692f},
    {0.0627298804156341f, 0.946645400915207f, 0.35752391726821986f},
    {0.8792966973781497f, 0.21894657680405372f, 0.7776090762244494f},
    {0.3590002258284406f, 0.9597016380355974f, 0.2325339390124216f},
    {0.11360292857598109f, 0.6895256634001948f, 0.8491614610059528f},
    {0.7833798119037044f, 0.08018701876943768f, 0.49681056038742766f},
    {0.472584076134719f, 0.784179742671567f, 0.4071849472249943f},
    {0.3342647811743643f, 0.18207405434671087f, 0.6941495008626443f},
    {0.17701889876674504f, 0.5097071594803517f, 0.08196361109717532f},
    {0.2891339018418262f, 0.3807220101022005f, 0.17305365719950372f},
    {0.9021869246518243f, 0.5601285053211232f, 0.06431148275564058f},
    {0.3002677682878623f, 0.028890237200940527f, 0.4879460607092291f},
    {0.5453577504436113f, 0.8826555906601855f, 0.3746260241086483f},
    {0.9843123888851675f, 0.6721076482048657f, 0.11566225202129243f},
    {0.37384554175826756f, 0.713577441312458f, 0.38805496928418115f},
    {0.6525589627522593f, 0.8481934675338693f, 0.7225297512575735f},
    {0.28023828320965594f, 0.9267378383225602f, 0.2746758713379408f},
    {0.6603715203834764f, 0.7948587772616031f, 0.8021478177687821f},
    {0.0921821315361594f, 0.7052098368742041f, 0.58558269253041f},
    {0.6842314016529994f, 0.9380789327741565f, 0.3857249743722341f},
    {0.8825609645381053f, 0.19031708706569972f, 0.673532239519813f},
    {0.7318723941572683f, 0.5006022778454365f, 0.966345927532571f},
    {0.9716497303426357f, 0.13260941309249852f, 0.10966737508630175f},
    {0.46869432154319324f, 0.7206517982579297f, 0.5066846061015846f},
    {0.8045124280182666f, 0.41589019372169844f, 0.9024354861611612f},
    {0.0420199473693742f, 0.8205124500691398f, 0.08248496505686598f},
    {0.7668476332475346f, 0.899937066921742f, 0.235071972470282f},
    {0.871226046762793f, 0.14964934930330454f, 0.2188930644435637f},
    {0.15633522716991144f, 0.14837973732413545f, 0.9554069950197062f},
    {0.16259042126989676f, 0.006740427687223716f, 0.9389919786638068f},
    {0.5301726768265766f, 0.660817212220472f, 0.011180527644853444f},
    {0.8871510978947156f, 0.13517791130704626f, 0.9149855185001904f},
    {0.03695232876476384f, 0.5891397475522584f, 0.4880224565956015f},
    {0.9610532348034063f, 0.6989005774719584f, 0.6413232046044901f},
    {0.10785699104016866f, 0.9756020759117858f, 0.45202408027762064f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 17: clustered", "[votess]") {

  const int k = 99;
  std::vector<std::array<float, 3>> xyzset = {
    {0.6174646066883209f, 0.5138631618457307f, 0.5304455069653741f},
    {0.46232599824133025f, 0.468137095436315f, 0.6267652837449899f},
    {0.32709663734750494f, 0.617577343721018f, 0.6706565645973703f},
    {0.47527610950402177f, 0.5677559960806892f, 0.5830230634551048f},
    {0.52604728663702f, 0.3148808336645304f, 0.4505658738916699f},
    {0.5635650754079575f, 0.36774733758839107f, 0.5174077229949997f},
    {0.6045299710223446f, 0.3936224797855491f, 0.44650280596840625f},
    {0.5250283922475775f, 0.6058489352953578f, 0.6004419666430464f},
    {0.2658811083316106f, 0.589117521297989f, 0.4698401645471254f},
    {0.49807693933135533f, 0.5352791204284435f, 0.6311749496067811f},
    {0.6273390864520104f, 0.4530534509455514f, 0.47651520922559926f},
    {0.3907491795588809f, 0.5915945397938844f, 0.4095116607672689f},
    {0.430811914078782f, 0.5366989361425109f, 0.5960090093883722f},
    {0.7012116492486731f, 0.3774924707785878f, 0.6373636285081798f},
    {0.23381021741806524f, 0.3455091724996242f, 0.5741196115452528f},
    {0.6047480683958362f, 0.5084523874766839f, 0.5582019036220129f},
    {0.4225421362187459f, 0.4322678282800879f, 0.5238914458649593f},
    {0.7851958884825616f, 0.40535216987169964f, 0.4079407941854978f},
    {0.48457322319621743f, 0.47983134137413447f, 0.6357887780548516f},
    {0.4587196598370018f, 0.4308863798113081f, 0.6217568080850652f},
    {0.33744295446774375f, 0.5656827610148008f, 0.42982512363413006f},
    {0.43249625198379044f, 0.584206534581524f, 0.5445820026691309f},
    {0.5531103061045568f, 0.4354946029070059f, 0.5467319417329903f},
    {0.5257040022602629f, 0.5214506544588066f, 0.38372754948872245f},
    {0.4830563959302843f, 0.5192002416420016f, 0.39816407916301555f},
    {0.5115564265483805f, 0.5883295463610821f, 0.33458106484937533f},
    {0.433644388222466f, 0.5510572636482424f, 0.329532373764474f},
    {0.39649043939603745f, 0.5744411009673663f, 0.4875815305560149f},
    {0.46495945465913685f, 0.4696124643133052f, 0.611787493199147f},
    {0.5135683578653887f, 0.551104378735633f, 0.5820092680474906f},
    {0.4771940761876445f, 0.7221013343662287f, 0.5136771310626828f},
    {0.5614782812942186f, 0.6864958307685505f, 0.5684164029306122f},
    {0.451046868969881f, 0.5233246163429421f, 0.4933710082247787f},
    {0.542547399703586f, 0.614052242593556f, 0.4255226903677055f},
    {0.5537223166006537f, 0.5038402966481045f, 0.5583915508308963f},
    {0.5268353736773451f, 0.473895732996406f, 0.6227230921125847f},
    {0.34805036312404547f, 0.37094978598078354f, 0.4746881081848766f},
    {0.3182902759676917f, 0.5044678351765637f, 0.3315179867706812f},
    {0.5784867595763845f, 0.5360224505926706f, 0.6839858772576126f},
    {0.356934476274286f, 0.4549404203891735f, 0.41671907080013776f},
    {0.481451492005849f, 0.3961523249540882f, 0.4759222739244133f},
    {0.45878707281920905f, 0.5540711630545366f, 0.43371862216952123f},
    {0.5814959190676564f, 0.5300508031076585f, 0.5091377740425416f},
    {0.49260765441001525f, 0.6469842527081533f, 0.4369866836599094f},
    {0.3528720152461686f, 0.36157116257798805f, 0.4809986069677006f},
    {0.4891933825425383f, 0.40859794629189256f, 0.5609503253119693f},
    {0.5124428514093978f, 0.5206241204997634f, 0.4090736577376535f},
    {0.3998289552503624f, 0.37355611617607715f, 0.47031900158306816f},
    {0.43953281871906147f, 0.41757178064321043f, 0.5274786036900346f},
    {0.494824284592209f, 0.46954816620502915f, 0.4949997610873953f},
    {0.4911366229567934f, 0.485459530800474f, 0.5268030184070925f},
    {0.5249152097105786f, 0.4516206678627479f, 0.48388430940478183f},
    {0.46913511364162813f, 0.46674674990983117f, 0.3816251442974451f},
    {0.48431746260178876f, 0.539955504303103f, 0.5393594908401547f},
    {0.36282610373881974f, 0.5876351930785314f, 0.6130531209348631f},
    {0.5395111382580133f, 0.5138813501280205f, 0.5754702177095203f},
    {0.4210434762503025f, 0.43707371662835826f, 0.4663777742246205f},
    {0.5673035670208382f, 0.40893274999377155f, 0.3840795619278994f},
    {0.45746622399925846f, 0.32837706242045994f, 0.5231077405041296f},
    {0.5197140542904445f, 0.4819747917893782f, 0.44715509213094706f},
    {0.3542073096568137f, 0.6228021302561701f, 0.45296439577079695f},
    {0.516848214948242f, 0.5299756572602586f, 0.5344676835310838f},
    {0.4439997337419501f, 0.39069834843086426f, 0.47059164418494154f},
    {0.6363969922914899f, 0.5353921216733846f, 0.43775915821359224f},
    {0.5514733781940996f, 0.46044221598369917f, 0.45025790460971027f},
    {0.6241592087648042f, 0.4519562101599495f, 0.506961378769843f},
    {0.5639737538053442f, 0.5954640526246036f, 0.6010589450093767f},
    {0.6001304981637612f, 0.5254876672599075f, 0.6229958074242914f},
    {0.6254460692171024f, 0.5292908411775585f, 0.21367028388514142f},
    {0.5607408585536455f, 0.4836575977308359f, 0.3635040502133734f},
    {0.4655366765551069f, 0.5082722796527925f, 0.4410023792040959f},
    {0.6434448525260315f, 0.4365023592341071f, 0.34714643944639245f},
    {0.3012667997219323f, 0.517436833554621f, 0.5199660066493875f},
    {0.43260291458666394f, 0.5396255273896122f, 0.4204775285413016f},
    {0.4894995586778173f, 0.34535270350311864f, 0.45128687442305054f},
    {0.48620332518259735f, 0.6095014121017753f, 0.6133414640399577f},
    {0.6708192672843003f, 0.34379380676095034f, 0.4582011160579187f},
    {0.38815845221584605f, 0.48271291352228746f, 0.5251288429365306f},
    {0.4961351229783972f, 0.5261476126896847f, 0.5587735709602242f},
    {0.39842098681523547f, 0.525052810041972f, 0.42902385020119393f},
    {0.35653254523708083f, 0.38418941072263035f, 0.49074097415827966f},
    {0.5910603452124892f, 0.5321416810217947f, 0.4736350853468494f},
    {0.5202175154579679f, 0.4662036447242794f, 0.6060817358056444f},
    {0.5027452465083f, 0.3726268164873633f, 0.4170999040631842f},
    {0.47371220236146333f, 0.4180566455577814f, 0.43664816153531494f},
    {0.5500867836138497f, 0.500958808517444f, 0.5958720611206236f},
    {0.4443922803308696f, 0.4013268668380019f, 0.522484655627873f},
    {0.39882123568796446f, 0.43656726046963f, 0.3773715964889117f},
    {0.530199185057008f, 0.37539125572599924f, 0.39471121570882256f},
    {0.6073792025750736f, 0.4899754359686987f, 0.551380552442832f},
    {0.5096311436866052f, 0.5622780019233432f, 0.6469609347342895f},
    {0.5346365440844473f, 0.3822583261393172f, 0.4635574581476991f},
    {0.40295901234327697f, 0.5696973880350846f, 0.7005169226820054f},
    {0.3814897640504616f, 0.5405328695729847f, 0.5204273619918249f},
    {0.5650065789607558f, 0.44267667470089006f, 0.48821364164108155f},
    {0.48066967811313455f, 0.534837366127964f, 0.29293463693799965f},
    {0.5515411484632646f, 0.504939938030318f, 0.4495417078179338f},
    {0.5326430422002867f, 0.5128867196610049f, 0.4481098586975344f},
    {0.6133594391494012f, 0.4650780922224592f, 0.43107014867832416f},
    {0.5767931797101148f, 0.5934844106282473f, 0.6263665534678544f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 18: lattice", "[votess]") {

  const int k = 26;
  std::vector<std::array<float, 3>> xyzset = {
    {0.1f, 0.1f, 0.1f},
    {0.1f, 0.1f, 0.5f},
    {0.1f, 0.1f, 0.9f},
    {0.1f, 0.5f, 0.1f},
    {0.1f, 0.5f, 0.5f},
    {0.1f, 0.5f, 0.9f},
    {0.1f, 0.9f, 0.1f},
    {0.1f, 0.9f, 0.5f},
    {0.1f, 0.9f, 0.9f},
    {0.5f, 0.1f, 0.1f},
    {0.5f, 0.1f, 0.5f},
    {0.5f, 0.1f, 0.9f},
    {0.5f, 0.5f, 0.1f},
    {0.5f, 0.5f, 0.5f},
    {0.5f, 0.5f, 0.9f},
    {0.5f, 0.9f, 0.1f},
    {0.5f, 0.9f, 0.5f},
    {0.5f, 0.9f, 0.9f},
    {0.9f, 0.1f, 0.1f},
    {0.9f, 0.1f, 0.5f},
    {0.9f, 0.1f, 0.9f},
    {0.9f, 0.5f, 0.1f},
    {0.9f, 0.5f, 0.5f},
    {0.9f, 0.5f, 0.9f},
    {0.9f, 0.9f, 0.1f},
    {0.9f, 0.9f, 0.5f},
    {0.9f, 0.9f, 0.9f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 19: fibonacci_sphere(8)", "[votess]") {

  const int k = 7;
  std::vector<std::array<float, 3>> xyzset = {
    {0.4316481022186976f, 0.7707070026624881f, 0.999999f},
    {0.9053413416285837f, 0.33968357608471256f, 0.864734028131938f},
    {0.044980109438807536f, 0.38637570025332874f, 0.7294680562638759f},
    {0.805274685488643f, 0.9853709133015262f, 0.5942020843958139f},
    {0.6309764453554457f, 1e-06f, 0.45893611252775207f},
    {0.12229405637631838f, 0.8234593704415192f, 0.3236701406596901f},
    {0.9464668866512381f, 0.5721811378961699f, 0.18840416879162808f},
    {0.35365905282086707f, 0.3298067343985586f, 0.053138196923566104f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 20: fibonacci_sphere(24)", "[votess]") {

  const int k = 23;
  std::vector<std::array<float, 3>> xyzset = {
    {0.45498046791524616f, 0.6447641872894843f, 0.999999f},
    {0.7309512777138526f, 0.3981623722477224f, 0.9572270639761924f},
    {0.2070222013310226f, 0.420462440057527f, 0.9144541279523849f},
    {0.6962147257456773f, 0.8177649585642214f, 0.8716811919285774f},
    {0.5860394722436747f, 0.11508715774145804f, 0.8289082559047698f},
    {0.16035630551673716f, 0.763494440387062f, 0.7861353198809624f},
    {0.9616323246687711f, 0.5573756576284326f, 0.7433623838571547f},
    {0.19401863880339862f, 0.15069069560540121f, 0.7005894478333471f},
    {0.497966410284014f, 0.9989644489249168f, 0.6578165118095396f},
    {0.8547925821569399f, 0.145028624239098f, 0.6150435757857321f},
    {1e-06f, 0.5421407388153343f, 0.5722706397619245f},
    {0.9085587257411171f, 0.8284796030858338f, 0.529497703738117f},
    {0.42923944202448083f, 0.0013831792480104334f, 0.48672476771430945f},
    {0.22596245342800667f, 0.9320535662375118f, 0.44395183169050195f},
    {0.9955020803957892f, 0.38783196378128376f, 0.4011788956666944f},
    {0.07718014399383617f, 0.27287053225615854f, 0.35840595964288685f},
    {0.6620652343039318f, 0.9583353668696944f, 0.3156330236190793f},
    {0.69084912361899f, 0.09012173142079363f, 0.27286008759527186f},
    {0.11363168433935791f, 0.682868084649132f, 0.23008715157146412f},
    {0.8878617952426923f, 0.6359010963154224f, 0.18731421554765668f},
    {0.3329625946298537f, 0.19094991313621124f, 0.14454127952384924f},
    {0.4344637337558595f, 0.8129275139475807f, 0.10176834350004149f},
    {0.7142998355198091f, 0.3694292318164736f, 0.058995407476234045f},
    {0.3631291215826654f, 0.4862687487431819f, 0.016222471452426543f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 21: fibonacci_sphere(64)", "[votess]") {

  const int k = 63;
  std::vector<std::array<float, 3>> xyzset = {
    {0.466121007585302f, 0.5815291511301941f, 0.9968600266459421f},
    {0.6358236284988967f, 0.4306402583801314f, 0.981036851619816f},
    {0.31004869291067966f, 0.44359109866843593f, 0.96521367659369f},
    {0.6179724709398651f, 0.6952193819542799f, 0.9493905015675639f},
    {0.5487870998468379f, 0.24445855977151504f, 0.9335673265414378f},
    {0.2696648266628299f, 0.6664298931490087f, 0.9177441515153117f},
    {0.8025443922245971f, 0.5314649028441476f, 0.9019209764891857f},
    {0.2834171107688617f, 0.25375685478075144f, 0.8860978014630596f},
    {0.4913285182343308f, 0.8420329370631965f, 0.8702746264369335f},
    {0.7470690385257251f, 0.2380280403940191f, 0.8544514514108075f},
    {0.12423898112359665f, 0.5234905394259821f, 0.8386282763846814f},
    {0.8020251364688313f, 0.7413139778022148f, 0.8228051013585553f},
    {0.4366851289261117f, 0.1017373073574847f, 0.8069819263324293f},
    {0.2695257983882215f, 0.8423697799696751f, 0.7911587513063032f},
    {0.9099990872767483f, 0.396862187189984f, 0.7753355762801771f},
    {0.11763276111013551f, 0.290556840074096f, 0.7595124012540511f},
    {0.6417582361939398f, 0.9175800529878743f, 0.743689226227925f},
    {0.6792402309614624f, 0.08484980773137832f, 0.7278660512017989f},
    {0.07869671984646326f, 0.6843744241247862f, 0.7120428761756729f},
    {0.9402005429578368f, 0.647090214025087f, 0.6962197011495468f},
    {0.2700058997234361f, 0.08479680710917081f, 0.6803965261234207f},
    {0.3860970925230969f, 0.963359602567379f, 0.6645733510972947f},
    {0.8996362154774288f, 0.2285795940878894f, 0.6487501760711686f},
    {0.015725335339952018f, 0.4257074522831086f, 0.6329270010450425f},
    {0.8078061835380119f, 0.881293864085196f, 0.6171038260189166f},
    {0.5291462661200368f, 0.003596632393373771f, 0.6012806509927905f},
    {0.1393510496374482f, 0.8446529694098389f, 0.5854574759666644f},
    {0.9995765323858908f, 0.4856263969123239f, 0.5696343009405384f},
    {0.11874737637423145f, 0.1680425978468616f, 0.5538111259144123f},
    {0.5553908312382815f, 0.999999f, 0.5379879508882862f},
    {0.795817221103537f, 0.08930982751825621f, 0.5221647758621601f},
    {0.002304373942076932f, 0.5993189298060014f, 0.5063416008360341f},
    {0.9324071033020008f, 0.7591657203014243f, 0.49051842580990807f},
    {0.3546938604714358f, 0.013498681949294926f, 0.4746952507837819f},
    {0.27728432283088883f, 0.952204814176386f, 0.4588720757576559f},
    {0.9666302007610145f, 0.31375913422095164f, 0.4430489007315298f},
    {0.030312153560093848f, 0.319049313321283f, 0.42722572570540374f},
    {0.7213169957553299f, 0.9446692210862463f, 0.41140255067927767f},
    {0.6346801743102641f, 0.02173361444938413f, 0.3955793756531516f},
    {0.07898267721030106f, 0.7560387770430551f, 0.37975620062702553f},
    {0.977717749442889f, 0.591034781212807f, 0.36393302560089946f},
    {0.2103353363446693f, 0.11011683751596717f, 0.34810985057477345f},
    {0.4490972517216175f, 0.9741867649126764f, 0.3322866755486473f},
    {0.8518426362040047f, 0.18479085290962335f, 0.31646350052252126f},
    {0.032375385383010685f, 0.4910720310989847f, 0.30064032549639524f},
    {0.8320014421314672f, 0.8138368354491401f, 0.2848171504702691f},
    {0.4660710748451961f, 0.04821470887380615f, 0.268993975444143f},
    {0.2233889320753758f, 0.8456794033132112f, 0.25317080041801715f},
    {0.9267785188126647f, 0.4296160518460407f, 0.23734762539189092f},
    {0.14438458193247222f, 0.26528422534457746f, 0.22152445036576496f},
    {0.5993734890923117f, 0.8990571684129471f, 0.2057012753396389f},
    {0.6890711710086805f, 0.1451121922161752f, 0.18987810031351277f},
    {0.13116541478748575f, 0.626020505373411f, 0.17405492528738664f},
    {0.8427845915074482f, 0.6469792746149199f, 0.15823175026126063f},
    {0.35099429293689866f, 0.1699589176184838f, 0.14240857523513464f},
    {0.3904095074315973f, 0.8246890679747872f, 0.12658540020900852f},
    {0.7827922722709039f, 0.33957911322543344f, 0.1107622251828825f},
    {0.2007357181079949f, 0.42803849411179956f, 0.09493905015675644f},
    {0.6579813542933908f, 0.7331656941296032f, 0.07911587513063031f},
    {0.5357526134402553f, 0.2422184622510162f, 0.06329270010450432f},
    {0.32004681239182015f, 0.6440180911485702f, 0.04746952507837819f},
    {0.6943110620999176f, 0.5096301548760601f, 0.03164635005225213f},
    {0.39155171674093503f, 0.38865986216135995f, 0.015823175026126065f},
    {0.5011419374966639f, 0.5875478231217802f, 1e-06f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 22: fibonacci_sphere(128)", "[votess]") {

  const int k = 127;
  std::vector<std::array<float, 3>> xyzset = {
    {0.47561963165782944f, 0.5566745978211572f, 0.9963261774423666f},
    {0.5951941327957972f, 0.45050951648089155f, 0.9884834237465653f},
    {0.36492936058337355f, 0.4594830424820098f, 0.9806406700507639f},
    {0.5833084185693205f, 0.6382325318397801f, 0.9727979163549627f},
    {0.5342705603379664f, 0.31695410000045643f, 0.9649551626591614f},
    {0.3342315661663171f, 0.6188077051328434f, 0.95711240896336f},
    {0.7174232936855227f, 0.5221126912541878f, 0.9492696552675587f},
    {0.34267578180727853f, 0.32120641981858306f, 0.9414269015717573f},
    {0.49314641444321994f, 0.748213043801219f, 0.933584147875956f},
    {0.6800323363829199f, 0.30799319801191444f, 0.9257413941801548f},
    {0.22345206503841733f, 0.5167193416952371f, 0.9178986404843534f},
    {0.7224686998801305f, 0.6776430312355386f, 0.9100558867885521f},
    {0.45247989878742306f, 0.20385794259012888f, 0.9022131330927508f},
    {0.3274728026480414f, 0.7550045334705235f, 0.8943703793969494f},
    {0.807207833060834f, 0.42208122773334683f, 0.8865276257011481f},
    {0.2108534883563413f, 0.34139114350372657f, 0.8786848720053468f},
    {0.6071535121300421f, 0.8166101787510367f, 0.8708421183095455f},
    {0.6364618541809183f, 0.1823096669550977f, 0.8629993646137442f},
    {0.17557359939354206f, 0.6412860967857573f, 0.8551566109179428f},
    {0.8402171810621116f, 0.613366059644739f, 0.8473138572221415f},
    {0.3203291483612275f, 0.17601900712339016f, 0.8394711035263401f},
    {0.4101734917321863f, 0.8631009356176452f, 0.8316283498305389f},
    {0.8153737330133655f, 0.2850558266408673f, 0.8237855961347376f},
    {0.11399653913937154f, 0.4404118271978635f, 0.8159428424389362f},
    {0.746529408148548f, 0.8054899018410696f, 0.8081000887431349f},
    {0.5231526420986538f, 0.098121991574558f, 0.8002573350473335f},
    {0.20550375178264396f, 0.7806355731718201f, 0.7924145813515322f},
    {0.9104812063187941f, 0.4877809340320702f, 0.784571827655731f},
    {0.1832514800020604f, 0.2241565490464877f, 0.7767290739599296f},
    {0.5460158595337401f, 0.9183749203914774f, 0.7688863202641283f},
    {0.7497760774975379f, 0.15236735468345056f, 0.761043566568327f},
    {0.07458192384413642f, 0.5844781997758572f, 0.7532008128725256f},
    {0.8728426507645556f, 0.7233317028247226f, 0.7453580591767243f},
    {0.37290860099890377f, 0.0752326058975809f, 0.737515305480923f},
    {0.3031704543922031f, 0.8987261131618994f, 0.7296725517851217f},
    {0.9163870543973646f, 0.33341088438089694f, 0.7218297980893204f},
    {0.07508335398035182f, 0.3361322279858297f, 0.713987044393519f},
    {0.7024667786551175f, 0.907048383228856f, 0.7061442906977177f},
    {0.624829631694812f, 0.055663586499476565f, 0.6983015370019163f},
    {0.10318043221427699f, 0.7409858329344744f, 0.6904587833061151f},
    {0.9567078842210198f, 0.586879633698729f, 0.6826160296103138f},
    {0.2183313412313591f, 0.12093567518159376f, 0.6747732759145124f},
    {0.44955013863602944f, 0.9685558252666168f, 0.6669305222187111f},
    {0.8539495355539386f, 0.1826970334393852f, 0.6590877685229097f},
    {0.02030052656145182f, 0.49076457389324385f, 0.6512450148271084f},
    {0.8474555719566521f, 0.8284429482569884f, 0.6434022611313072f},
    {0.4636991348249867f, 0.016746247632161163f, 0.6355595074355058f},
    {0.19719902980940493f, 0.8784765564744649f, 0.6277167537397045f},
    {0.9791395008131385f, 0.42106652376142967f, 0.6198740000439031f},
    {0.09000625409631184f, 0.22943450884401193f, 0.6120312463481018f},
    {0.6181886765401369f, 0.9740837720177952f, 0.6041884926523005f},
    {0.7320697693110797f, 0.0650836361276912f, 0.5963457389564992f},
    {0.03188981116541574f, 0.660349667674788f, 0.5885029852606979f},
    {0.9529478099518316f, 0.6944344981960677f, 0.5806602315648965f},
    {0.2950477580102335f, 0.045461736852582035f, 0.5728174778690952f},
    {0.3419459065227408f, 0.9705886027911458f, 0.5649747241732939f},
    {0.9334916794822683f, 0.2552101677671565f, 0.5571319704774925f},
    {0.012370548919559965f, 0.3834078429021664f, 0.5492892167816913f},
    {0.779427897489948f, 0.9118966334813619f, 0.54144646308589f},
    {0.5704861635468982f, 0.002846662842371051f, 0.5336037093900886f},
    {0.11002976207260175f, 0.8152086772212765f, 0.5257609556942873f},
    {0.9990465882013716f, 0.5269424995123813f, 0.5179182019984859f},
    {0.1482537362720472f, 0.13878206940878512f, 0.5100754483026846f},
    {0.5135780940420747f, 0.999999f, 0.5022326946068834f},
    {0.8259399076538982f, 0.11806913778643457f, 0.49438994091108207f},
    {1e-06f, 0.5573657110675811f, 0.4865471872152807f},
    {0.9054421950671754f, 0.7912276955460054f, 0.47870443351947933f},
    {0.3960429504546641f, 0.007671241970916422f, 0.47086167982367805f},
    {0.2425491055337305f, 0.928753094813431f, 0.46301892612787676f},
    {0.9770732430488941f, 0.35385937532305123f, 0.4551761724320753f},
    {0.048376749931375626f, 0.2817469531275763f, 0.4473334187362741f},
    {0.6834713746140265f, 0.9611243142299062f, 0.4394906650404727f},
    {0.6740566721588249f, 0.032898010906563684f, 0.4316479113446714f},
    {0.05533414373840665f, 0.7222756920366349f, 0.4238051576488701f},
    {0.975040074424876f, 0.6320585962582753f, 0.41596240395306877f},
    {0.23785316801980735f, 0.07882710960461711f, 0.40811965025726743f},
    {0.40728437625810515f, 0.9820915713087255f, 0.40027689656146614f},
    {0.8909186825546607f, 0.20405043607745005f, 0.3924341428656648f},
    {0.011794226049221828f, 0.450260481562809f, 0.3845913891698635f},
    {0.8233340225583087f, 0.8609719596596656f, 0.3767486354740621f},
    {0.5036013449522718f, 0.013371904745229635f, 0.36890588177826084f},
    {0.16831573314999218f, 0.8507397986061999f, 0.3610631280824595f},
    {0.9774099160290424f, 0.46152630953304064f, 0.35322037438665826f},
    {0.1221097698826318f, 0.2033135801071455f, 0.34537762069085687f},
    {0.5760208438264881f, 0.9674084803823648f, 0.3375348669950555f},
    {0.7563940971333103f, 0.10220422564754353f, 0.32969211329925424f},
    {0.04322315300783589f, 0.6153409087628776f, 0.3218493596034529f},
    {0.9102664286451563f, 0.7180037057640017f, 0.3140066059076515f},
    {0.3440042954854612f, 0.06103717045081819f, 0.3061638522118503f},
    {0.31802142005227424f, 0.9219142574740625f, 0.29832109851604893f},
    {0.9142169524858814f, 0.3091871683093362f, 0.2904783448202476f},
    {0.0673539960799822f, 0.35795550785031904f, 0.2826355911244462f},
    {0.7193996327678581f, 0.8895905421762041f, 0.274792837428645f},
    {0.598694552896263f, 0.06433531492418845f, 0.2669500837328436f},
    {0.1345759985303911f, 0.7481473746979004f, 0.25910733003704234f},
    {0.9309801610761245f, 0.559184670883908f, 0.25126457634124105f},
    {0.22327441909842802f, 0.164655754042241f, 0.24342182264543968f},
    {0.47598032159422826f, 0.9254097579212761f, 0.2355790689496383f},
    {0.7997713836401421f, 0.20191465407759582f, 0.22773631525383697f},
    {0.08093105315033797f, 0.5130508323519926f, 0.21989356155803572f},
    {0.8119715336746446f, 0.7659158299940789f, 0.21205080786223443f},
    {0.44847320477364094f, 0.09462899416596067f, 0.20420805416643295f},
    {0.2657339959611989f, 0.8249248165190043f, 0.1963653004706317f},
    {0.8845356798195393f, 0.41583923117064564f, 0.18852254677483035f},
    {0.16322661941419156f, 0.30141427611574684f, 0.1806797930790291f},
    {0.6104695279921848f, 0.8635879465436014f, 0.17283703938322778f},
    {0.6594215948525015f, 0.1593670446268814f, 0.1649942856874265f},
    {0.15715308592942012f, 0.6367347513722509f, 0.15715153199162507f},
    {0.8364147604047526f, 0.6241019178153243f, 0.1493087782958238f},
    {0.33750795848615245f, 0.18407621160427795f, 0.14146602460002242f},
    {0.4067721758692846f, 0.8308217680106202f, 0.13362327090422116f},
    {0.7832289119186867f, 0.3194740936623404f, 0.1257805172084198f},
    {0.17616794400146402f, 0.439323255260697f, 0.11793776351261852f},
    {0.6903683927415726f, 0.7519688895759409f, 0.11009500981681719f},
    {0.527120359573885f, 0.19131417714143523f, 0.10225225612101592f},
    {0.2773664570503916f, 0.6982780090846574f, 0.0944095024252145f},
    {0.785371240382763f, 0.5000422831176917f, 0.08656674872941317f},
    {0.29631037643122654f, 0.3110091985663644f, 0.07872399503361195f},
    {0.5197356126441267f, 0.7605793388794674f, 0.07088124133781053f},
    {0.6515870578443651f, 0.30086741077163476f, 0.06303848764200931f},
    {0.26589977110299345f, 0.5379779020135469f, 0.05519573394620788f},
    {0.6835590704959832f, 0.617725862436681f, 0.047352980250406615f},
    {0.4466495477070829f, 0.30140371057234555f, 0.03951022655460529f},
    {0.4121073985815029f, 0.6618729021191564f, 0.03166747285880397f},
    {0.652427723681444f, 0.44307920100115633f, 0.023824719163002644f},
    {0.37022446318044255f, 0.44453270541953765f, 0.015981965467201268f},
    {0.5435101373988096f, 0.5964355184337101f, 0.0081392117714f},
    {0.517412222685281f, 0.4386762566897962f, 0.00029645807559867737f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 23: noisy_data", "[votess]") {

  const int k = 26;
  std::vector<std::array<float, 3>> xyzset = {
    {0.014945332344511814f, 0.2050863474032498f, 0.012113208156413993f},
    {0.13515033083126987f, 0.23891830008764658f, 0.6020117216412689f},
    {0.25919024509827204f, 0.13443235842989157f, 0.999999f},
    {0.20528584055262158f, 0.6196095822517844f, 0.056730296978658126f},
    {0.13128672411464382f, 0.6084949759056101f, 0.4744492338116622f},
    {0.30302056721944737f, 0.4295753861379963f, 0.9057661635931923f},
    {0.09281837655523421f, 0.9105827282823764f, 0.04862912593758394f},
    {0.0524010319948692f, 0.8119440882115988f, 0.47373626028839944f},
    {0.06016821016091373f, 0.7991418462913134f, 0.8146588536070466f},
    {0.4912029061230599f, 0.3461843657320427f, 0.1555539542834691f},
    {0.7531976278106698f, 1e-06f, 0.3967662059933176f},
    {0.3842612256465584f, 0.2638291436436583f, 0.9318799011140941f},
    {0.5935557357016686f, 0.45885749434140466f, 0.10140086101850966f},
    {0.5792540426752818f, 0.36340039970351057f, 0.5142044677620611f},
    {0.4126665424634252f, 0.46338031755204667f, 0.9714014415784387f},
    {0.4579089689385428f, 0.8514198110621113f, 0.02638079044398832f},
    {0.620550691578302f, 0.7225742416256468f, 0.3200266024280195f},
    {0.42099097286500825f, 0.8964355777326112f, 0.8045692501525789f},
    {0.966112353914451f, 0.15114704134088763f, 0.13108077399317178f},
    {0.7381770494917809f, 0.16612901744973024f, 0.4905244169036317f},
    {0.999999f, 0.08283387600993226f, 0.8498933686034507f},
    {0.999999f, 0.3583019831942222f, 0.12366974376590241f},
    {0.974446025935561f, 0.7366249263605831f, 0.528987897289867f},
    {0.885921601378507f, 0.32928446855790044f, 0.7398930725742389f},
    {0.9029638497530542f, 0.999999f, 1e-06f},
    {0.9098839852404994f, 0.9204387310093126f, 0.5435963275519508f},
    {0.8766075083500136f, 0.999999f, 0.8103300345860904f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 24: imbalanced_classes", "[votess]") {

  const int k = 1009;
  std::vector<std::array<float, 3>> xyzset = {
    {0.9313450783228863f, 0.18429992396639838f, 0.16432453062524888f},
    {0.5767473944076789f, 0.8259210457242541f, 0.09388476897776354f},
    {0.159547293167297f, 0.9979587944951664f, 0.7380681509563728f},
    {0.48532475235160266f, 0.5344450951240989f, 0.4642781766141152f},
    {0.7753702843312192f, 0.479196470339872f, 0.9366648594023289f},
    {0.9064802142196198f, 0.5906782314586009f, 0.1895175140333789f},
    {0.5991486525748946f, 0.37642994916685757f, 0.24447602497811416f},
    {0.47179469608443914f, 0.6168611974186442f, 0.9721733658350432f},
    {0.4551152327202689f, 0.48799200420408706f, 0.6152537299916702f},
    {0.7393140336907675f, 0.4473411277674846f, 0.6430894785732085f},
    {0.8802743820412714f, 0.23926104143539284f, 0.4099003292337884f},
    {0.474760135531316f, 0.12910900784887447f, 0.027280480066015356f},
    {0.41030001504593827f, 0.3669864862240131f, 0.8367124305880177f},
    {0.9466289278538469f, 0.38594066499035307f, 0.12786094212464394f},
    {0.1339152739184808f, 0.6442315353853999f, 0.8071038691912533f},
    {0.5070763072229246f, 0.22467040713622188f, 0.08132390264820077f},
    {0.42041547792502443f, 0.6460460177476303f, 0.7352944224111019f},
    {0.6126565636032658f, 0.048896573097761076f, 0.8550557667432138f},
    {0.16059473995387696f, 0.7245128028886402f, 0.15922550370074706f},
    {0.4605933931415813f, 0.28813884196103023f, 0.7913848264900176f},
    {0.027246274474304277f, 0.14401434731840268f, 0.8722259123800876f},
    {0.9415171271833481f, 0.4576717407829388f, 0.5989047336429587f},
    {0.5402690986698605f, 0.4210852757208271f, 0.18811859507599116f},
    {0.46520647317597974f, 0.16777850552596152f, 0.8573682913702922f},
    {0.3418356920983615f, 0.8505363955812889f, 0.441126414857139f},
    {0.35705161948376063f, 0.7956735541426391f, 0.5389468967903627f},
    {0.01993564661533287f, 0.06439227723055851f, 0.9665219656471612f},
    {0.94893026291501f, 0.3686858994498562f, 0.4563516626740013f},
    {0.702930829784132f, 0.28128007960535784f, 0.47859998704579554f},
    {0.8440421128462616f, 0.3403315520467083f, 0.0013876195004285385f},
    {0.9718385959853321f, 0.7250341494796931f, 0.25020359298919437f},
    {0.2864974771266142f, 0.3214674574230859f, 0.4467248079155993f},
    {0.43640812893954706f, 0.4473266805914975f, 0.1437625198248309f},
    {0.14832710525963555f, 0.15904267759823287f, 0.9929082628492013f},
    {0.23900521418213427f, 0.3289376629047005f, 0.4872441630742881f},
    {0.639043373876768f, 0.9297161752940769f, 0.21173804080447722f},
    {0.9078713039216253f, 0.88631609141689f, 0.37458777812870137f},
    {0.731745257275175f, 0.6022893360734213f, 0.8765810863374007f},
    {0.09787376363819666f, 0.40268418953335805f, 0.29432798183863007f},
    {0.5180840367489571f, 0.6658039309972702f, 0.887955551218862f},
    {0.61100851153175f, 0.8713869781623076f, 0.2703599381066445f},
    {0.7467169538614893f, 0.733815066616785f, 0.7013743594284407f},
    {0.8772252518681816f, 0.44508252363493495f, 0.3619977090100135f},
    {0.3442492598651754f, 0.4556777542454913f, 0.20677680125466047f},
    {0.3203557531393212f, 0.917449284971561f, 0.7883335084485478f},
    {0.8711830196545793f, 0.3612921522173983f, 0.8214438991010833f},
    {0.6240779190351522f, 0.46328630803648474f, 0.011161263005277866f},
    {0.7782527933889742f, 0.36705150106064877f, 0.6942067100307737f},
    {0.41262666490151856f, 0.032491236077440755f, 0.0015428132253328952f},
    {0.2770761663838548f, 0.23787857278151503f, 0.29629427761790306f},
    {0.14677498777827724f, 0.14618571617918996f, 0.9479346933214614f},
    {0.15943385608050153f, 0.18412792812742018f, 0.6512888763437077f},
    {0.751903807779093f, 0.46053292673643664f, 0.7324016867836147f},
    {0.30960368484990197f, 0.8456305723677908f, 0.6518077245398556f},
    {0.4329519389081683f, 0.716437880511286f, 0.2407869654778627f},
    {0.9548776438410228f, 0.2832640636459063f, 0.3602396332400579f},
    {0.035561364326050726f, 0.8109807396998528f, 0.6175279205619124f},
    {0.23542190903936033f, 0.7810241315738408f, 0.45643590232195763f},
    {0.1516722658604327f, 0.6121418590901387f, 0.07871406726268171f},
    {0.021437323526814156f, 0.8833609722193111f, 0.5063919946489219f},
    {0.06933174795864616f, 0.43516223940681587f, 0.020507931120716028f},
    {0.9167604461873247f, 0.4393375868367648f, 0.5557125656192475f},
    {0.1019996997928796f, 0.5824097282407938f, 0.49548137028520234f},
    {0.45417933103581465f, 0.46575168789618326f, 0.1425101381614865f},
    {0.7640463464858683f, 0.6524950212905409f, 0.3976273639182145f},
    {0.4316759937576987f, 0.7735154603354364f, 0.6442749454297297f},
    {0.6482081972494196f, 0.9985281167642153f, 0.4831324642539572f},
    {0.17659487474967095f, 0.19061223725428866f, 0.8441147945386347f},
    {0.3087277039939207f, 0.47180800216672913f, 0.2787316202147899f},
    {0.7333199079325717f, 0.822281084019149f, 0.6964140297319144f},
    {0.266656470097428f, 0.6187649963153707f, 0.8242098735616065f},
    {0.8395777724252733f, 0.5863285369571101f, 0.36081434868393614f},
    {0.7819520305019221f, 0.03136940492272211f, 0.7467822174074484f},
    {0.5935480018021096f, 0.08738772701748476f, 0.41295645266854986f},
    {0.9870119922785255f, 0.885327513621392f, 0.4151863814484291f},
    {0.47066512761328294f, 0.4065134714796733f, 0.4143159499067285f},
    {0.06639824668866934f, 0.11518368663125778f, 0.3857062309845297f},
    {0.5013541207240705f, 0.6562821040008397f, 0.3875105732210521f},
    {0.04999484777734842f, 0.15377107370866494f, 0.04461135170219388f},
    {0.4077632798798102f, 0.04064663149254322f, 0.7203798020806822f},
    {0.7122574838297034f, 0.4282458179522526f, 0.16742916337846225f},
    {0.9294218770946916f, 0.6459622801352467f, 0.9040503598091271f},
    {0.09134647282644892f, 0.9259011822110378f, 0.6477648730379179f},
    {0.4726759631627757f, 0.19442058671423246f, 0.6468877927888824f},
    {0.23298048147183448f, 0.235751191317767f, 0.5038367736756215f},
    {0.603467425055361f, 0.45631605217390503f, 0.25995579748568987f},
    {0.3850608987518064f, 0.061855997826936515f, 0.08177169988222921f},
    {0.5055684871731024f, 0.3772787709309061f, 0.8183447520388758f},
    {0.8349615225445649f, 0.4839334095552187f, 0.1762685944006812f},
    {0.42249834436519185f, 0.8627509264680204f, 0.8518981482362938f},
    {0.06682498161967809f, 0.6175017952059111f, 0.8816362996580154f},
    {0.010442756986343116f, 0.4676022388989419f, 0.47823127842896473f},
    {0.8043197029597298f, 0.1486375653235794f, 0.753808523461045f},
    {0.5993341479971435f, 0.9185919655812165f, 0.4472222206986767f},
    {0.8436954748480802f, 0.5435725987611278f, 0.8429429389472227f},
    {0.37439888130137056f, 0.7555773875651022f, 0.431439478796079f},
    {0.2518882699817099f, 0.6722494133970471f, 0.782251761920604f},
    {0.7002680248922482f, 0.2169368396179122f, 0.34851164665687673f},
    {0.8157382402967849f, 0.46176722867979125f, 0.21453022683477818f},
    {0.9084138725063802f, 0.3992801678903205f, 0.9845519617429482f},
    {0.819611202989372f, 0.3938229842141856f, 0.8890659511315874f},
    {0.6102591978734855f, 0.02120135855479033f, 0.4664097629232059f},
    {0.3306088340128982f, 0.0036904802586144037f, 0.25495949239334426f},
    {0.81288499069203f, 0.6432053356785651f, 0.31942487863653324f},
    {0.5046102837156276f, 0.10458955384103186f, 0.9910179939124555f},
    {0.7745677240987519f, 0.9296559345280091f, 0.1040607606669599f},
    {0.3311018189648589f, 0.13455691367920763f, 0.5852426072710116f},
    {0.38663621200275644f, 0.6424327854075993f, 0.3106375684457502f},
    {0.11397216761100981f, 0.8086767399658391f, 0.8411616374780545f},
    {0.6665916262065086f, 0.5363686233707243f, 0.13274544076320738f},
    {0.07973290194459304f, 0.7492705651807218f, 0.5930800142319026f},
    {0.4713651158356824f, 0.12453780369543266f, 0.017307932251182656f},
    {0.6477982439545816f, 0.2249764369980367f, 0.006195271333289454f},
    {0.9346861499930009f, 0.4130472425747923f, 0.8064399468395566f},
    {0.8614256005052813f, 0.4212911503667647f, 0.6585767885255915f},
    {0.805394040994753f, 0.9830945432750429f, 0.8527190400848775f},
    {0.791398034777346f, 0.0753323087482245f, 0.7936227083880089f},
    {0.649439584427555f, 0.6618093653176246f, 0.4111521327083455f},
    {0.8714727415280762f, 0.5143722101810513f, 0.6945852766157559f},
    {0.047696057053453256f, 0.44495659308740965f, 0.15576645912528042f},
    {0.19110597603872725f, 0.5419113474781647f, 0.5187120997013736f},
    {0.8407567274641641f, 0.010934710064624986f, 0.7713299767034569f},
    {0.08146175719506832f, 0.4554791145996102f, 0.8158257593371695f},
    {0.919460917629986f, 0.35313502655212137f, 0.572931787625405f},
    {0.9134448735648966f, 0.29441353676125537f, 0.7705120774445877f},
    {0.1613908587494599f, 0.19925544872953904f, 0.9895612109783977f},
    {0.5684094271740596f, 0.8011864998888436f, 0.5625976317659008f},
    {0.6017041787109598f, 0.17117538343447325f, 0.08137635592070702f},
    {0.07060600646503268f, 0.8645186937925828f, 0.19676313412837865f},
    {0.038348024996933794f, 0.43729250144776655f, 0.7291153759550503f},
    {0.26634111920858483f, 0.7065304835755961f, 0.5825516669960885f},
    {0.3639594536435571f, 0.29632020415784177f, 0.789501573197874f},
    {0.21930698948377392f, 0.7508560331142085f, 0.777037116944491f},
    {0.6449836364660849f, 0.07118293888065974f, 0.6498857160650328f},
    {0.7506031955300264f, 0.013197910287813142f, 0.8030085875517279f},
    {0.4233366607533061f, 0.308125249755254f, 0.6827661948448176f},
    {0.9660767657632539f, 0.6710016282914684f, 0.6571339475756934f},
    {0.011302876227862635f, 0.8485345653308961f, 0.5562968682799242f},
    {0.6462576499287087f, 0.6128260144666114f, 0.08394307382356281f},
    {0.07553684000234662f, 0.1724479712420628f, 0.474816573505206f},
    {0.6957043117206256f, 0.48130286028422653f, 0.9954147709844657f},
    {0.7356452162113344f, 0.7741176581044842f, 0.9997084921470215f},
    {0.5175465610540769f, 0.7479158969622636f, 0.9161012704048822f},
    {0.2979442528857047f, 0.9200567616934571f, 0.5435611258832942f},
    {0.1268337870710714f, 0.3524492507430502f, 0.4171154083753472f},
    {0.18518521698189305f, 0.8796118139703316f, 0.5687020215164174f},
    {0.7217641899610009f, 0.4157965779336894f, 0.8637755715544921f},
    {0.01334858121189042f, 0.04557318421873835f, 0.31242074603091696f},
    {0.8224149121745269f, 0.12190548974812643f, 0.5380328649344417f},
    {0.005206080288533421f, 0.796799209808118f, 0.9622030037248335f},
    {0.6837503174119061f, 0.8763757441837031f, 0.5279087153939449f},
    {0.7228103954209316f, 0.0542338645897964f, 0.6353565001079038f},
    {0.8220733544410654f, 0.8596360366107035f, 0.8924916591963773f},
    {0.6135079557466596f, 0.500561695201397f, 0.6917330082998905f},
    {0.6466191314243801f, 0.6947305676552847f, 0.5076372823489093f},
    {0.8768779953328032f, 0.16866919639203848f, 0.018032283374430302f},
    {0.38639761640171566f, 0.7842433362078991f, 0.7045488695612275f},
    {0.4902057094294605f, 0.7643624567697711f, 0.529111433899998f},
    {0.40038679395033083f, 0.057083101052173624f, 0.5887189541872455f},
    {0.3309177220190368f, 0.49577968921414983f, 0.9050149392876515f},
    {0.8976977419868442f, 0.12604774980592304f, 0.44377258612698445f},
    {0.17005430166351432f, 0.3663896363882547f, 0.09801653997262383f},
    {0.8277363924450449f, 0.7499819188601897f, 0.3466428322059093f},
    {0.44728430525605734f, 0.9329158000573394f, 0.716560386653468f},
    {0.8637613513579647f, 0.48470936395077635f, 0.4844094172030031f},
    {0.4255053880568125f, 0.3360182417587013f, 0.39664476279719096f},
    {0.9793195286641179f, 0.9562342221942197f, 0.5145941625677136f},
    {0.16196139331040804f, 0.9113337139898771f, 0.4486028505229439f},
    {0.8649629340116192f, 0.059642866135274475f, 0.9962668858868577f},
    {0.3841745506298363f, 0.8626144404849436f, 0.5589746506540955f},
    {0.5362087044869693f, 0.33646614599288605f, 0.3325932863593525f},
    {0.553320092527449f, 0.5783537094815989f, 0.7504179599332006f},
    {0.15273108450287176f, 0.7164971936238236f, 0.9667317887243934f},
    {0.4253568432688575f, 0.575305969284735f, 0.316509330589014f},
    {0.20411399061407864f, 0.3383442930415591f, 0.36305966072917006f},
    {0.04311654745456317f, 0.44372644244160253f, 0.045829864623331495f},
    {0.776510230414321f, 0.9502340511792925f, 0.9363520271915545f},
    {0.5772203273739478f, 0.1942540570604706f, 0.6332061970431091f},
    {0.4296324596583443f, 0.579683982254076f, 0.8231010362478722f},
    {0.4383392619681643f, 0.6913035895681134f, 0.6580080392445505f},
    {0.6166379007059922f, 0.26673047742718936f, 0.2933476498084613f},
    {0.30278866085962197f, 0.10047698262086102f, 0.6415559240579415f},
    {0.3578936025412208f, 0.4154811920065138f, 0.1345284948518154f},
    {0.0801903614804339f, 0.8147594125306684f, 0.40292320395403314f},
    {0.8958722326491547f, 0.5293833155537304f, 0.2965332124032791f},
    {0.8392116879639183f, 0.20599490738956527f, 0.2118409099977091f},
    {0.8247677862751138f, 0.7523218238914889f, 0.8338778480720727f},
    {0.6986142326246407f, 0.002419718624360967f, 0.4145574930003425f},
    {0.9561531741737339f, 0.946140024435672f, 0.5224947091902592f},
    {0.4634021749568018f, 0.30699593129830405f, 0.6078636132264909f},
    {0.11162363765990979f, 0.436297927735362f, 0.8655838899471964f},
    {0.8560100070726755f, 0.2510967563665918f, 0.3928873053455414f},
    {0.32176789331001276f, 0.5714682670897143f, 0.9923861707194063f},
    {0.7344439673875083f, 0.5702824149284748f, 0.36285625668814403f},
    {0.06515577527077132f, 0.9927093009996272f, 0.9843289330401741f},
    {0.9223932964331295f, 0.21246116787868408f, 0.49118334229280824f},
    {0.17256693895821618f, 0.8751074568183976f, 0.9152471377423389f},
    {0.7077193393955262f, 0.7546739415297711f, 0.8780082999593876f},
    {0.6680631400655233f, 0.555508729091423f, 0.5720027904039391f},
    {0.18163510449858633f, 0.17525350888117353f, 0.49469724716949226f},
    {0.6153299636715162f, 0.25210336379783627f, 0.5652932189496179f},
    {0.27297140286672283f, 0.12449923741179492f, 0.5529964265681994f},
    {0.7563338296183307f, 0.37423578765230703f, 0.6485382261155751f},
    {0.8570489709850196f, 0.49596650949409604f, 0.287552026838654f},
    {0.0891406396708444f, 0.08662506369229905f, 0.632363212216981f},
    {0.47778844132159104f, 0.45710989287590065f, 0.31440514322893054f},
    {0.2799926657879024f, 0.24313446092015212f, 0.718449679648481f},
    {0.9417153951993079f, 0.7540320573922177f, 0.005956994834991236f},
    {0.581128137542923f, 0.8905447497608048f, 0.5681999327933004f},
    {0.07840205740107198f, 0.8555114895772148f, 0.25225784561197206f},
    {0.45637088467999865f, 0.24711385838596767f, 0.619322836322571f},
    {0.11729184228366873f, 0.04197318024580465f, 0.20255034821885987f},
    {0.5836475479631524f, 0.48395709913575335f, 0.13557341680895107f},
    {0.9625202343583444f, 0.4120600215411121f, 0.12886344196040733f},
    {0.8389904127268322f, 0.062269623975085064f, 0.38627333744298464f},
    {0.3328391028188984f, 0.7026900976800856f, 0.9764241663449792f},
    {0.7399156536385807f, 0.30705618068815854f, 0.9303441100596641f},
    {0.7271375243088986f, 0.09150640916339559f, 0.7130564681073247f},
    {0.8432527583820943f, 0.1584570599819085f, 0.7234768813315737f},
    {0.4944362696897444f, 0.8197546034837784f, 0.6096317218693642f},
    {0.5613060984870177f, 0.37875677598711566f, 0.7144276954705928f},
    {0.810199508999185f, 0.8499898546308865f, 0.022208613511656705f},
    {0.07745211401674745f, 0.9899548128846762f, 0.027983255826982134f},
    {0.23515345329662818f, 0.640351454291449f, 0.772339301534426f},
    {0.6759044759277097f, 0.14789479883543977f, 0.9422227357460512f},
    {0.6989382209245032f, 0.455356196139147f, 0.4794083168239891f},
    {0.19978255268427547f, 0.47480985495155625f, 0.4774955183767621f},
    {0.14241175695301467f, 0.32816033775008f, 0.9258394053172405f},
    {0.7762009732564109f, 0.9569759076071231f, 0.6275182508001534f},
    {0.37594732034775835f, 0.6784487400373042f, 0.5763065927212949f},
    {0.3390726424575451f, 0.7362352396431496f, 0.008366104929444895f},
    {0.02702798550945018f, 0.0017633701928674306f, 0.878551358505965f},
    {0.1889486687257641f, 0.9325445895179932f, 0.8718417780552121f},
    {0.39423710791886846f, 0.4976833213973699f, 0.7822450677878667f},
    {0.16833839481422175f, 0.8268576406119915f, 0.3912559293583491f},
    {0.43481371645652467f, 0.7907267919532145f, 0.7723900628844302f},
    {0.5792417798030908f, 0.9081918507714479f, 0.5532238850041103f},
    {0.8967808558982475f, 0.15479611769196555f, 0.08084815964923076f},
    {0.6409363106634359f, 0.4546708080594619f, 0.8956860990875937f},
    {0.9735057002470163f, 0.1679242784740711f, 0.23603946830847466f},
    {0.9879311699026194f, 0.14414510962941018f, 0.6107741701625958f},
    {0.017349821361535067f, 0.6152674736498436f, 0.12541367124148972f},
    {0.29723982409241245f, 0.7109738057496496f, 0.9235715001624364f},
    {0.568455547948664f, 0.44831004839945776f, 0.22355688380946348f},
    {0.39427551384682935f, 0.47533560140254416f, 0.9946191425416059f},
    {0.6147452683683657f, 0.5832798990564645f, 0.746641458755704f},
    {0.1739076277897923f, 0.4832546089122931f, 0.18362075536968792f},
    {0.5968511480184544f, 0.4999888208060075f, 0.643417898546791f},
    {0.4911633162889334f, 0.2557871417895463f, 0.40818828145344144f},
    {0.3387934628886714f, 0.6666672046171344f, 0.6758385997924954f},
    {0.7265305043290248f, 0.40150943872038536f, 0.947245947466273f},
    {0.0891007342496537f, 0.49765063104427143f, 0.7844333974391101f},
    {0.650359504846714f, 0.7324001086072924f, 0.4385097327603733f},
    {0.6627146406087654f, 0.4443271086627839f, 0.02254132787906249f},
    {0.07712838086846563f, 0.34269836135969156f, 0.2276073366709076f},
    {0.9108130628540281f, 0.4821464369698485f, 0.08524621527626997f},
    {0.5536282753618116f, 0.09562023875664782f, 0.9180360312517221f},
    {0.5809530166678061f, 0.7732463542128516f, 0.2824048527753401f},
    {0.06909864660157183f, 0.8479827245591622f, 0.9540106406262797f},
    {0.2357481549298036f, 0.9403973652434481f, 0.23987431985705154f},
    {0.6975158959584201f, 0.23581997030001323f, 0.9646393238981346f},
    {0.5190426724887393f, 0.8951337642343423f, 0.9986201208829412f},
    {0.07130232254588709f, 0.9489556760249114f, 0.12136068395881994f},
    {0.1782710453025821f, 0.5223527297654563f, 0.9635903189936813f},
    {0.7472724281574927f, 0.34196945578258187f, 0.4565143611859066f},
    {0.5574406761546604f, 0.477569488833268f, 0.15229687526240132f},
    {0.07911967629385208f, 0.7957470307139194f, 0.0948058838498772f},
    {0.13895966521171144f, 0.60059068610247f, 0.6759210889211645f},
    {0.22722194860909017f, 0.49923923520400537f, 0.5747396452890797f},
    {0.7336741528702727f, 0.6784071095456294f, 0.12717343903285805f},
    {0.8521284575007689f, 0.6651271598993084f, 0.10343344455261128f},
    {0.8408060410292441f, 0.06522795478099008f, 0.016562517800962517f},
    {0.7776527147015881f, 0.6706632456033924f, 0.7814903620928674f},
    {0.3163600410256938f, 0.9008402648081979f, 0.1859310582176713f},
    {0.9240252552956203f, 0.2620448697564004f, 0.5717049739973822f},
    {0.7704424745248758f, 0.23156543371121685f, 0.05004165986490183f},
    {0.9569967063133832f, 0.6882505829531688f, 0.6081343999534593f},
    {0.9765138354666169f, 0.5916500288898396f, 0.5735838009525458f},
    {0.04116647607516133f, 0.43868085116213296f, 0.8992529577161146f},
    {0.779337574758089f, 0.12892642573356772f, 0.6193629236487715f},
    {0.6863976739584357f, 0.48019729161001357f, 0.13965163510134593f},
    {0.8315583028345264f, 0.18193379034761248f, 0.7758344925290975f},
    {0.09783431632509954f, 0.6213298758000002f, 0.47001052411659416f},
    {0.8663133955882559f, 0.37871592044028934f, 0.2845834224966389f},
    {0.4682375093971004f, 0.9191992551409963f, 0.43262579435659876f},
    {0.2593522586403435f, 0.31850514867075863f, 0.9795763502545829f},
    {0.5971233611400628f, 0.1759557085933392f, 0.10774354675808451f},
    {0.8417976004930797f, 0.741162127164471f, 0.4762484160528677f},
    {0.7598152838860405f, 0.1260466007055231f, 0.8378842728363046f},
    {0.1330862389852311f, 0.7221024857677305f, 0.9968776317452489f},
    {0.07955938818613617f, 0.2503346145834662f, 0.35969070237044354f},
    {0.3004487831079592f, 0.661360018605663f, 0.010316135347711919f},
    {0.3274027429403452f, 0.2064048522548848f, 0.257152290386956f},
    {0.5766382207668083f, 0.9094369947861787f, 0.3026332459661445f},
    {0.29832157154833916f, 0.6882001423243885f, 0.395608647389189f},
    {0.556464616342881f, 0.06191841572595769f, 0.18342204247796057f},
    {0.2440604104156897f, 0.4820131869941746f, 0.4105834358598185f},
    {0.41388339752605896f, 0.025040773082033896f, 0.4816124984267305f},
    {0.34424518055928155f, 0.9394185371643936f, 0.1271378693568439f},
    {0.5954429649419921f, 0.9162944928590967f, 0.9637284850804277f},
    {0.8469251333667138f, 0.5688093252427178f, 0.9090980844846436f},
    {0.19342601102213375f, 0.5131683233539184f, 0.6814469619282079f},
    {0.33544212559848574f, 0.7997487212900976f, 0.32413008326109005f},
    {0.6953287402077751f, 0.4988149412152332f, 0.16945437238510153f},
    {0.2440769032616512f, 0.5117859796750386f, 0.494605854995129f},
    {0.8398524307174651f, 0.9503566433651307f, 0.3095152873925482f},
    {0.9506628527618203f, 0.5377187004428751f, 0.47854950012783626f},
    {0.8528698658774375f, 0.033273793823918374f, 0.7513360188663849f},
    {0.9045840986621558f, 0.29073458437050226f, 0.8573793767953465f},
    {0.8943230089758554f, 0.6406289019243034f, 0.44789281265841285f},
    {0.7539483527379605f, 0.73918062606392f, 0.08925208202308421f},
    {0.5678943183713194f, 0.8840893339551515f, 0.9679779334984567f},
    {0.3839283831795687f, 0.5250170076260327f, 0.147435540891254f},
    {0.8448815422759915f, 0.8623695207841747f, 0.06015160800639918f},
    {0.8957816420067045f, 0.9498899305142244f, 0.4254872536921763f},
    {0.0017895943740948717f, 0.45403915053413724f, 0.9292311299043069f},
    {0.20384902236467128f, 0.7670999581722348f, 0.37348509120800755f},
    {0.07459673746582873f, 0.4187918887856442f, 0.9358871225085982f},
    {0.9765733652809762f, 0.07457523907899366f, 0.14794039720827723f},
    {0.7221326651103019f, 0.09142022630910918f, 0.590134390470865f},
    {0.2731904294444343f, 0.014872904485773386f, 0.28423510865465573f},
    {0.9595460331077476f, 0.627777823749429f, 0.6878934751410783f},
    {0.805767888010791f, 0.3854499749977387f, 0.2069477171258729f},
    {0.6259343284668969f, 0.10522227604701817f, 0.077651589845811f},
    {0.5607684588022285f, 0.7289471726944003f, 0.1252112544716376f},
    {0.14211357270234615f, 0.6024796041328132f, 0.8819891472886957f},
    {0.8380026283534052f, 0.04421394068580198f, 0.39036752154313925f},
    {0.36608315619782283f, 0.3458490341416042f, 0.16158056038829305f},
    {0.32921241649790933f, 0.563603098902749f, 0.7601667313763586f},
    {0.6719532037244359f, 0.38919324021281365f, 0.9704041318186061f},
    {0.7764922893050227f, 0.7123564551655506f, 0.4896320731078617f},
    {0.38127436176447105f, 0.4041900747887983f, 0.7529059926589904f},
    {0.5517502869098632f, 0.5017796855341052f, 0.5423582209112773f},
    {0.6164811181563024f, 0.8489759052215298f, 0.8837485514336959f},
    {0.2445296797916473f, 0.038742032377370395f, 0.8528065240596618f},
    {0.5753233460034087f, 0.022375316145051616f, 0.1129838461665621f},
    {0.025912846984319504f, 0.004461465552223043f, 0.4132433107851389f},
    {0.5673521617780029f, 0.8423971016457481f, 0.7632878931653616f},
    {0.7810212639773573f, 0.27156735257440356f, 0.8342911526008776f},
    {0.6823058562253704f, 0.10878410459671684f, 0.33946094930894744f},
    {0.6543419728169441f, 0.9647519392826234f, 0.030654644538673392f},
    {0.7136919006907404f, 0.4009186588631015f, 0.8370766006437007f},
    {0.9808155303021092f, 0.434094049699022f, 0.9969562194889923f},
    {0.08675596784368456f, 0.33276180162047697f, 0.8376006360869643f},
    {0.9959898567064204f, 0.45599206164086115f, 0.6972946365434771f},
    {0.8049039019415746f, 0.983712277443022f, 0.42803771857433537f},
    {0.8590558587319091f, 0.809977516160431f, 0.6636361848828647f},
    {0.9469621821536345f, 0.3689463651870152f, 0.7987942574303242f},
    {0.18558138398701218f, 0.30447853527268787f, 0.19691772544707686f},
    {0.5784429193728214f, 0.1946414923104729f, 0.9864508406593911f},
    {0.4294554107037888f, 0.17914233913207278f, 0.35847917626241443f},
    {0.9896099990091021f, 0.9219374549777101f, 0.041794974753961545f},
    {0.009201741663491081f, 0.9931563907372434f, 0.40378545821570644f},
    {0.11763008495779725f, 0.46231478415738936f, 0.5685228223131746f},
    {0.04742118659689032f, 0.1938252828851703f, 0.8203140262065723f},
    {0.7455461603235953f, 0.9820808429542459f, 0.10299751251381306f},
    {0.07842902898198933f, 0.24265051393837456f, 0.36266166571312963f},
    {0.9562623015010845f, 0.8809839910487465f, 0.36210561779445083f},
    {0.846529903835926f, 0.5874462622597145f, 0.17572833292649204f},
    {0.6177207236610086f, 0.1497782558593821f, 0.6201711685485297f},
    {0.5046369800091087f, 0.8456533024416818f, 0.934889865515198f},
    {0.845643472313294f, 0.4177650067839984f, 0.843081199081394f},
    {0.849542756631608f, 0.3112829115689817f, 0.26443376478160086f},
    {0.1599009297463414f, 0.4244429473164876f, 0.2683991727325885f},
    {0.03508138483440182f, 0.20282208941419977f, 0.05446194558072137f},
    {0.8131853415522564f, 0.20811517948647507f, 0.30452982149881436f},
    {0.8550397268446742f, 0.9005831937389109f, 0.37377834039799096f},
    {0.3542787082619995f, 0.5125080342480459f, 0.7549123695625977f},
    {0.24293257950848635f, 0.1393123196102406f, 0.4484716182428995f},
    {0.8446836437540205f, 0.8170361006533674f, 0.8986056092534018f},
    {0.37528153845553514f, 0.717926219267321f, 0.37682397992490635f},
    {0.7541607516905069f, 0.605208867163662f, 0.2143926188833205f},
    {0.733209620328726f, 0.07263128144850639f, 0.8436442968573818f},
    {0.6117465894374037f, 0.019670237901135423f, 0.7609746835621394f},
    {0.44506820063898955f, 0.5403617377654181f, 0.5339773977000385f},
    {0.04170506363236859f, 0.1315260965714926f, 0.9173562409169015f},
    {0.8851901050003145f, 0.7650707474681198f, 0.12791073024787736f},
    {0.3044297786716227f, 0.4690032785548055f, 0.12471274634290874f},
    {0.1018144633073017f, 0.7181034678125146f, 0.22652018631621873f},
    {0.680589042175913f, 0.6487348401270057f, 0.04793347807923054f},
    {0.27343156471208785f, 0.27039778550215476f, 0.15275853956013996f},
    {0.519715939261731f, 0.4799518577022671f, 0.2450619426319819f},
    {0.4485838101916054f, 0.8476986585140487f, 0.34511036018225427f},
    {0.6558349693033276f, 0.9398762949986794f, 0.7910577715725181f},
    {0.7323970239867681f, 0.3786842632327433f, 0.7446997721506738f},
    {0.8284184506341449f, 0.05577383164131178f, 0.4855453237904661f},
    {0.5649715054591908f, 0.6676745481525559f, 0.8068593993558854f},
    {0.9140619043446202f, 0.36301832179044f, 0.20807027536237432f},
    {0.1506071322212441f, 0.6081103515443229f, 0.7131394269704993f},
    {0.6345865724609533f, 0.7031958961266661f, 0.7796788244746587f},
    {0.22092251650670447f, 0.9783912108648529f, 0.434250853851339f},
    {0.26784468087724755f, 0.8955335244208056f, 0.36739525776954485f},
    {0.7607515274306325f, 0.04429641009267926f, 0.5770126745627389f},
    {0.7906733799074854f, 0.6883094396971179f, 0.485937637777066f},
    {0.45105070421038773f, 0.9747280389084765f, 0.6202957896932738f},
    {0.19402531356081976f, 0.44682510793175245f, 0.5577871713529243f},
    {0.05030375175010815f, 0.7025994458475031f, 0.5587635693842834f},
    {0.3387403694282093f, 0.5910817777234942f, 0.911790792552483f},
    {0.36817720608136606f, 0.5765237225242912f, 0.08772454378560035f},
    {0.38269744101117287f, 0.9021014612438039f, 0.4288388149465996f},
    {0.5132428899643021f, 0.9491138642661235f, 0.10615798489799111f},
    {0.5574647729492546f, 0.9005717527804169f, 0.9348221792999674f},
    {0.4073120174653393f, 0.6922141130254122f, 0.8545257338029214f},
    {0.8991295237947453f, 0.23110285740647607f, 0.9747529750890653f},
    {0.27192174505477396f, 0.9936283700993038f, 0.19199870823790433f},
    {0.2173068776945325f, 0.579195195458859f, 0.13323636201250477f},
    {0.9913233488605244f, 0.05351604970361279f, 0.27807281419548924f},
    {0.8719017877466372f, 0.8577302190240833f, 0.09298688600688265f},
    {0.5281033238376629f, 0.990004574065937f, 0.6185704400558223f},
    {0.7052948993769673f, 0.3492274812782519f, 0.7370879758188094f},
    {0.09375477456513093f, 0.9874909368910582f, 0.05027292140946238f},
    {0.1525808050439773f, 0.3482487263936608f, 0.8040261827055594f},
    {0.7987334639348372f, 0.908105525866651f, 0.4606065387374195f},
    {0.04455884803284382f, 0.10736489642711189f, 0.37685191366850657f},
    {0.6263852881424128f, 0.21300420407927012f, 0.23621956715219983f},
    {0.4911280776074206f, 0.12008112131489601f, 0.10730719787890441f},
    {0.5631334460147597f, 0.32057689942335077f, 0.25680043224794125f},
    {0.8446818885447094f, 0.6042902155604412f, 0.8166749429198239f},
    {0.6771478272376149f, 0.9275425829825223f, 0.8071660067403905f},
    {0.3399865783827998f, 0.4810226881099222f, 0.24460086003259518f},
    {0.6131469903480776f, 0.04218638320983592f, 0.5446910852500788f},
    {0.489407193088119f, 0.9727481989897845f, 0.8677027627107835f},
    {0.5861741062251178f, 0.6285588234221761f, 0.9038575335852649f},
    {0.12355586998387313f, 0.657751724036252f, 0.21066781115981625f},
    {0.33789148133478f, 0.3327736385094908f, 0.0893714988216665f},
    {0.4738761950269723f, 0.17332078401347228f, 0.975481956988638f},
    {0.8747219314358404f, 0.26921801245505905f, 0.9229597942665577f},
    {0.3614387247231894f, 0.24941604438137888f, 0.0991283228330253f},
    {0.8630163749555937f, 0.8455947032078038f, 0.7794514083755345f},
    {0.1725759246300388f, 0.2356353027044582f, 0.4697591224304334f},
    {0.8699545776870558f, 0.43959072506292274f, 0.6093789319157804f},
    {0.687506522260094f, 0.7809355400441227f, 0.5220266653759925f},
    {0.3082973554294315f, 0.4137164193781391f, 0.7275453435644635f},
    {0.6860419627216362f, 0.14486407680015634f, 0.36190659612768794f},
    {0.9084425596658166f, 0.2162179774178915f, 0.0015766589538982467f},
    {0.7034285296549359f, 0.36178398001051504f, 0.7919309043675021f},
    {0.8260154501349777f, 0.3491707266442089f, 0.9529879330805464f},
    {0.8691463546062007f, 0.48022455799671926f, 0.852896642976331f},
    {0.964610726512902f, 0.29807531892908024f, 0.4642309818002459f},
    {0.30286700535045374f, 0.4464825774444352f, 0.28325209006784247f},
    {0.3851004855700848f, 0.8849614759883512f, 0.5174453784330727f},
    {0.9481117878386354f, 0.2983129393423366f, 0.525011066793968f},
    {0.5791229891559001f, 0.972007895874381f, 0.8667488932139825f},
    {0.33591256688846727f, 0.14751831836776608f, 0.2627882795319755f},
    {0.8811494227307047f, 0.7381275090226936f, 0.5957105934138964f},
    {0.2748084106766785f, 0.41921175823871126f, 0.40914856757294027f},
    {0.5508431394795702f, 0.8743108720945251f, 0.5259528107839256f},
    {0.005529008126193835f, 0.05925245014689717f, 0.7437840503246861f},
    {0.48072588757953905f, 0.1253093799961662f, 0.6199061991387954f},
    {0.07531778179099813f, 0.035348032688307884f, 0.08791875708495567f},
    {0.06869912204126216f, 0.526628678814183f, 0.9036267428288829f},
    {0.7324539357872939f, 0.34536552736339854f, 0.7195015269847267f},
    {0.7593919225150605f, 0.9197982703169857f, 0.23201201339247812f},
    {0.3950300147427762f, 0.5913116777322748f, 0.9520145900310873f},
    {0.3050483697893993f, 0.915176234267189f, 0.6372455861050185f},
    {0.2500360830317697f, 0.8204443349144034f, 0.2588953646614667f},
    {0.3575912463514016f, 0.5034193207543822f, 0.5429658368125364f},
    {0.1464417980626247f, 0.9308301193943569f, 0.26130468965970854f},
    {0.8021894920320761f, 0.08101285769593469f, 0.9861758560941267f},
    {0.6447281016584385f, 0.13030742560697506f, 0.8212813641449702f},
    {0.5825674429174066f, 0.9034025948723947f, 0.07575138637771284f},
    {0.6339117789480645f, 0.11107216669980324f, 0.38295694928133905f},
    {0.06636119403782814f, 0.43902422074224756f, 0.9025974967671369f},
    {0.9780019779121435f, 0.07874678765710674f, 0.7220872636138993f},
    {0.6725878810454791f, 0.9120077195033593f, 0.001925258333401847f},
    {0.4949969665985604f, 0.9037052490583154f, 0.5154734579305803f},
    {0.6293953034678915f, 0.7120551795326073f, 0.22502149422569828f},
    {0.7650838669322446f, 0.8891890313780594f, 0.6359917295104258f},
    {0.7218750311767225f, 0.7191982592199532f, 0.2703098855563243f},
    {0.43300844943063244f, 0.3161372206987785f, 0.5948608978683614f},
    {0.8690475749114843f, 0.6508469008395597f, 0.26513551621887843f},
    {0.41301088414130394f, 0.851377163375616f, 0.22876976914566194f},
    {0.7300607299471129f, 0.27494916425931204f, 0.1729117660495536f},
    {0.736149985186305f, 0.5802028815961691f, 0.6469214216977159f},
    {0.7634894049958069f, 0.3138771800219897f, 0.013374435202243906f},
    {0.004795058410967612f, 0.05404945883520218f, 0.15470171200258753f},
    {0.07718433521100387f, 0.8472837110887264f, 0.6866206906757456f},
    {0.3973603628752388f, 0.302760815389819f, 0.49039857243218166f},
    {0.3122585309536321f, 0.005335656871336525f, 0.37757401702990545f},
    {0.5927467433594459f, 0.8992830707253091f, 0.6739467057964282f},
    {0.27272245814527374f, 0.1318472705525625f, 0.23378373527687668f},
    {0.7552481476708143f, 0.624995710479783f, 0.3849615983956728f},
    {0.3883239074267967f, 0.47049057602726263f, 0.4203443156715575f},
    {0.9587909712223209f, 0.2082190235305479f, 0.873950914671507f},
    {0.3691766468738008f, 0.6853465998647531f, 0.23535415757451605f},
    {0.1832760419742464f, 0.49893081428575525f, 0.021865440918578116f},
    {0.9019260689583164f, 0.8731585483409182f, 0.34953682990659496f},
    {0.917882967537021f, 0.08275825050997732f, 0.3629349676278686f},
    {0.2270873676638797f, 0.30780032212349184f, 0.48736436388064097f},
    {0.4800879230263454f, 0.4292427776405745f, 0.34723762215420506f},
    {0.916901014828828f, 0.5297490618503766f, 0.6058398942095312f},
    {0.6269099635629569f, 0.9406405450992866f, 0.5471161673685746f},
    {0.24948388994486537f, 0.3150500966753642f, 0.9173191371791316f},
    {0.5889838990825474f, 0.4168052853856268f, 0.1628896053850747f},
    {0.7481723667074082f, 0.604106837421562f, 0.9354423860848788f},
    {0.9285944814790911f, 0.9318554469459841f, 0.502932144782893f},
    {0.17176578068436743f, 0.32090073880971104f, 0.11519583096104524f},
    {0.29913472338426783f, 0.2090445762406825f, 0.27805289264169386f},
    {0.9783375201093861f, 0.6299225692163454f, 0.35451210979987746f},
    {0.7794952448237137f, 0.46692392974204366f, 0.07134994704664233f},
    {0.8302490711351908f, 0.17040866038451286f, 0.6695626910893587f},
    {0.5464977744147091f, 0.7573877387978512f, 0.21724417883413594f},
    {0.6163558575581992f, 0.6441001658980183f, 0.10017986019959446f},
    {0.3845075227250426f, 0.9444186855339386f, 0.45611389443993333f},
    {0.44806695719549827f, 0.4850330405447698f, 0.3986458044686242f},
    {0.42429033552976847f, 0.12398308130841762f, 0.6900184663673538f},
    {0.9560323949556925f, 0.8354881762717165f, 0.8685852508269226f},
    {0.6662580559307949f, 0.42969682737246584f, 0.3741839069447681f},
    {0.46140066966415205f, 0.680016672356624f, 0.4315846592599074f},
    {0.16864363276336125f, 0.8415493317331997f, 0.9327666769431752f},
    {0.07213398760004663f, 0.1524477066232326f, 0.33351612779591167f},
    {0.4655882679257354f, 0.1602032518244927f, 0.9517251711839817f},
    {0.6572865353431937f, 0.677589706558957f, 0.875824517614939f},
    {0.6432069836799227f, 0.7288275435346323f, 0.7600000553753343f},
    {0.2737519553675193f, 0.04281739446494459f, 0.9140687150055178f},
    {0.04925685372096311f, 0.08346575692623937f, 0.5490904132857382f},
    {0.3205464966078192f, 0.9882975584795773f, 0.10200262260900284f},
    {0.12273788221960258f, 0.7621866494545386f, 0.4538456291212729f},
    {0.4946915983237231f, 0.8314438264931598f, 0.4150612758050678f},
    {0.07075739676007708f, 0.5504478716837621f, 0.5930064111183068f},
    {0.7484980592616678f, 0.9433973842969163f, 0.7738788026888682f},
    {0.46603373732967435f, 0.41400908832784944f, 0.5187213246490958f},
    {0.5495170242577531f, 0.5998225245260078f, 0.6945792518320183f},
    {0.48961741861300645f, 0.6166402868469643f, 0.17639580024137558f},
    {0.8673330111821317f, 0.9614963509298168f, 0.9368326814942776f},
    {0.9536294322920488f, 0.4752443671170663f, 0.0516651048603205f},
    {0.00468580930985707f, 0.36464888997036893f, 0.974912917880633f},
    {0.8678743641276216f, 0.7259640135389988f, 0.7768925708091426f},
    {0.8012245993279674f, 0.15423237472528195f, 0.2786415605930569f},
    {0.08680852517463478f, 0.1141735049410264f, 0.27317827027700914f},
    {0.0561364333603761f, 0.849622751813881f, 0.24614359699545107f},
    {0.850953379381006f, 0.9089879396579285f, 0.7806335456050452f},
    {0.7936870039738821f, 0.21365438880416399f, 0.7269209626602311f},
    {0.7222055741328888f, 0.3467828793634494f, 0.3709370835843303f},
    {0.17546766632129984f, 0.9379167904775779f, 0.6271678782010595f},
    {0.43030383682637074f, 0.9385936567851767f, 0.00054996966557741f},
    {0.264366991222742f, 0.15911697413807335f, 0.40576053055619055f},
    {0.8399434786075831f, 0.3221050174313357f, 0.9460660221078184f},
    {0.7714415260393176f, 0.6165208094962075f, 0.4450781916168395f},
    {0.35912957707943804f, 0.9960587595469327f, 0.7897266562018656f},
    {0.29960680438650167f, 0.44228918410782436f, 0.18735447402476102f},
    {0.5012688119515128f, 0.6684470114439692f, 0.5814631153255438f},
    {0.6604960607912812f, 0.4522462859599161f, 0.1542087555716477f},
    {0.8444887884886578f, 0.6149623893485122f, 0.480078025051099f},
    {0.8090545895614158f, 0.9013861534859408f, 0.8937559566907805f},
    {0.3413893478797233f, 0.8559638987658613f, 0.9474978097050806f},
    {0.6987133937036033f, 0.2748215257898766f, 0.409732150645606f},
    {0.67563372647617f, 0.35140736750220003f, 0.22361381817269688f},
    {0.1700357662042088f, 0.7353805313522468f, 0.7723147319198507f},
    {0.6399396225782876f, 0.9882934958799505f, 0.7401486264024829f},
    {0.5074508357596117f, 0.9170120224399997f, 0.9509992878376651f},
    {0.9419627065499401f, 0.891450785350586f, 0.5311660508235929f},
    {0.9867084892849562f, 0.9691685859627259f, 0.8512619927396393f},
    {0.8538648379421592f, 0.5186082209814998f, 0.9424826838108346f},
    {0.9113342445801066f, 0.07018206777342617f, 0.10932848299537434f},
    {0.9565042023243139f, 0.7142782983085367f, 0.563030785896915f},
    {0.10049037425704521f, 0.9892679507091182f, 0.1463086492299659f},
    {0.07055751505767416f, 0.08088093792250528f, 0.09935084968638463f},
    {0.0071658474376560255f, 0.7500772821936669f, 0.40249174341492144f},
    {0.8891321451697394f, 0.9508615727429564f, 0.8769174146567572f},
    {0.1474248622691785f, 0.9359593275185659f, 0.6139267279947771f},
    {0.7600252507257219f, 0.9805249327693296f, 0.9562619192072581f},
    {0.596479611715761f, 0.11698135190561121f, 0.7050770412001872f},
    {0.48103715963417826f, 0.24779668081142592f, 0.9302938534397612f},
    {0.3535014733729953f, 0.4602465540812889f, 0.3141173449131439f},
    {0.9654724877854894f, 0.3632994878140203f, 0.3549646033254227f},
    {0.1852299671073948f, 0.6937703979280894f, 0.4426994081709351f},
    {0.12072403170156176f, 0.26001859972167674f, 0.2168178463946161f},
    {0.7189960441908665f, 0.14888280325130465f, 0.9930947594810718f},
    {0.5693210396902586f, 0.6854114491054383f, 0.6593107020619087f},
    {0.9408932329981059f, 0.692990294381861f, 0.2665396057651247f},
    {0.00459640779627335f, 0.6924074963263502f, 0.42016619125664856f},
    {0.2907043272849774f, 0.4286219662563273f, 0.19688721359203765f},
    {0.16760448601129485f, 0.5103720763242999f, 0.9238187260187821f},
    {0.823995810132254f, 0.21133025863108568f, 0.920689524686181f},
    {0.4311164475166661f, 0.22305430427613226f, 0.19073302429322359f},
    {0.6352002428098812f, 0.17956332143899434f, 0.223361531156133f},
    {0.8790801507181459f, 0.5374092534213332f, 0.9455244912836781f},
    {0.2619682365724817f, 0.06891734065568267f, 0.7617919869513f},
    {0.3060640007880322f, 0.9087847435531753f, 0.9125451988229164f},
    {0.019322808611464293f, 0.3485776115438509f, 0.021566149184375938f},
    {0.1775797890570805f, 0.9739612610254289f, 0.3119397791783427f},
    {0.7027016105946873f, 0.6427564247644186f, 0.8850774245376898f},
    {0.9804166646790992f, 0.10640605688738225f, 0.4876096030715673f},
    {0.6756089589408846f, 0.6547753555634358f, 0.8096097833396035f},
    {0.566675361239198f, 0.8545916876791969f, 0.8692253296123689f},
    {0.4608253171240667f, 0.00024912726710657473f, 0.17615154855483384f},
    {0.4522679711079568f, 0.20285343182640914f, 0.2737377415335155f},
    {0.6465782706686967f, 0.6008688593975303f, 0.9920229317584758f},
    {0.5829423089881404f, 0.20046443066803155f, 0.4726268099447122f},
    {0.9705779867524604f, 0.11144714262593491f, 0.09865026461886661f},
    {0.4104032736062966f, 0.6496204506661889f, 0.7920297570046443f},
    {0.7623904208056672f, 0.9977998242972266f, 0.4088664906071323f},
    {0.5877517850289959f, 0.1937688142873485f, 0.2980373425837891f},
    {0.13194797973279604f, 0.305846436390261f, 0.844656240706761f},
    {0.6651345113144683f, 0.23108600353731257f, 0.8711513157694123f},
    {0.007946814348641418f, 0.6256094159984272f, 0.8677155640377343f},
    {0.4550683315824703f, 0.751067846728688f, 0.018120880539950868f},
    {0.740208181914949f, 0.8012714617536499f, 0.6901234015923973f},
    {0.224150470952716f, 0.5451097190199503f, 0.26214408042833337f},
    {0.9678591305403713f, 0.7067799498065084f, 0.8413842210510887f},
    {0.5327147462394177f, 0.6545997130989915f, 0.5393173638687548f},
    {0.6851994016121012f, 0.2081907267839409f, 0.6073948619383807f},
    {0.20793835271636685f, 0.5113472949930504f, 0.852344504750678f},
    {0.49537209061790655f, 0.8368032089047308f, 0.9913143408615287f},
    {0.264323101919004f, 0.9873262891212068f, 0.1925478469966334f},
    {0.4677619956344361f, 0.5692622643819732f, 0.47172843960426003f},
    {0.9698670369209931f, 0.8917746064939243f, 0.4618658710854835f},
    {0.36157277525228626f, 0.5162145035868084f, 0.9702327562356032f},
    {0.3350811615635515f, 0.12131670978653986f, 0.2884638784667971f},
    {0.7168109900743052f, 0.06369318984180994f, 0.9421166269361592f},
    {0.30734080852272694f, 0.7330881966631084f, 0.36518843930197187f},
    {0.09915513131714959f, 0.38875598492351393f, 0.7814575580645738f},
    {0.594766398747269f, 0.5806889684606129f, 0.919234864948139f},
    {0.6501213970177555f, 0.9583312441046709f, 0.18463549511753996f},
    {0.3613095788423428f, 0.5800204531208379f, 0.49888071848052207f},
    {0.8208434383008567f, 0.7855550005357718f, 0.8735105987903913f},
    {0.8021463086710561f, 0.9221415769411068f, 0.05545631713335142f},
    {0.8230942800679064f, 0.8997251316902023f, 0.8400933922911584f},
    {0.24380437153425827f, 0.14089365588274894f, 0.9566091382790127f},
    {0.44124840410827537f, 0.27285132494763886f, 0.8980666610334225f},
    {0.020263747410367516f, 0.15268732555034825f, 0.9429861352735586f},
    {0.6068056458067568f, 0.12904149251518793f, 0.013939428897042472f},
    {0.6610124058143091f, 0.22243676934530454f, 0.05819401399671076f},
    {0.7543792619668478f, 0.05248852322813591f, 0.7151452085457445f},
    {0.6316067501093496f, 0.8887332616190124f, 0.20796695736490345f},
    {0.18387471487819618f, 0.4079399605667332f, 0.11359431749443294f},
    {0.18533532188681323f, 0.4502454540314098f, 0.49596448624302414f},
    {0.6310096599033534f, 0.5794010454295199f, 0.8437209958103847f},
    {0.300502035897352f, 0.22144750625293497f, 0.4051847227928488f},
    {0.9376914595703765f, 0.8449070575641616f, 0.9918124931906827f},
    {0.15206962305829674f, 0.8821070168939515f, 0.5010417688933423f},
    {0.1227782880014513f, 0.6778541628109352f, 0.8743868934833404f},
    {0.1673083235384094f, 0.5035547178052788f, 0.33052798288933427f},
    {0.2929572600581313f, 0.8889783816486279f, 0.9666964756291072f},
    {0.23502324871603542f, 0.7688281160862281f, 0.9539703727065154f},
    {0.30803830260084086f, 0.15873553927866046f, 0.8050532006709611f},
    {0.2293812107684191f, 0.9893655121931141f, 0.4030657361443404f},
    {0.8458186278376291f, 0.35459644671425705f, 0.6146467803239881f},
    {0.8192021333707222f, 0.12023789500991278f, 0.03788373555689273f},
    {0.16877291370763892f, 0.7058999415914435f, 0.4417968556779077f},
    {0.9414427813436083f, 0.675760994869575f, 0.1039164009836071f},
    {0.08713951975813528f, 0.890976677138237f, 0.6890239674410585f},
    {0.6311041450492046f, 0.3208994146173283f, 0.402493113316007f},
    {0.5849392793046169f, 0.5847723267369609f, 0.31169119502714016f},
    {0.12261242076142576f, 0.80296862591639f, 0.9237141832009454f},
    {0.9572700737197876f, 0.85194392877144f, 0.16057289613605108f},
    {0.6676404442947654f, 0.6539829559831383f, 0.6142323716199167f},
    {0.875918466804246f, 0.9963888384706391f, 0.2972213571789617f},
    {0.38887864918129156f, 0.48616440140266926f, 0.995683894607523f},
    {0.8465636570895788f, 0.8824778871370794f, 0.9070103391281823f},
    {0.49967396889389737f, 0.6168675777557766f, 0.8017075161016033f},
    {0.6695444246220493f, 0.47713449922897644f, 0.5883839084772353f},
    {0.8197280761597008f, 0.08914939014656031f, 0.33383687315098254f},
    {0.6948510669381279f, 0.888190879475684f, 0.4649232638879509f},
    {0.601204339531347f, 0.8782803678001828f, 0.020644925259856173f},
    {0.017969825513207915f, 0.05056402679413241f, 0.7314213547312404f},
    {0.5385695725280822f, 0.8159612869818271f, 0.7337192841686786f},
    {0.9665090328347012f, 0.882880348325033f, 0.6710167626709224f},
    {0.41990669145593906f, 0.9727380052965653f, 0.42557817705077705f},
    {0.3198626256658852f, 0.8475076756963384f, 0.18751759532844925f},
    {0.21234475104502915f, 0.34910484429534927f, 0.46136127790522863f},
    {0.7287953574718276f, 0.0701480996838788f, 0.801115347417174f},
    {0.7376042907202894f, 0.21326930673587852f, 0.9110319501224022f},
    {0.08935848504795152f, 0.5380330984197104f, 0.7342326299753892f},
    {0.4329275284083697f, 0.36224230121549916f, 0.44301469948949623f},
    {0.4927944350045368f, 0.09195320057257717f, 0.5318410380808596f},
    {0.16362437583639655f, 0.1400384994127135f, 0.20770593325664566f},
    {0.7890550853898609f, 0.46973229612348233f, 0.6968025018955771f},
    {0.549849988221877f, 0.5871403779464449f, 0.6475506141615873f},
    {0.4547133086921509f, 0.7551541812697633f, 0.537103477492041f},
    {0.4864273142566916f, 0.28050256626854686f, 0.6774140829760859f},
    {0.23554302809133032f, 0.7054377810938172f, 0.20871085826240054f},
    {0.41994961878636905f, 0.6698754111548781f, 0.48459113150297684f},
    {0.30466647403451363f, 0.6996708007378123f, 0.12310141247385475f},
    {0.39166008840616595f, 0.44099888523380293f, 0.3535895502779107f},
    {0.8318150946306724f, 0.3738268602473157f, 0.6245422446387578f},
    {0.20503198816529478f, 0.7178731417323281f, 0.4103728037087626f},
    {0.8013114855916433f, 0.6674250449634581f, 0.31808710712523836f},
    {0.4523041566261937f, 0.6340572511045189f, 0.6784249285945503f},
    {0.6917028729332807f, 0.753099651806449f, 0.2237836701521293f},
    {0.21412404086789472f, 0.3110918269638746f, 0.7867298836774571f},
    {0.1433389387680949f, 0.5803443381052487f, 0.47027679837125724f},
    {0.8606802203274774f, 0.8538944469320863f, 0.9629283568610646f},
    {0.7579018652459514f, 0.4557321700185454f, 0.3837691351639284f},
    {0.1308538188657753f, 0.8092771034026568f, 0.6863136143756347f},
    {0.892092329397244f, 0.3973213388506037f, 0.2334773366232077f},
    {0.9005033979124755f, 0.05237225928454725f, 0.10903859825836848f},
    {0.3871835720554403f, 0.05744872004355739f, 0.4027949525083653f},
    {0.22794452181736125f, 0.09395799768905144f, 0.002375389511012571f},
    {0.48375747996308227f, 0.9158875099100264f, 0.1811993189165757f},
    {0.6998068481600679f, 0.30320582595393986f, 0.6790370634622594f},
    {0.15476138468535727f, 0.6917335043173863f, 0.3717118549778484f},
    {0.07563349136686814f, 0.7860100673776637f, 0.8704214718492925f},
    {0.8768405964493086f, 0.025863226543168083f, 0.74927916979543f},
    {0.2921623288032503f, 0.815549805661247f, 0.41990471330781864f},
    {0.8269566386862228f, 0.5494958137063726f, 0.028329620244677223f},
    {0.4222435117743901f, 0.2264912793674344f, 0.0009748802025886238f},
    {0.001466824060279981f, 0.7368920180382917f, 0.21817996782243143f},
    {0.06421971503058044f, 0.08622350353493846f, 0.6392818397031734f},
    {0.28927076906336857f, 0.7938810788509247f, 0.9563950585725496f},
    {0.7980565373221119f, 0.03893033018227887f, 0.9879470299049865f},
    {0.3076276404297178f, 0.5121910543268854f, 0.07516807180620211f},
    {0.602610457320191f, 0.9658506896248559f, 0.6711002445295254f},
    {0.6598172879742958f, 0.0007591023522015572f, 0.897866776962187f},
    {0.4975916254673809f, 0.25141822100110556f, 0.9201372878295984f},
    {0.26284131697753543f, 0.8731943485503657f, 0.27213769451042413f},
    {0.0356284188520507f, 0.1408169074651513f, 0.5824328254362577f},
    {0.2692033078664916f, 0.9279452733179139f, 0.16342476052277066f},
    {0.5453260752151429f, 0.25733925109973177f, 0.66451832955321f},
    {0.6659236722545405f, 0.819793370091935f, 0.36650057027991645f},
    {0.10932583430330645f, 0.6480034277008568f, 0.014568035818933178f},
    {0.22339598393323523f, 0.8392503698784132f, 0.6936836853495774f},
    {0.3998443955961698f, 0.8387331726819734f, 0.3104109912543376f},
    {0.1837004758505184f, 0.3214368850041732f, 0.7769864957001524f},
    {0.8034742598052702f, 0.579718130074332f, 0.7504364062934734f},
    {0.7376736039674092f, 0.46198835057532706f, 0.7334820213150671f},
    {0.7918108760808179f, 0.9436204488997983f, 0.26677738144777485f},
    {0.1325270660354404f, 0.00897106809745507f, 0.021003735104637378f},
    {0.5628319924389974f, 0.17971985193565754f, 0.025551037398578336f},
    {0.3485737760406692f, 0.49841232604947294f, 0.5481634432972056f},
    {0.9251217065844046f, 0.45556907752360165f, 0.20129345498866824f},
    {0.8460917367515801f, 0.4961556319559366f, 0.8997109518746983f},
    {0.45025768622178775f, 0.7386834549058202f, 0.7326007148169017f},
    {0.07596875124065317f, 0.7913847397963456f, 0.9868028174189835f},
    {0.08741331573279854f, 0.804545552990258f, 0.3401989714534457f},
    {0.8494262627829783f, 0.8910079943206369f, 0.06106148350680862f},
    {0.751294256098389f, 0.5163292142050608f, 0.013780422576521012f},
    {0.9208190227837427f, 0.1911592344479055f, 0.23028163682206537f},
    {0.9299369355073084f, 0.8122072189913219f, 0.18389120744606557f},
    {0.3965943446079412f, 0.7969585082901738f, 0.6485174983517881f},
    {0.09388152666325722f, 0.6449780899243736f, 0.06118058075072008f},
    {0.023432275673317515f, 0.48439482127308875f, 0.7985071774721468f},
    {0.9928229727161499f, 0.951174563557721f, 0.3881997977827937f},
    {0.9391868816571929f, 0.7692701675839928f, 0.27742481246233386f},
    {0.548316875925027f, 0.4729191303614051f, 0.04329413737536991f},
    {0.9545505740741005f, 0.6891569768590282f, 0.7202966980692449f},
    {0.6928911850048722f, 0.11147815628446855f, 0.33169731883666187f},
    {0.3605695058946615f, 0.3693286871762177f, 0.5956441232241035f},
    {0.7895147549243743f, 0.30456106042340236f, 0.5762145822120076f},
    {0.4082815946290548f, 0.24903293703144314f, 0.9554405183104087f},
    {0.20039540991523186f, 0.2868661457431748f, 0.540328248931738f},
    {0.7733431523328761f, 0.7226430027522173f, 0.453648356863144f},
    {0.06904106466812865f, 0.2205918215195205f, 0.08030376613559564f},
    {0.9682721476797997f, 0.36624720966293967f, 0.3778375911567785f},
    {0.5456661767094987f, 0.047527969947059656f, 0.9538569948391269f},
    {0.8983193322939071f, 0.788264661901105f, 0.45632030413090996f},
    {0.6148341968408846f, 0.8294204738895378f, 0.7868342393450211f},
    {0.058899857206269224f, 0.27809951904122177f, 0.41421936191397046f},
    {0.2158172786405066f, 0.9742469006145842f, 0.9199901294243631f},
    {0.5278535193014293f, 0.9735944717982561f, 0.9029644438020845f},
    {0.9725820340796999f, 0.2618150251278287f, 0.7324983380981027f},
    {0.7592770731282219f, 0.014388956782075524f, 0.36401304022651326f},
    {0.5961881006604736f, 0.38592902642674254f, 0.9773828046988243f},
    {0.362270940574022f, 0.3687474474421253f, 0.7522900006234681f},
    {0.5828013448632449f, 0.476964047461675f, 0.6880207934345196f},
    {0.38944821331992274f, 0.12935625666223083f, 0.6004478260765861f},
    {0.27100824787992794f, 0.1565906548637187f, 0.969381847927848f},
    {0.6571644165248073f, 0.20123895244426804f, 0.21987127001395412f},
    {0.684700705770048f, 0.9499432880945696f, 0.5027527921428806f},
    {0.5077886346179089f, 0.9136938766011374f, 0.29069921502593166f},
    {0.4501774869679389f, 0.32611786012910826f, 0.40268045018553156f},
    {0.9728807467900019f, 0.9761568783266553f, 0.7136791683870265f},
    {0.9038746307501803f, 0.10459215392028465f, 0.168022797537406f},
    {0.22169300225295685f, 0.3424005454432557f, 0.2740251593186108f},
    {0.7384869436779028f, 0.11496724647203027f, 0.09697692911330114f},
    {0.9683465487016508f, 0.052024522978665f, 0.05869606020085549f},
    {0.5126761751723007f, 0.861910898235425f, 0.3118103960415014f},
    {0.513708570972372f, 0.8667103712617776f, 0.8954052437618532f},
    {0.9727598417269476f, 0.6744929298685616f, 0.04010619376649982f},
    {0.8672834983906217f, 0.8722289133694419f, 0.8510522734456448f},
    {0.02127854015636521f, 0.4195608221107008f, 0.9393944968337431f},
    {0.32189214746515304f, 0.2613022819054607f, 0.40732424773972886f},
    {0.40095630783912195f, 0.593733345046786f, 0.8102344280385185f},
    {0.9434905390037761f, 0.6634437334274544f, 0.4243439356678641f},
    {0.6724195940498516f, 0.8969527500408797f, 0.2544783913353663f},
    {0.7108172276338213f, 0.7435532763341807f, 0.8692190526082834f},
    {0.2857065384038342f, 0.26774680034740206f, 0.3474524238940415f},
    {0.20754880077043447f, 0.1613557272573941f, 0.7983495433499963f},
    {0.02719392628692552f, 0.7648275592829825f, 0.13083456618962697f},
    {0.5546650984899464f, 0.8611833276048723f, 0.9096569630950014f},
    {0.391073134899824f, 0.4376523439089727f, 0.36454553360532715f},
    {0.462896405268719f, 0.4196216025608128f, 0.08868489120837342f},
    {0.4520043673693708f, 0.15494201417058406f, 0.8333051928370644f},
    {0.17166522101179826f, 0.5627555955487188f, 0.6860958905038745f},
    {0.833639181419417f, 0.09692052323371991f, 0.7160641653385211f},
    {0.6183755121276733f, 0.0974321092342958f, 0.616992493104947f},
    {0.05286998430769818f, 0.21922053261281982f, 0.000560123513981936f},
    {0.269957250613186f, 0.8411651458886155f, 0.514345587181679f},
    {0.17821413915117312f, 0.5400008498345563f, 0.7327018617678389f},
    {0.867788873312479f, 0.19077532137692366f, 0.3111264254837235f},
    {0.4295434234106138f, 0.2750367269630849f, 0.9883386113166338f},
    {0.9127195475311467f, 0.8250712916904802f, 0.5782457069677824f},
    {0.9681692369724483f, 0.35777929640949324f, 0.5232546150283155f},
    {0.1530708237874563f, 0.9328153406504729f, 0.863624223699891f},
    {0.08503399070618867f, 0.9650438734098806f, 0.27181852047485455f},
    {0.872920118317223f, 0.19559929844734292f, 0.6174872371482908f},
    {0.748641417526331f, 0.8437393811348414f, 0.9397941074244326f},
    {0.7674952753677518f, 0.00628849624903316f, 0.32906881408135435f},
    {0.5978924116908307f, 0.2777612154968031f, 0.38355460492309745f},
    {0.7571767901573219f, 0.6099020046049759f, 0.2617269097643322f},
    {0.7819225067040203f, 0.29363782491452295f, 0.8354250229138257f},
    {0.43660894542594053f, 0.7292115534961281f, 0.10536184582588148f},
    {0.7572020637654163f, 0.39174088987019395f, 0.2803050797499118f},
    {0.8376815773240565f, 0.044770227057825296f, 0.6894510359101459f},
    {0.8432409148212299f, 0.6009578957333901f, 0.7810795204185094f},
    {0.19286435907592347f, 0.3677244437907855f, 0.23859982348359632f},
    {0.9365731112315406f, 0.24188195110658983f, 0.32974363029220854f},
    {0.4319909782138017f, 0.06815198261433197f, 0.3599123610470141f},
    {0.9475611189493058f, 0.8991479898794591f, 0.29151761004211585f},
    {0.42795825880521976f, 0.07978137519323625f, 0.35416115465182474f},
    {0.7583422760912683f, 0.43964539923748125f, 0.5429472838448264f},
    {0.08519411938218402f, 0.5915208366099094f, 0.29535754169889306f},
    {0.6880261935327553f, 0.9662788461024785f, 0.05952899616540297f},
    {0.05622587791008449f, 0.7202747021530644f, 0.08386735638690479f},
    {0.3487231175185783f, 0.7074693156961995f, 0.9597796157914753f},
    {0.49628003319623815f, 0.6923964459687789f, 0.9410302835342476f},
    {0.4154644267497477f, 0.49256722940885755f, 0.7790522419605542f},
    {0.16583048553885604f, 0.764531750915184f, 0.5654714137495739f},
    {0.4440922743277249f, 0.47408541084009626f, 0.03741253194888572f},
    {0.22351642259482762f, 0.7654294884106637f, 0.06502991948430736f},
    {0.19901803603364943f, 0.9767283740202107f, 0.1791718632610403f},
    {0.31416125775323833f, 0.7992059315273505f, 0.9666960705277584f},
    {0.06278417725192598f, 0.2933377338562787f, 0.8795603865715321f},
    {0.44361278908590296f, 0.5683131892895672f, 0.6331669037738047f},
    {0.29668936363083054f, 0.8550708320053418f, 0.640785090840271f},
    {0.5204274648334831f, 0.8022269298988716f, 0.8788994425079183f},
    {0.889126605494157f, 0.5855882209248682f, 0.4615161952543486f},
    {0.18407977988893243f, 0.7346410705547283f, 0.37713436815835755f},
    {0.6269025462829697f, 0.8910634538730571f, 0.15479555761096586f},
    {0.6814109424178314f, 0.3449022497117299f, 0.6465106875061483f},
    {0.014086756110394894f, 0.10440410676564593f, 0.4869737131457871f},
    {0.1277056257518543f, 0.3623989752907931f, 0.9723796012945737f},
    {0.9538871971831553f, 0.3150063892247622f, 0.23256854026288398f},
    {0.0939842554458572f, 0.15462591855479768f, 0.47836623988388205f},
    {0.6232898374304728f, 0.4014468934963805f, 0.029402140692686873f},
    {0.09863688341034782f, 0.15726965861295605f, 0.49681720868245216f},
    {0.2859239185692978f, 0.6958502225053746f, 0.20561145634160838f},
    {0.7015038105260871f, 0.39365863458696193f, 0.26061981543857193f},
    {0.5801664441723249f, 0.12677807917288386f, 0.6602358805150975f},
    {0.5647637501954654f, 0.24634530676236888f, 0.46165334970192407f},
    {0.29208048428618993f, 0.5157213887026721f, 0.7229234936975482f},
    {0.6640664366580931f, 0.8465931533085073f, 0.7530429283278656f},
    {0.26162542675580913f, 0.2048572946252366f, 0.09342544641922157f},
    {0.6791883091811501f, 0.2020690507231352f, 0.23710391565881428f},
    {0.14962611230515566f, 0.4872573628871394f, 0.6813227587119831f},
    {0.4718246391604852f, 0.22542782220754565f, 0.5711783980025152f},
    {0.4637793446982812f, 0.8407836259400135f, 0.11886809104241891f},
    {0.12736571352093884f, 0.6733114073935552f, 0.907469484451175f},
    {0.2754119029183367f, 0.6883067965317102f, 0.8660984288039323f},
    {0.40310424079368457f, 0.12435736929051855f, 0.14122914252880392f},
    {0.80680030627489f, 0.8362461580050172f, 0.31666217950225806f},
    {0.9358235220154087f, 0.30869154316942504f, 0.7732637415550903f},
    {0.17522442699911334f, 0.7131789563580151f, 0.8816907294629879f},
    {0.6831873730965814f, 0.12441349440258764f, 0.10642118106745391f},
    {0.6837757187964486f, 0.24957773897659596f, 0.8654562256429624f},
    {0.6680303526813819f, 0.5826712485765492f, 0.38093004235111627f},
    {0.24331196445285952f, 0.6297596510340535f, 0.4857962027941348f},
    {0.18686728949353237f, 0.622357806097211f, 0.2588405830654499f},
    {0.6209974076567777f, 0.37359482157213963f, 0.5843685509489168f},
    {0.18681982569681277f, 0.10849436395731049f, 0.9058006175239114f},
    {0.4121379466482422f, 0.21782853717176376f, 0.9939633507077481f},
    {0.3928580870009756f, 0.48740495705989006f, 0.4671033523306334f},
    {0.8716662423579496f, 0.5871196907267433f, 0.9398075098419907f},
    {0.44801859974438696f, 0.5291665915004081f, 0.6224315617261875f},
    {0.37660511332350255f, 0.9366917248758657f, 0.5187983321922437f},
    {0.9934093678548176f, 0.9198478014724011f, 0.12771369588480608f},
    {0.729194506660781f, 0.4125303740236962f, 0.4142255436220056f},
    {0.20358588757887952f, 0.7878369345441051f, 0.1858193912970626f},
    {0.11257246305084556f, 0.933478803366033f, 0.26247600573245644f},
    {0.9259019519338646f, 0.4754737371450982f, 0.28380189420848767f},
    {0.06980185549756612f, 0.37430397674931215f, 0.4125308217363667f},
    {0.8288701350764796f, 0.778592166393146f, 0.4434104305279173f},
    {0.5261978047929078f, 0.05999645535611886f, 0.3675704109494907f},
    {0.10502027620945786f, 0.4801664092165876f, 0.7672107100768779f},
    {0.3006651919281391f, 0.4424193860478439f, 0.8586302969980404f},
    {0.06593133749409574f, 0.3698682197987445f, 0.7025853525632166f},
    {0.47322316639409867f, 0.5908397666246697f, 0.10594214146384295f},
    {0.26504598168694216f, 0.7027965767818171f, 0.5569922113876848f},
    {0.6644531459740433f, 0.5804317215055307f, 0.5418771225417892f},
    {0.28967654656280517f, 0.31661575396819575f, 0.18952865053554335f},
    {0.6257974091937335f, 0.15809617615526061f, 0.2990214665174197f},
    {0.17718962199592825f, 0.555590167855375f, 0.13441849293649966f},
    {0.23189504228131164f, 0.06503648100608483f, 0.5244388986929529f},
    {0.20788766420669658f, 0.6237153093765814f, 0.05298420246654523f},
    {0.785381205682031f, 0.36857983458871524f, 0.4914110519694609f},
    {0.40643777919038326f, 0.5963767736834787f, 0.00858085959659427f},
    {0.753334896556671f, 0.9873053561548208f, 0.7185167978599208f},
    {0.02505228891602096f, 0.6923223697234647f, 0.8920026002702416f},
    {0.1836794145764572f, 0.1310060811951116f, 0.33079770697972966f},
    {0.27040930799576945f, 0.9236126821862948f, 0.9761190211758105f},
    {0.9603937248901541f, 0.08418988806973282f, 0.3997771077500518f},
    {0.7185250705722244f, 0.5847531512709092f, 0.29015824078732366f},
    {0.2849514231346688f, 0.8802287807690388f, 0.05341753028012608f},
    {0.45325891263228846f, 0.7993196958368965f, 0.6199288486583667f},
    {0.06996094144360931f, 0.08469635262603381f, 0.8072926413542062f},
    {0.0263669408897923f, 0.4934038229092421f, 0.33072968263957625f},
    {0.46029805321851003f, 0.3337180945037248f, 0.16669333743218784f},
    {0.46227321146291567f, 0.8434294143130247f, 0.8376166337683797f},
    {0.5534700103758058f, 0.06381071850135378f, 0.9882080365335097f},
    {0.3920991618926417f, 0.8885627810875872f, 0.5918480880814744f},
    {0.7137279077485209f, 0.5651604366466944f, 0.3464735603192256f},
    {0.6242803719263968f, 0.2789389615219128f, 0.7512671242260929f},
    {0.5244859149038945f, 0.6316825065880994f, 0.35638219707005503f},
    {0.6772007590392948f, 0.6295504531818044f, 0.7529713607104043f},
    {0.02065332883055604f, 0.2845663049737337f, 0.929617199886889f},
    {0.41844521091341425f, 0.6459048562524399f, 0.5962430041152617f},
    {0.4300823086159393f, 0.6215718867186082f, 0.3172406080312351f},
    {0.932807197541381f, 0.6809929015018877f, 0.09166502998512494f},
    {0.8965435933993775f, 0.48043492790136455f, 0.4379254378402164f},
    {0.0208581565001138f, 0.9735428674106723f, 0.06683281678553443f},
    {0.8894410951086134f, 0.47810624723838013f, 0.42174345443348016f},
    {0.7194150341217596f, 0.9537336330232278f, 0.029072491805518852f},
    {0.39800514095310824f, 0.2872726205137902f, 0.5568302164263981f},
    {0.7071085836795179f, 0.6882420360894265f, 0.6122164369858929f},
    {0.8169878596976795f, 0.2034202808445229f, 0.86581737087317f},
    {0.5849599644035517f, 0.0819922881721411f, 0.101249991897856f},
    {0.8447225814287157f, 0.5553205943761592f, 0.8470228980496168f},
    {0.47353127984710797f, 0.15043108562139917f, 0.8236607897096068f},
    {0.04181616325247217f, 0.5526954370126769f, 0.6633236989924025f},
    {0.6588893146114572f, 0.42454275413502407f, 0.6709799886925456f},
    {0.5161637655114611f, 0.33198935602066326f, 0.20176800853043741f},
    {0.7362280397963125f, 0.17789392409236526f, 0.5533618236254038f},
    {0.4563859952616547f, 0.7509560298329726f, 0.2052471916262999f},
    {0.059210750924782896f, 0.7164490056317251f, 0.3169515422050845f},
    {0.11764750011873704f, 0.6329851079233813f, 0.09949231883071663f},
    {0.32234248349900885f, 0.8378999419932465f, 0.004675356150574794f},
    {0.9527035991007575f, 0.14927946135621128f, 0.3461159989005077f},
    {0.6193947770291519f, 0.38364680298764864f, 0.6232226958471877f},
    {0.24097099661386634f, 0.27783781294193455f, 0.426771751495128f},
    {0.2629516665386259f, 0.36189899324104247f, 0.8225013680325828f},
    {0.6068380688275743f, 0.8804386351993645f, 0.8855014595350699f},
    {0.318412826610171f, 0.029624896792786903f, 0.8768233598875409f},
    {0.005355721499725297f, 0.08069963580286132f, 0.8784450848462262f},
    {0.07371810862206907f, 0.9925188253343673f, 0.0661156516385244f},
    {0.6517957788466457f, 0.5937759058188342f, 0.029106332568377358f},
    {0.47013377785015864f, 0.9858732592357289f, 0.10428322077313057f},
    {0.7889461505643621f, 0.8623387633879269f, 0.7087311075056221f},
    {0.0421871468174132f, 0.2628764589748187f, 0.8772883317271564f},
    {0.7702701396326838f, 0.5499659033124191f, 0.1597785869301137f},
    {0.2726750730786808f, 0.3287882164677923f, 0.2602060628232712f},
    {0.6218761688078188f, 0.5032988970963724f, 0.8338567844246034f},
    {0.5186137766510739f, 0.46271204241028696f, 0.5392020847224906f},
    {0.29058847257006415f, 0.7971005381120051f, 0.7401632224244179f},
    {0.8433157585070995f, 0.26410005390791624f, 0.8038962833867737f},
    {0.9246293008550606f, 0.9888345450126684f, 0.5114767666215767f},
    {0.5709204515837164f, 0.12021473380187575f, 0.377813938379171f},
    {0.6218333806437805f, 0.19735317508603023f, 0.16157020195762772f},
    {0.9085029946783848f, 0.6109819389328578f, 0.2545398418484721f},
    {0.3499061485226511f, 0.9507830180506354f, 0.5071771726631731f},
    {0.17862261070020902f, 0.7883108850645948f, 0.9989155333842067f},
    {0.7163075693078048f, 0.04936810475718134f, 0.04407976823885362f},
    {0.46219195760832443f, 0.8680846962327305f, 0.25080605420168556f},
    {0.7313604854460488f, 0.7078945294948542f, 0.8695331452048242f},
    {0.16253897625814218f, 0.7388664589639774f, 0.13240979052382984f},
    {0.18087653920097702f, 0.848000214122678f, 0.18510666587970082f},
    {0.08704891756529376f, 0.9781393271370848f, 0.21794651382467212f},
    {0.3018900964227913f, 0.6047792414003637f, 0.6115905363402703f},
    {0.1448671969149582f, 0.5416153221512973f, 0.42454751111246647f},
    {0.9034237434777291f, 0.09487992710116977f, 0.6399067952654474f},
    {0.8540722321754748f, 0.1668385393563505f, 0.5183341583248886f},
    {0.6226695550791506f, 0.11549202563884375f, 0.3342814253182186f},
    {0.3899198144652679f, 0.22381253436991366f, 0.07072015668436771f},
    {0.6313565444033213f, 0.3149949709676193f, 0.2612100176169343f},
    {0.4024959144537398f, 0.5881451068846154f, 0.539062671816511f},
    {0.26297945085530017f, 0.8459440650753134f, 0.158580493027228f},
    {0.6787939468992292f, 0.9045131512349908f, 0.7603932471403285f},
    {0.5131659377976635f, 0.8300163941213364f, 0.4331885304084724f},
    {0.25402038279418127f, 0.867323599189032f, 0.5124636486402199f},
    {0.04025388062668023f, 0.13481604081833698f, 0.5175488593567314f},
    {0.8494367736714729f, 0.06168943030556129f, 0.14342707713803415f},
    {0.8879117794382219f, 0.4606618314320351f, 0.18156151719514224f},
    {0.45884123363006046f, 0.4866146512851497f, 0.15298538795301453f},
    {0.3282474732814412f, 0.11826901786861543f, 0.5855531883755045f},
    {0.02544871870863219f, 0.02414872876609253f, 0.002672569682868553f},
    {0.4677619549232128f, 0.9867113952023207f, 0.7550543599038011f},
    {0.7354610856575171f, 0.9686362022745669f, 0.7268212409095072f},
    {0.7025397451142965f, 0.6456768515657991f, 0.8471642058085781f},
    {0.9072254182696031f, 0.6031989792240773f, 0.24492531680539464f},
    {0.6594761613090995f, 0.1569027282757448f, 0.04732997744209777f},
    {0.9749913774999789f, 0.7427274801124912f, 0.36334272765521114f},
    {0.8036885745839282f, 0.0011786842609355919f, 0.3911035605061626f},
    {0.26185599354897726f, 0.17082935270664024f, 0.7989131517711284f},
    {0.6846874624239547f, 0.0906206130296856f, 0.08948222604255984f},
    {0.12403602456100937f, 0.4205637219747159f, 0.9458807788738965f},
    {0.07442171018801313f, 0.8039012369788441f, 0.774485647738606f},
    {0.28861798258079097f, 0.2208913585389075f, 0.9777246356563508f},
    {0.8977390048867073f, 0.3338606063348555f, 0.858431568877721f},
    {0.36949847510866995f, 0.17265423622987264f, 0.4200460731852471f},
    {0.3887380242564358f, 0.274722036736616f, 0.07161251193051066f},
    {0.8083904334570559f, 0.7105629157560053f, 0.312867061801953f},
    {0.8017228288596978f, 0.5306884971300633f, 0.4670076905033399f},
    {0.008645051313901142f, 0.6387117594729064f, 0.8665572341359664f},
    {0.2162694813153101f, 0.24379183708683394f, 0.7347833870560396f},
    {0.2634000146396984f, 0.4796233758748394f, 0.1755388152383992f},
    {0.5444613274136463f, 0.6787243728208051f, 0.6879362800338914f},
    {0.3299316186177882f, 0.40259044013049794f, 0.2236542004287665f},
    {0.2935084345041775f, 0.28732864326543084f, 0.8607010933967236f},
    {0.6377242334473556f, 0.536769122000007f, 0.6335053530891048f},
    {0.7389311691356754f, 0.6923107457067667f, 0.013768298293737713f},
    {0.9342944918099357f, 0.9124459011549362f, 0.9070210765215889f},
    {0.9096953132577421f, 0.9431481876511436f, 0.9922967642257479f},
    {0.94848878844267f, 0.9103624800725338f, 0.957687489817607f},
    {0.900402029138181f, 0.9256471694752894f, 0.9395652123494485f},
    {0.9325773139953436f, 0.9227227547730806f, 0.9736984555487846f},
    {0.9577798633394072f, 0.9680469633206392f, 0.9776630995120205f},
    {0.9001814605427002f, 0.9716523469206725f, 0.9883044939647934f},
    {0.9923189736279715f, 0.9256880160237221f, 0.9283943741912916f},
    {0.9649199490868416f, 0.939208799635382f, 0.9873107950684902f},
    {0.9208149801126012f, 0.9272112621771944f, 0.9579692094737817f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 25: collinear", "[votess]") {

  const int k = 127;
  std::vector<std::array<float, 3>> xyzset = {
    {0.01f, 0.5f, 0.5f},
    {0.017716535433070866f, 0.5f, 0.5f},
    {0.02543307086614173f, 0.5f, 0.5f},
    {0.0331496062992126f, 0.5f, 0.5f},
    {0.040866141732283465f, 0.5f, 0.5f},
    {0.04858267716535433f, 0.5f, 0.5f},
    {0.05629921259842519f, 0.5f, 0.5f},
    {0.06401574803149605f, 0.5f, 0.5f},
    {0.07173228346456692f, 0.5f, 0.5f},
    {0.07944881889763779f, 0.5f, 0.5f},
    {0.08716535433070866f, 0.5f, 0.5f},
    {0.09488188976377952f, 0.5f, 0.5f},
    {0.10259842519685038f, 0.5f, 0.5f},
    {0.11031496062992124f, 0.5f, 0.5f},
    {0.11803149606299211f, 0.5f, 0.5f},
    {0.12574803149606298f, 0.5f, 0.5f},
    {0.13346456692913386f, 0.5f, 0.5f},
    {0.1411811023622047f, 0.5f, 0.5f},
    {0.1488976377952756f, 0.5f, 0.5f},
    {0.15661417322834645f, 0.5f, 0.5f},
    {0.16433070866141733f, 0.5f, 0.5f},
    {0.17204724409448818f, 0.5f, 0.5f},
    {0.17976377952755906f, 0.5f, 0.5f},
    {0.18748031496062992f, 0.5f, 0.5f},
    {0.19519685039370077f, 0.5f, 0.5f},
    {0.20291338582677165f, 0.5f, 0.5f},
    {0.2106299212598425f, 0.5f, 0.5f},
    {0.2183464566929134f, 0.5f, 0.5f},
    {0.22606299212598424f, 0.5f, 0.5f},
    {0.23377952755905512f, 0.5f, 0.5f},
    {0.24149606299212598f, 0.5f, 0.5f},
    {0.24921259842519686f, 0.5f, 0.5f},
    {0.2569291338582677f, 0.5f, 0.5f},
    {0.2646456692913386f, 0.5f, 0.5f},
    {0.2723622047244094f, 0.5f, 0.5f},
    {0.2800787401574803f, 0.5f, 0.5f},
    {0.2877952755905512f, 0.5f, 0.5f},
    {0.29551181102362206f, 0.5f, 0.5f},
    {0.3032283464566929f, 0.5f, 0.5f},
    {0.31094488188976377f, 0.5f, 0.5f},
    {0.31866141732283465f, 0.5f, 0.5f},
    {0.3263779527559055f, 0.5f, 0.5f},
    {0.33409448818897636f, 0.5f, 0.5f},
    {0.34181102362204724f, 0.5f, 0.5f},
    {0.3495275590551181f, 0.5f, 0.5f},
    {0.35724409448818895f, 0.5f, 0.5f},
    {0.3649606299212598f, 0.5f, 0.5f},
    {0.3726771653543307f, 0.5f, 0.5f},
    {0.38039370078740153f, 0.5f, 0.5f},
    {0.3881102362204724f, 0.5f, 0.5f},
    {0.3958267716535433f, 0.5f, 0.5f},
    {0.4035433070866142f, 0.5f, 0.5f},
    {0.411259842519685f, 0.5f, 0.5f},
    {0.4189763779527559f, 0.5f, 0.5f},
    {0.42669291338582677f, 0.5f, 0.5f},
    {0.43440944881889765f, 0.5f, 0.5f},
    {0.4421259842519685f, 0.5f, 0.5f},
    {0.44984251968503935f, 0.5f, 0.5f},
    {0.45755905511811024f, 0.5f, 0.5f},
    {0.46527559055118106f, 0.5f, 0.5f},
    {0.47299212598425194f, 0.5f, 0.5f},
    {0.4807086614173228f, 0.5f, 0.5f},
    {0.4884251968503937f, 0.5f, 0.5f},
    {0.49614173228346453f, 0.5f, 0.5f},
    {0.5038582677165354f, 0.5f, 0.5f},
    {0.5115748031496062f, 0.5f, 0.5f},
    {0.5192913385826772f, 0.5f, 0.5f},
    {0.527007874015748f, 0.5f, 0.5f},
    {0.5347244094488188f, 0.5f, 0.5f},
    {0.5424409448818898f, 0.5f, 0.5f},
    {0.5501574803149606f, 0.5f, 0.5f},
    {0.5578740157480315f, 0.5f, 0.5f},
    {0.5655905511811024f, 0.5f, 0.5f},
    {0.5733070866141732f, 0.5f, 0.5f},
    {0.5810236220472441f, 0.5f, 0.5f},
    {0.5887401574803149f, 0.5f, 0.5f},
    {0.5964566929133858f, 0.5f, 0.5f},
    {0.6041732283464567f, 0.5f, 0.5f},
    {0.6118897637795275f, 0.5f, 0.5f},
    {0.6196062992125984f, 0.5f, 0.5f},
    {0.6273228346456693f, 0.5f, 0.5f},
    {0.6350393700787401f, 0.5f, 0.5f},
    {0.6427559055118109f, 0.5f, 0.5f},
    {0.6504724409448819f, 0.5f, 0.5f},
    {0.6581889763779527f, 0.5f, 0.5f},
    {0.6659055118110236f, 0.5f, 0.5f},
    {0.6736220472440945f, 0.5f, 0.5f},
    {0.6813385826771653f, 0.5f, 0.5f},
    {0.6890551181102362f, 0.5f, 0.5f},
    {0.6967716535433071f, 0.5f, 0.5f},
    {0.7044881889763779f, 0.5f, 0.5f},
    {0.7122047244094488f, 0.5f, 0.5f},
    {0.7199212598425196f, 0.5f, 0.5f},
    {0.7276377952755905f, 0.5f, 0.5f},
    {0.7353543307086614f, 0.5f, 0.5f},
    {0.7430708661417322f, 0.5f, 0.5f},
    {0.7507874015748031f, 0.5f, 0.5f},
    {0.758503937007874f, 0.5f, 0.5f},
    {0.7662204724409448f, 0.5f, 0.5f},
    {0.7739370078740158f, 0.5f, 0.5f},
    {0.7816535433070866f, 0.5f, 0.5f},
    {0.7893700787401574f, 0.5f, 0.5f},
    {0.7970866141732283f, 0.5f, 0.5f},
    {0.8048031496062992f, 0.5f, 0.5f},
    {0.81251968503937f, 0.5f, 0.5f},
    {0.8202362204724409f, 0.5f, 0.5f},
    {0.8279527559055118f, 0.5f, 0.5f},
    {0.8356692913385826f, 0.5f, 0.5f},
    {0.8433858267716535f, 0.5f, 0.5f},
    {0.8511023622047243f, 0.5f, 0.5f},
    {0.8588188976377953f, 0.5f, 0.5f},
    {0.8665354330708661f, 0.5f, 0.5f},
    {0.8742519685039369f, 0.5f, 0.5f},
    {0.8819685039370079f, 0.5f, 0.5f},
    {0.8896850393700787f, 0.5f, 0.5f},
    {0.8974015748031495f, 0.5f, 0.5f},
    {0.9051181102362205f, 0.5f, 0.5f},
    {0.9128346456692913f, 0.5f, 0.5f},
    {0.9205511811023621f, 0.5f, 0.5f},
    {0.928267716535433f, 0.5f, 0.5f},
    {0.9359842519685039f, 0.5f, 0.5f},
    {0.9437007874015747f, 0.5f, 0.5f},
    {0.9514173228346456f, 0.5f, 0.5f},
    {0.9591338582677165f, 0.5f, 0.5f},
    {0.9668503937007874f, 0.5f, 0.5f},
    {0.9745669291338582f, 0.5f, 0.5f},
    {0.982283464566929f, 0.5f, 0.5f},
    {0.99f, 0.5f, 0.5f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 26: concentric", "[votess]") {

  const int k = 99;
  std::vector<std::array<float, 3>> xyzset = {
    {0.5984409404802339f, 0.5013661327633756f, 0.4824638967087929f},
    {0.542122713305147f, 0.5902115020381857f, 0.5093574528492963f},
    {0.46403028216265113f, 0.5905722266758404f, 0.47757565711817407f},
    {0.4408130926023063f, 0.43498346299125834f, 0.4523580026857841f},
    {0.5467900927632697f, 0.5021089432991839f, 0.4116470737475807f},
    {0.5733143490247317f, 0.5361240042307965f, 0.44238001609325783f},
    {0.565974217747145f, 0.4925762428765965f, 0.5747816182148061f},
    {0.5099747740585249f, 0.40070287495584805f, 0.4936293767614594f},
    {0.5142795971674017f, 0.4063033305746625f, 0.46810913542508203f},
    {0.5684751031069774f, 0.5712730183706514f, 0.4847908873754707f},
    {0.5478960339540009f, 0.4719965044749495f, 0.5831972004928992f},
    {0.46576881021374084f, 0.4823278326327702f, 0.4077182567006793f},
    {0.46160673016200654f, 0.4387196862480832f, 0.4309298908527454f},
    {0.49741444659108836f, 0.5755870660816664f, 0.5654210237976712f},
    {0.41149857358374803f, 0.47649467857213856f, 0.5401870300826231f},
    {0.5737937759213406f, 0.5660150386426842f, 0.5140176070809495f},
    {0.5307287752197467f, 0.5413760998412682f, 0.5856957451418662f},
    {0.5066085219340362f, 0.40463196367654153f, 0.5293473182020926f},
    {0.5452613456933939f, 0.4706856746836489f, 0.41578550648926144f},
    {0.45796180314382023f, 0.5748709659874531f, 0.44874447876387635f},
    {0.4617376349004878f, 0.550231854800708f, 0.42245806179703643f},
    {0.5936435905217557f, 0.4659571920295555f, 0.4915167706808563f},
    {0.4522692596480685f, 0.5731002611884735f, 0.451233943776091f},
    {0.5292880668597665f, 0.42706491700833027f, 0.43817215183579405f},
    {0.5762289519726816f, 0.5331223374164455f, 0.44439372656599146f},
    {0.5982554914871405f, 0.512339088748062f, 0.486085788506426f},
    {0.4657233644710883f, 0.47647825060786875f, 0.590949653997978f},
    {0.462272050465893f, 0.574897297660431f, 0.4455298556352503f},
    {0.49941446681172114f, 0.4172607664834153f, 0.44384061620732035f},
    {0.43394416892435833f, 0.5665200722857792f, 0.46519041563016f},
    {0.5541975999494624f, 0.4793923342189737f, 0.5814735802010416f},
    {0.5679685662403099f, 0.429058356873236f, 0.4813571119803966f},
    {0.5599360878235242f, 0.4232496792417297f, 0.47726118648844185f},
    {0.5027707110279713f, 0.40047838191175333f, 0.4906313985303751f},
    {0.519863953560939f, 0.438198339513573f, 0.42393438286552015f},
    {0.5141505172518195f, 0.4782866824369547f, 0.5965830973924129f},
    {0.5200754880730685f, 0.40220753853974267f, 0.4942026505908156f},
    {0.5274542083761506f, 0.5514756563378038f, 0.5812189832922773f},
    {0.5999154733205461f, 0.5037925492410421f, 0.49841420008023823f},
    {0.5970429862076672f, 0.48621776907423314f, 0.4801831148106631f},
    {0.5589598953189202f, 0.5232329750451551f, 0.5773560573874675f},
    {0.5006611640606583f, 0.4686855925779934f, 0.5949682618030544f},
    {0.4772974716792012f, 0.4816304971988327f, 0.5956407683714494f},
    {0.5475025928617316f, 0.4495278277944861f, 0.42791627434524826f},
    {0.5060726612708467f, 0.5111335734234309f, 0.5991925719392064f},
    {0.5872899922922751f, 0.5379921956446644f, 0.4693887224096722f},
    {0.5090097526066063f, 0.4940739840875451f, 0.4005831669516018f},
    {0.43897109329249645f, 0.4850363338584859f, 0.4222082186751574f},
    {0.44855240031847f, 0.4256341773276848f, 0.457304931136268f},
    {0.4408274442405208f, 0.51946832811568f, 0.4217721734593658f},
    {0.42120401868147733f, 0.5137961184297356f, 0.5600071699409641f},
    {0.42401045802813214f, 0.44475319882555525f, 0.5342546415963897f},
    {0.5819749536348684f, 0.5487598381471767f, 0.5300430551113285f},
    {0.5238535479738974f, 0.45741096752988064f, 0.5872764719859602f},
    {0.4993525623610494f, 0.4008952544963078f, 0.5133353006397335f},
    {0.46158168834106306f, 0.4078545347076062f, 0.4942340174016009f},
    {0.4665805146651245f, 0.5470351042089923f, 0.4183248080993912f},
    {0.5009740035800738f, 0.4276837395681754f, 0.4309390863499293f},
    {0.4081997335770796f, 0.4638691843839463f, 0.5163485549086018f},
    {0.42178647502323385f, 0.5327135024621349f, 0.44696726230554684f},
    {0.5871092889490901f, 0.4588718587881403f, 0.5268411583066244f},
    {0.43614254508002737f, 0.571253415221707f, 0.4709280845077817f},
    {0.40065180406328527f, 0.4887754289691797f, 0.4980138053231861f},
    {0.45457956651583925f, 0.4120167605934162f, 0.5139976357158874f},
    {0.5413650844355286f, 0.40911989042899094f, 0.4945469757012293f},
    {0.4164018263346061f, 0.4787518679843737f, 0.5505950812397525f},
    {0.47373914250262084f, 0.5872926075657654f, 0.5411140855166647f},
    {0.5669454975513983f, 0.4785139695976988f, 0.42888986812593366f},
    {0.5609518259737141f, 0.42480396464562314f, 0.47489161141264974f},
    {0.556891769367539f, 0.5345762749902326f, 0.5746177444448072f},
    {0.5703261413042544f, 0.504253293811137f, 0.4290342100656226f},
    {0.5209560555107047f, 0.47433618236231134f, 0.40564846476240185f},
    {0.5457794661093394f, 0.4271083307204728f, 0.44909769128627f},
    {0.5545231745134349f, 0.45329016094143504f, 0.43039098926072517f},
    {0.4896754284849464f, 0.5959511767215421f, 0.5262063906095812f},
    {0.4555424903034521f, 0.577482630342324f, 0.4550559033151615f},
    {0.40533652997048625f, 0.490533851556454f, 0.4691905943644461f},
    {0.4001259786173504f, 0.49833075869627635f, 0.49526782435575406f},
    {0.5443058216576329f, 0.4194798681130227f, 0.4605855035786855f},
    {0.5247357374835205f, 0.5965491891003587f, 0.4918515415439769f},
    {0.4357918428521689f, 0.4234942923700616f, 0.4950817426133026f},
    {0.4476811084077278f, 0.4556232189142962f, 0.572755995512587f},
    {0.4466942611801287f, 0.46452528079413474f, 0.576811734169544f},
    {0.4590005412129896f, 0.5469542275661194f, 0.42180572340099753f},
    {0.4780978452695402f, 0.5604549978809498f, 0.5765864795468323f},
    {0.5686497887103861f, 0.433496574066495f, 0.47059760470427353f},
    {0.47984775310481625f, 0.5972995137716544f, 0.48874426524498693f},
    {0.5388121178872103f, 0.4362889041494745f, 0.43340784002125743f},
    {0.5551472065164729f, 0.41705478068980695f, 0.4911187722124997f},
    {0.412669596508113f, 0.5483843386637536f, 0.4943117315450645f},
    {0.5174216894911728f, 0.5605271997214468f, 0.42232797910989284f},
    {0.4525026549986926f, 0.41816782454612944f, 0.5323650626187207f},
    {0.5531353167924412f, 0.4327098763110521f, 0.5514653025182308f},
    {0.43755982922883374f, 0.5759958817900388f, 0.48194865586661095f},
    {0.5937175580103167f, 0.4945840093601059f, 0.4655371741441374f},
    {0.4089174577286989f, 0.46345410398342524f, 0.48080708522026006f},
    {0.4808763301617782f, 0.5459566784177928f, 0.4132689850127288f},
    {0.5344771378107549f, 0.49318997739770276f, 0.5936213146699747f},
    {0.5799238428411022f, 0.5056088927304029f, 0.44016088513480817f},
    {0.4586323160643522f, 0.5576065768666658f, 0.4295003756924531f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

///////////////////////////////////////////////////////////////////////////////
/// Internal Functions                                                      ///
///////////////////////////////////////////////////////////////////////////////

#include <iostream>
class __internal__suppress_stdout {
  public:
    __internal__suppress_stdout() : buf(std::cout.rdbuf()) {
      std::cout.rdbuf(__tmp__buf.rdbuf());
    }
    ~__internal__suppress_stdout() {
      std::cout.rdbuf(buf);
    }
  private:
    std::streambuf* buf;
    std::stringstream __tmp__buf;
};

#include <voro++.hh>
template <typename T>
static std::pair<std::vector<std::array<T, 3>>, std::vector<std::vector<int>>>
run_voro(
  const std::vector<std::array<T,3>>& xyzset,
  const struct votess::vtargs vtargs
) {
  std::vector<std::array<T, 3>> coords;
  std::vector<std::vector<int>> neighbor_list;
  const double tolerance = 1e-8;

  using namespace voro;
  container con(
    0, 1, 0, 1, 0, 1,
    vtargs.xyzset.grid_resolution,
    vtargs.xyzset.grid_resolution,
    vtargs.xyzset.grid_resolution,
    false, false, false,
    xyzset.size()
  );
  
  for (size_t i = 0; i < xyzset.size(); i++) {
    con.put(i,xyzset[i][0],xyzset[i][1], xyzset[i][2]);
  }

  c_loop_all cl(con);
  voronoicell_neighbor c;
  if (cl.start()) do if (con.compute_cell(c, cl)) {
    std::vector<int> neighbors;
    std::vector<int> filtered_neighbors;
    std::vector<double> face_areas;
    double x, y, z;

    cl.pos(x, y, z);
    c.neighbors(neighbors);
    c.face_areas(face_areas);

    for (size_t i = 0; i < face_areas.size(); i++) {
      if (face_areas[i] >= tolerance) {
        filtered_neighbors.push_back(neighbors[i]);
      }
    }

    neighbor_list.push_back(filtered_neighbors);
    coords.push_back({
      static_cast<T>(x),
      static_cast<T>(y),
      static_cast<T>(z)
    });

  } while(cl.inc());

  return {coords, neighbor_list};
}

template <typename T>
static void run_test(
  std::vector<std::array<T,3>>& xyzset,
  struct votess::vtargs vtargs,
  const enum votess::device device
) {
    __internal__suppress_stdout s; // to preventstdout 

    (void)xyzset::sort<int,T>(xyzset, vtargs.xyzset);

    auto [vcoord, vneighbor] = run_voro<T>(xyzset, vtargs);
    auto dnn = votess::tesellate<int, T>(xyzset, vtargs, device);

    std::vector<int> test_dnn(0);
    std::vector<int> test_vneighbor(0);

    for (size_t i = 0; i < xyzset.size(); i++) {
        auto it = std::find_if(
            vcoord.begin(),
            vcoord.end(),
            [&](const std::array<T, 3>& elem) {
                return (elem[0] == xyzset[i][0]) &&
                       (elem[1] == xyzset[i][1]) &&
                       (elem[2] == xyzset[i][2]);
            });

        if (it == vcoord.end()) {
            CAPTURE(i);
            WARN("Matching coordinate not found in vcoord");
            continue;
        }

        const size_t index = std::distance(vcoord.begin(), it);
        CAPTURE(index);

        test_dnn.clear();
        test_vneighbor.clear();
        for (const auto& j : vneighbor[index]) {
            if (j < 0) continue;
            test_vneighbor.push_back(j);
        }
        for (size_t j = 0; j < dnn[i].size(); j++) {
            test_dnn.push_back(dnn[i][j]);
        }

        std::sort(test_vneighbor.begin(), test_vneighbor.end());
        std::sort(test_dnn.begin(), test_dnn.end());

        CAPTURE(test_vneighbor, test_dnn);

        bool cond = std::includes(
          test_dnn.begin(),
          test_dnn.end(),
          test_vneighbor.begin(),
          test_vneighbor.end()
        );
        CAPTURE(cond);
        REQUIRE(cond);
    }
}

template <typename T>
static void test_votess(
  std::vector<std::array<T,3>>& xyzset,
  const int k,
  const int gr
) {
  SECTION("(CPU) case : grid_resolution = " + std::to_string(gr)) {
    struct votess::vtargs vtargs(k,gr);
    run_test(xyzset, vtargs, votess::device::cpu);
  }
  SECTION("(GPU) case : grid_resolution = " + std::to_string(gr)) {
    struct votess::vtargs vtargs(k,gr);
    run_test(xyzset, vtargs, votess::device::gpu);
  }
}

///////////////////////////////////////////////////////////////////////////////
/// End                                                                     ///
///////////////////////////////////////////////////////////////////////////////