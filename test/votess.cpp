#include <catch2/catch_test_macros.hpp>
#include <catch2/matchers/catch_matchers_floating_point.hpp>

#include <votess.hpp>

///////////////////////////////////////////////////////////////////////////////
/// Forward Declarations                                                    ///
///////////////////////////////////////////////////////////////////////////////

template <typename T>
static void test_votess(
  std::vector<std::array<T,3>>& xyzset,
  const int k,
  const int gr
);

///////////////////////////////////////////////////////////////////////////////
/// Test Cases                                                              ///
///////////////////////////////////////////////////////////////////////////////

TEST_CASE("votess regression 0: standard", "[votess]") {

  const int k = 9;
  std::vector<std::array<float, 3>> xyzset = {
    {0.605223f, 0.108484f, 0.090937f},
    {0.500792f, 0.499641f, 0.464576f},
    {0.437936f, 0.786332f, 0.160392f},
    {0.663354f, 0.170894f, 0.810284f},
    {0.614869f, 0.096867f, 0.204147f},
    {0.556911f, 0.895342f, 0.802266f},
    {0.305748f, 0.124146f, 0.516249f},
    {0.406888f, 0.157835f, 0.919622f},
    {0.094412f, 0.861991f, 0.798644f},
    {0.511958f, 0.560537f, 0.345479f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 1: random", "[votess]") {

  const int k = 127;
  std::vector<std::array<float, 3>> xyzset = {
    {0.9120054846996283f, 0.479952832220083f, 0.8974020611713348f},
    {0.9798179104155431f, 0.42141401438492276f, 0.23986355938599324f},
    {0.0261098827469175f, 0.6039952872416935f, 0.46481442588879307f},
    {0.9013998673740098f, 0.8998801326698703f, 0.9578318831263676f},
    {0.009311193626002856f, 0.4148378933316965f, 0.5501872113781201f},
    {0.23530800263459928f, 0.19813962760922643f, 0.30265763247466326f},
    {0.6890618846529917f, 0.5606760187491184f, 0.4813457805457909f},
    {0.15551064039023355f, 0.023862512975364236f, 0.46203654300660346f},
    {0.3566564932700922f, 0.10382296439703043f, 0.9632058697454648f},
    {0.1301619987349164f, 0.4150846450116893f, 0.7931942480781112f},
    {0.6756234381125776f, 0.22639274228709905f, 0.6033428679159086f},
    {0.4564000367880723f, 0.859004893916502f, 0.5735710824311264f},
    {0.30941505418783766f, 0.3872286270917802f, 0.804737511873488f},
    {0.6389643803533612f, 0.45643626017721106f, 0.6624027007549899f},
    {0.3169499387392096f, 0.3746386894729439f, 0.5535346436199584f},
    {0.5605061834105247f, 0.12880519075983965f, 0.2579199162568616f},
    {0.3795064245424584f, 0.32105994563025375f, 0.10720134848041063f},
    {0.9056481845278124f, 0.5843909827953996f, 0.0926790821687542f},
    {0.6624370655622386f, 0.5501215054354357f, 0.7396196130950411f},
    {0.32672568317767625f, 0.36053096217607017f, 0.8727258988246653f},
    {0.5184054058886572f, 0.5427288776287406f, 0.7607638822347352f},
    {0.7274254565389494f, 0.6915041634315944f, 0.13725229454147625f},
    {0.0073735164586912205f, 0.6088676119057479f, 0.09312733349988467f},
    {0.7540199564881989f, 0.5734270657881022f, 0.7448433357506199f},
    {0.5820386726460507f, 0.43536409096584217f, 0.5794475442212061f},
    {0.37202482611344834f, 0.44015076963756605f, 0.7634589218455795f},
    {0.6476702210051822f, 0.8407544972391334f, 0.6531017879624882f},
    {0.5652390154042555f, 0.41542635489852475f, 0.2613504415825022f},
    {0.7557112676638404f, 0.6165604576377474f, 0.8460419781684989f},
    {0.530664671705094f, 0.028312128349250454f, 0.6709034472729933f},
    {0.23036240824146403f, 0.8147891762069873f, 0.4084006929803581f},
    {0.2188424913189172f, 0.7517384744599667f, 0.5134799385629223f},
    {0.5022171150595148f, 0.0765106135838085f, 0.25213862210451077f},
    {0.5860421366948698f, 0.13265585658899326f, 0.9968949467202436f},
    {0.8819543726964724f, 0.5926791292938703f, 0.6409447058268184f},
    {0.5027629268750602f, 0.7006443956855158f, 0.3392444700652242f},
    {0.12674862157486688f, 0.797514033090905f, 0.10098359558454761f},
    {0.9470073332080411f, 0.8485807259099605f, 0.37611901212399523f},
    {0.07279148120746914f, 0.01814605129279445f, 0.026044232005953072f},
    {0.6732967532286288f, 0.59600405533338f, 0.4447763873790582f},
    {0.26465080344983716f, 0.07873807633108199f, 0.48440394609012294f},
    {0.4121477933911797f, 0.7358118706140123f, 0.7495508492991594f},
    {0.38895079162844304f, 0.7814893652565481f, 0.9029936449301257f},
    {0.6691423925806743f, 0.14314287371757317f, 0.2743422288544358f},
    {0.4422453838630539f, 0.6819928161257423f, 0.2473588116401393f},
    {0.8036435202843345f, 0.8733942550170674f, 0.9947769243034092f},
    {0.1260597764491188f, 0.7605512193208978f, 0.614850079792633f},
    {0.22845086999459407f, 0.14421047363037964f, 0.26861546421528104f},
    {0.23511002994596197f, 0.06755778633463727f, 0.3568066934057703f},
    {0.7199229509842319f, 0.12820759402922433f, 0.6747003920745771f},
    {0.45634640007905825f, 0.5739907649793644f, 0.08788314370797079f},
    {0.7830977878644926f, 0.5350490808418203f, 0.5942053499892592f},
    {0.3503973616354479f, 0.7742078955193435f, 0.22166398163234924f},
    {0.870101987676456f, 0.32236517006381626f, 0.7510060909278012f},
    {0.8199988218165453f, 0.9255545749220515f, 0.09357197076947643f},
    {0.14288993486377255f, 0.4142363991118153f, 0.7107069005324901f},
    {0.5176784353881326f, 0.16635652751672103f, 0.2833595067828907f},
    {0.6222502700779575f, 0.9190376283884486f, 0.10414694981295425f},
    {0.9438009490194423f, 0.5336892213176333f, 0.7565100800826334f},
    {0.3337963805727294f, 0.02788143327849535f, 0.4411502589165349f},
    {0.3836941463445279f, 0.5610922870607046f, 0.8507830639557744f},
    {0.5464854798471017f, 0.31595095980055754f, 0.21133922206002353f},
    {0.8890216842695249f, 0.2007348167418771f, 0.41289032843593554f},
    {0.9061556776935398f, 0.3042892535942755f, 0.3032600111036535f},
    {0.210289925622535f, 0.3855201745810558f, 0.4103786204473193f},
    {0.34431810552348074f, 0.7667959712669192f, 0.07425854480602079f},
    {0.4373252145144012f, 0.7978162293579825f, 0.16619312193300673f},
    {0.787427789229268f, 0.9006140360145435f, 0.1304526800954795f},
    {0.5678948876626485f, 0.7496427323275127f, 0.17668020350547597f},
    {0.7447335169606895f, 0.6727017397419791f, 0.023705156135836014f},
    {0.3874505415716565f, 0.28333750159335547f, 0.18251047306380375f},
    {0.1959155047142448f, 0.3348419254890088f, 0.8487224616900445f},
    {0.0004225483868955937f, 0.5567076742290689f, 0.13276482698438352f},
    {0.7483592510574898f, 0.35422306508781887f, 0.4630977207908116f},
    {0.5513790496557317f, 0.888992713327702f, 0.5908222737873982f},
    {0.47798023833208214f, 0.5067897933733865f, 0.3406257691293768f},
    {0.9959435379180523f, 0.4601739157362066f, 0.6182575104148245f},
    {0.35379874771608555f, 0.6614218181367204f, 0.2014252639121964f},
    {0.4204380730356425f, 0.5760056450504174f, 0.1894684691473436f},
    {0.38003277727535634f, 0.3579070175678215f, 0.6832878620642657f},
    {0.040299440577139745f, 0.8778336315023355f, 0.1634671187052159f},
    {0.6409443907766643f, 0.46931953673156257f, 0.4176938572593124f},
    {0.664892581713493f, 0.005474030442799371f, 0.348949399695067f},
    {0.9310958693737328f, 0.16048341234910068f, 0.6626402901166516f},
    {0.07584764514153641f, 0.6399817246858387f, 0.6438614213551971f},
    {0.7224842863423652f, 0.27218222921376034f, 0.7361633549352046f},
    {0.6230401513700751f, 0.8256691690714196f, 0.7692931634882566f},
    {0.8773705729929412f, 0.027196938718622166f, 0.8644131668088482f},
    {0.831217310555809f, 0.5196445647854853f, 0.3290825018996302f},
    {0.26153024965889127f, 0.6554967998238707f, 0.4433304639823905f},
    {0.8591187534733811f, 0.7461765137357439f, 0.44365899989586177f},
    {0.4019713746433924f, 0.536482728200472f, 0.5160920493584384f},
    {0.4420624262042341f, 0.4463292679217886f, 0.9807840717355936f},
    {0.23066244880066167f, 0.38960360488208035f, 0.6832777325422721f},
    {0.45418397501812435f, 0.710533194095132f, 0.3746023732414583f},
    {0.6686959116753196f, 0.0861159240590299f, 0.8068112961150203f},
    {0.23379658404233983f, 0.667137675597252f, 0.959809469827356f},
    {0.41462908222055217f, 0.18730195337935807f, 0.07622633057856387f},
    {0.8084581213195283f, 0.1195326238801745f, 0.9466289635738065f},
    {0.8901130929160348f, 0.6310273100751064f, 0.44571107742824534f},
    {0.37333191130091226f, 0.017106760015530242f, 0.1954103577358809f},
    {0.8646798186432649f, 0.27145923120564885f, 0.6345452996689089f},
    {0.19343436332164443f, 0.4950800369150441f, 0.6532299646040343f},
    {0.5531682531128044f, 0.8330643353850331f, 0.36860708805937403f},
    {0.2848761439221694f, 0.7802728324255773f, 0.5108406579237653f},
    {0.8115866870523535f, 0.2657177213802562f, 0.6258470653872084f},
    {0.10983045307689787f, 0.5025992544953333f, 0.565477564003755f},
    {0.29352149820730233f, 0.09762657961587362f, 0.5948038963486698f},
    {0.2555868540357862f, 0.035391234870274624f, 0.3627504326339065f},
    {0.512665315750698f, 0.1353781907746523f, 0.5846516465579114f},
    {0.22896986231581673f, 0.710518945746275f, 0.5310783047983358f},
    {0.3146400762791245f, 0.5871992853035283f, 0.01423986904508856f},
    {0.46843891781439206f, 0.6315709482551883f, 0.8649226474685048f},
    {0.3417201394978132f, 0.34580764668301933f, 0.14241792582371238f},
    {0.23752383414056932f, 0.6526412376507331f, 0.49290730907385616f},
    {0.8315756347235624f, 0.43515997154040764f, 0.7077693157820121f},
    {0.6968016109416869f, 0.43039348257973054f, 0.8679619581789717f},
    {0.6218457137610545f, 0.0479069059554178f, 0.13370795056159013f},
    {0.4252886887383093f, 0.49753953225805414f, 0.9045083372478059f},
    {0.4163354166415577f, 0.8772752536274684f, 0.29470648923263354f},
    {0.11689183230849931f, 0.6123678971760297f, 0.11564591986555484f},
    {0.17609127063312935f, 0.05216065663427105f, 0.49746811156604454f},
    {0.9459251173557583f, 0.7870111652765152f, 0.6350787079653843f},
    {0.3975573755248404f, 0.2587284274459558f, 0.9146008989317135f},
    {0.4733006546136602f, 0.5912414493958164f, 0.5966944683474313f},
    {0.6413045959634949f, 0.50858156472077f, 0.4374911308767131f},
    {0.1992304356867125f, 0.28479829672511325f, 0.7126499194929812f},
    {0.9584004493276426f, 0.9188216020164492f, 0.21608176663171696f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 2: random", "[votess]") {

  const int k = 127;
  std::vector<std::array<float, 3>> xyzset = {
    {0.5243000999642753f, 0.9041944954440774f, 0.5087280826756252f},
    {0.793164943047004f, 0.8983559848500139f, 0.9468680751493838f},
    {0.21737681809265086f, 0.5933733252211948f, 0.9508569696332796f},
    {0.9500314017946067f, 0.04870796185074544f, 0.8317739612807571f},
    {0.8934194191621401f, 0.8129217835197119f, 0.8501158691569226f},
    {0.68963592410096f, 0.12372643169704756f, 0.302210123494114f},
    {0.8123186346219406f, 0.6759501934427038f, 0.507816007244932f},
    {0.9265229930921282f, 0.13600586316639507f, 0.019840587206787497f},
    {0.4930668090305761f, 0.965624828656294f, 0.27493789574444205f},
    {0.2732196629488577f, 0.3859195859693584f, 0.26100765320880914f},
    {0.5242459779189996f, 0.19378744569292927f, 0.24525939353056125f},
    {0.08064056348612347f, 0.9576812284346026f, 0.00434794886064005f},
    {0.4359465665291642f, 0.8648209293384572f, 0.07357596923677268f},
    {0.8880644384176751f, 0.600707630881977f, 0.22556023851976426f},
    {0.11210355032267061f, 0.7212756606133818f, 0.6895738190722382f},
    {0.6733970331439144f, 0.8735225079745605f, 0.6184359029248883f},
    {0.07380256673200603f, 0.7012382269025484f, 0.8828895360634925f},
    {0.27602241088318635f, 0.40664403100880164f, 0.15680482560203346f},
    {0.28044107504969096f, 0.9749141480086108f, 0.34742833474089674f},
    {0.9617296342710454f, 0.033263464980632707f, 0.6798773325932016f},
    {0.14951040794964088f, 0.04878668164954725f, 0.004239516794520504f},
    {0.16728826148054843f, 0.3001205168451402f, 0.39213863895818024f},
    {0.415373120453287f, 0.6253805506303851f, 0.7350957921069884f},
    {0.7300472104720893f, 0.14337958860578004f, 0.23315645907716176f},
    {0.3478259884238174f, 0.014765074059283068f, 0.45664366242346743f},
    {0.08501679024694464f, 0.7959632596286672f, 0.5271403882534702f},
    {0.34381180674070566f, 0.5282626729484203f, 0.636528946057269f},
    {0.43638950735221316f, 0.2522381210634703f, 0.4256036821947755f},
    {0.8794905682414006f, 0.5247280424562917f, 0.6810247644827935f},
    {0.6021791482878154f, 0.22425402865755317f, 0.023539045188007757f},
    {0.7536454574215503f, 0.6193954997445675f, 0.4807564995573449f},
    {0.777637526192786f, 0.4370338625485076f, 0.15659532489880623f},
    {0.3702881724044528f, 0.12048903494372165f, 0.944509074301361f},
    {0.03413734148605252f, 0.9344839668190656f, 0.8636781728063625f},
    {0.7972673483737699f, 0.7940713397020729f, 0.6947835143685388f},
    {0.4886521132563817f, 0.41533908193579483f, 0.7117374313083338f},
    {0.3882598747492041f, 0.5530472885420722f, 0.7907055462779424f},
    {0.7923204932241716f, 0.7264441589683068f, 0.7729821492257598f},
    {0.16035999692057457f, 0.9305612944423874f, 0.4648728557819837f},
    {0.22598761294661762f, 0.7010646093556674f, 0.16545185538757412f},
    {0.12818366873677778f, 0.5423309585078204f, 0.3529166296418169f},
    {0.6485485458274183f, 0.9593634123548267f, 0.5904956332071255f},
    {0.6373525172808406f, 0.7905981452668568f, 0.5841030609279504f},
    {0.198992614655648f, 0.8382112349138533f, 0.023888390087420497f},
    {0.07098767044772691f, 0.9357566525659783f, 0.18177157470064087f},
    {0.8467772575611189f, 0.19410232383038917f, 0.8194267869310996f},
    {0.07057148176256778f, 0.04856036928493268f, 0.7295551456936957f},
    {0.9173759873253273f, 0.7723763760241452f, 0.6078767975437115f},
    {0.11958758126281799f, 0.4366528069745146f, 0.6125068272885505f},
    {0.8413835260794607f, 0.7132752297040335f, 0.5338839417343786f},
    {0.38066703716988814f, 0.6253714586395419f, 0.33870020738254303f},
    {0.38290150444207505f, 0.9790710582346498f, 0.075453419071421f},
    {0.7468487267743027f, 0.3625248682628537f, 0.49884600126759204f},
    {0.936137065805316f, 0.9173100684527113f, 0.7102078095405923f},
    {0.8467944367038541f, 0.3067918070687279f, 0.24295149556883444f},
    {0.1176427874043372f, 0.6586661157070737f, 0.9573447726897131f},
    {0.4215362498788331f, 0.6689142236937097f, 0.3237626170449457f},
    {0.6375434752283017f, 0.5414200816953287f, 0.7153340708168141f},
    {0.9932456629916148f, 0.8942714917312721f, 0.5981039923412984f},
    {0.486992574558366f, 0.43776171813100695f, 0.5442448336947683f},
    {0.5475178570718842f, 0.6042110608852173f, 0.3017141973838299f},
    {0.1213748967598024f, 0.5063022776127722f, 0.020913658073040686f},
    {0.5485963666626192f, 0.643439195881488f, 0.07952028540504852f},
    {0.7446857888780192f, 0.8381396393555411f, 0.067831860594874f},
    {0.4777465601939338f, 0.9593942090392291f, 0.1983321117608723f},
    {0.6070602673565626f, 0.007303080084324121f, 0.21204831552338077f},
    {0.449359546328724f, 0.4282062086726439f, 0.6841356486074869f},
    {0.25392803636659933f, 0.7084182916041665f, 0.3404810004943303f},
    {0.4103585669308938f, 0.8571258958505179f, 0.9252491479826729f},
    {0.13756231207555458f, 0.16660809124068687f, 0.4575226260668891f},
    {0.42017377299427927f, 0.03854789811499226f, 0.031231776232228392f},
    {0.22799423677448827f, 0.5778481952621306f, 0.9237971576361504f},
    {0.753486216369378f, 0.9030689110433193f, 0.7898696055233816f},
    {0.1028586140102038f, 0.6185267804488802f, 0.39854944320176966f},
    {0.27812638459649175f, 0.07188600099818032f, 0.4104357796292082f},
    {0.8567773140204124f, 0.5896780178022066f, 0.42410746070091765f},
    {0.08858695713253062f, 0.3065833402392293f, 0.5560560835749356f},
    {0.4750618709468395f, 0.4546141847054622f, 0.6159750533738365f},
    {0.9010200692558297f, 0.9793178792237875f, 0.11663872591596547f},
    {0.8864229818209857f, 0.2518128469752873f, 0.8564029296323643f},
    {0.8828763886424746f, 0.6513891762089041f, 0.792021316502174f},
    {0.11257542186522351f, 0.48454784007403306f, 0.8234564156304032f},
    {0.9835105090787385f, 0.36108147305489113f, 0.8053287687591724f},
    {0.5375595552696625f, 0.04632651116683373f, 0.4015719638359371f},
    {0.006022621484239488f, 0.05065328707827155f, 0.5899133688385239f},
    {0.005808369688249937f, 0.14579835057085677f, 0.7784602445308939f},
    {0.038112750225549163f, 0.18901247613988736f, 0.20882731322730763f},
    {0.7125587443708054f, 0.3814343565028796f, 0.9905493421896177f},
    {0.8746510873370638f, 0.155906405763927f, 0.22010118447438265f},
    {0.6437392268685808f, 0.5142304785045304f, 0.8044030691014584f},
    {0.8592910413206968f, 0.6156136825671047f, 0.5762957665146945f},
    {0.016742537751488484f, 0.2455310426228977f, 0.27160698497678193f},
    {0.5267497417935999f, 0.725026984371576f, 0.9787309805866771f},
    {0.13561807740566234f, 0.48289651320472016f, 0.7530044757148028f},
    {0.6930764844448871f, 0.48814102778405566f, 0.5538977832754607f},
    {0.9231187218715537f, 0.3397336196383066f, 0.4200031422142161f},
    {0.13932391754024376f, 0.29457390841234554f, 0.29548311025095153f},
    {0.5236470011106237f, 0.08994067541635697f, 0.6714021665255566f},
    {0.4622146291338425f, 0.13436767218884227f, 0.2747906855736726f},
    {0.77586039793117f, 0.8907568353117878f, 0.16701687028825463f},
    {0.08554391397641292f, 0.8410254222973829f, 0.373640006137281f},
    {0.9319022517477838f, 0.2421714984739094f, 0.044156636396428306f},
    {0.5761315054012898f, 0.43018196538915054f, 0.015265633925724553f},
    {0.19869488314880035f, 0.5348036250003307f, 0.7206584721574409f},
    {0.13061054889921442f, 0.08848527954224539f, 0.6317057522439065f},
    {0.5512301657604413f, 0.22975420006106007f, 0.37932965190833634f},
    {0.9915248534509293f, 0.4776186038189665f, 0.9215464339289295f},
    {0.1663498161649185f, 0.3075260316199455f, 0.31665726630941826f},
    {0.7696927090427945f, 0.25011774832238054f, 0.2224237018309706f},
    {0.7234933449039211f, 0.2399397839560924f, 0.9269012426955824f},
    {0.7147297123727545f, 0.9005413745293249f, 0.9603329261639181f},
    {0.6610477069883584f, 0.04846297651235221f, 0.856228302807166f},
    {0.5104077506041592f, 0.9348092579024564f, 0.745554310496005f},
    {0.5155566474744522f, 0.8033947224744749f, 0.4483755159957775f},
    {0.6640500566162867f, 0.8565618833289445f, 0.42134540545222354f},
    {0.09940115202327104f, 0.19261887687205903f, 0.4734459104726868f},
    {0.40667184093886444f, 0.9797986725325927f, 0.46672032972204935f},
    {0.2949793930763873f, 0.0033951329329571234f, 0.8681155335916342f},
    {0.193303996639556f, 0.9562713327933284f, 0.15765371109131543f},
    {0.3516430532199827f, 0.2835911740050231f, 0.33263325834838464f},
    {0.27564424922802944f, 0.7874418715374019f, 0.4144014842928784f},
    {0.6765525357867301f, 0.6114977591718681f, 0.7692796876725991f},
    {0.9094219845359299f, 0.6280533163267268f, 0.4313733346891053f},
    {0.7332596588720401f, 0.976364433212949f, 0.43034568915227533f},
    {0.6003589200523721f, 0.18198613433344124f, 0.4993501777273551f},
    {0.8807764196206722f, 0.6323682115704018f, 0.8771797092121262f},
    {0.4413024506763873f, 0.4181085406204069f, 0.2194402763551001f},
    {0.2085187920110153f, 0.6332624259529569f, 0.8982001881168538f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 3: random", "[votess]") {

  const int k = 127;
  std::vector<std::array<float, 3>> xyzset = {
    {0.6568502857772707f, 0.798779631434246f, 0.19360349617774297f},
    {0.38552742916233584f, 0.7253520853254417f, 0.584652114212545f},
    {0.9657913810388946f, 0.27944777479631866f, 0.9556152226519278f},
    {0.4024470897255529f, 0.6162745584331931f, 0.9790271777358299f},
    {0.2066690168254126f, 0.8968981072191742f, 0.949215707792196f},
    {0.44543092002669527f, 0.6884972872108813f, 0.9036840177010411f},
    {0.5053520087722334f, 0.7905130363964435f, 0.6364516194172913f},
    {0.9784204541835966f, 0.4268866123373869f, 0.03914854201602114f},
    {0.2574294511671861f, 0.16334882478499557f, 0.7140188309120988f},
    {0.1751093315165615f, 0.6153510328951661f, 0.4093294682799412f},
    {0.20883074523696543f, 0.20932192463375787f, 0.9698108981695583f},
    {0.3615481542520468f, 0.37287351011131553f, 0.22892252700381777f},
    {0.8096262108353985f, 0.13437815318913182f, 0.6439298569209474f},
    {0.009216650408488958f, 0.6552077675882295f, 0.5931851631303466f},
    {0.8349465806813359f, 0.3873518422309329f, 0.3250661996728854f},
    {0.9079223167180666f, 0.8360590206395669f, 0.5093690089305156f},
    {0.5880969535925884f, 0.20834945414890815f, 0.7722203344959254f},
    {0.5794001735150031f, 0.5836251283243886f, 0.7575738307989923f},
    {0.908515981261833f, 0.47159014351359396f, 0.9373794707054848f},
    {0.6720580387237208f, 0.35851424899592843f, 0.7986842323908591f},
    {0.7408216500336664f, 0.4938804751995417f, 0.719894315217484f},
    {0.11041517353131458f, 0.8965199049265555f, 0.03540313703118869f},
    {0.3794049472801836f, 0.4568756645490728f, 0.1532305602522369f},
    {0.684126382756929f, 0.6328249354224484f, 0.811514784886312f},
    {0.6964854442062507f, 0.17545144089649545f, 0.5566994424253617f},
    {0.6737699791940076f, 0.02466748874852298f, 0.7666630895094648f},
    {0.43469565202563354f, 0.8965671470345011f, 0.9655989734027678f},
    {0.5224169952429684f, 0.9401840731458633f, 0.9762951958569711f},
    {0.8019412324414886f, 0.38018109369271946f, 0.6195023127500189f},
    {0.8809433693436899f, 0.8590871826657459f, 0.07177915929172785f},
    {0.3157895036589111f, 0.029303829791852753f, 0.442277252315292f},
    {0.09567500194446821f, 0.1493240714264169f, 0.24412058914767942f},
    {0.33638670521976f, 0.01540860770806518f, 0.7894770682798744f},
    {0.5698695580748844f, 0.7776341062288518f, 0.4454285057491181f},
    {0.5049671678770217f, 0.573526388890825f, 0.677939459285157f},
    {0.8758551195014193f, 0.6541072425740805f, 0.44186336570098705f},
    {0.03917846763402666f, 0.9776298697315516f, 0.33716661465381703f},
    {0.1535622201692155f, 0.005949618122225275f, 0.5555740486750911f},
    {0.9120524681928154f, 0.8283273351302491f, 0.07222560041221415f},
    {0.5841625294537239f, 0.6915014375037819f, 0.41470077697243657f},
    {0.6550195661136182f, 0.2186784326836334f, 0.5200173418856235f},
    {0.2886487419326519f, 0.39286960946666327f, 0.6233887196878982f},
    {0.6152407815501154f, 0.2431358908396336f, 0.6611926458041621f},
    {0.7374084187749118f, 0.6847588807091818f, 0.09362653182541192f},
    {0.9444083379328794f, 0.4566685239227214f, 0.03177211772701127f},
    {0.801401637516102f, 0.23134523387621952f, 0.6323254754671153f},
    {0.87633746812924f, 0.7823818979934201f, 0.5738136504303442f},
    {0.024957722163659657f, 0.22963395489460847f, 0.4412026829177934f},
    {0.0813815223537262f, 0.3413849845429697f, 0.7568127333474591f},
    {0.8540399427611933f, 0.12838323726447065f, 0.43224667229484137f},
    {0.647864145805007f, 0.5808340626531302f, 0.25705575939309233f},
    {0.39815193711367447f, 0.6054817317790709f, 0.42604963711372235f},
    {0.03512133428330633f, 0.4024169123301443f, 0.2932765212971039f},
    {0.8287049378132846f, 0.026871940241539383f, 0.9452385996395894f},
    {0.42750198297262487f, 0.3510565434657781f, 0.7426496813890616f},
    {0.3259144211711148f, 0.3846009274194463f, 0.5866083134116129f},
    {0.9504344295144271f, 0.9494278391189425f, 0.7470399692186481f},
    {0.5022587026216083f, 0.15155394426179614f, 0.11591853069431657f},
    {0.09247596586967877f, 0.850775946167723f, 0.3074420021019869f},
    {0.04410578449253699f, 0.7444055784275909f, 0.8637405224998491f},
    {0.21188842035678412f, 0.7210943559319823f, 0.24242305596139135f},
    {0.8046501073395023f, 0.6934722825637625f, 0.27044527059891743f},
    {0.5517472884831023f, 0.5719761403070851f, 0.8306716778628028f},
    {0.7376391001164032f, 0.9164998875853861f, 0.04942882194209908f},
    {0.9520296466673444f, 0.9243462839622654f, 0.1685286679061685f},
    {0.7043959786031844f, 0.5085517634229638f, 0.49306642196616046f},
    {0.700019287589185f, 0.32985133612265694f, 0.7393674013547907f},
    {0.24463839678316757f, 0.5992977825951507f, 0.4340168052305742f},
    {0.31013858490248847f, 0.48773344011196385f, 0.17521598775321878f},
    {0.4801916659149378f, 0.5248981747894289f, 0.21732583290922003f},
    {0.8664499803249226f, 0.21146142790112843f, 0.7728547666306982f},
    {0.9102328574294939f, 0.5430396190767486f, 0.7479921704821852f},
    {0.10835865481547269f, 0.2416124920240864f, 0.29864775178604375f},
    {0.3166430147647261f, 0.815190085945326f, 0.12616311603189967f},
    {0.26020153511472544f, 0.2986797295117568f, 0.02780080013467312f},
    {0.8071393755548815f, 0.522611818415053f, 0.023528442004484562f},
    {0.342430255325913f, 0.9755165778957551f, 0.29956204807833087f},
    {0.2716530877567591f, 0.47081741404932675f, 0.008496694930287707f},
    {0.04329455592625486f, 0.28518038217955044f, 0.8697490263494869f},
    {0.6008570818569293f, 0.35496778237607796f, 0.001155119151664219f},
    {0.9590160246668777f, 0.9569056264648458f, 0.6072400656819704f},
    {0.4072437062480181f, 0.6900313987193032f, 0.15448539640576076f},
    {0.06561920837358004f, 0.714319375600049f, 0.4268833507530576f},
    {0.3245762697089488f, 0.9056565925261878f, 0.46753246690372796f},
    {0.33070513824083214f, 0.9223441834952835f, 0.032234830506020495f},
    {0.5717714214838464f, 0.8447734203152006f, 0.43236150952753705f},
    {0.4439897397872775f, 0.3506609280348303f, 0.1270526896080647f},
    {0.7349559473397647f, 0.8336005575296433f, 0.0074802682622941985f},
    {0.894000188146836f, 0.2723273303070165f, 0.26204942155962074f},
    {0.3804737194349136f, 0.4642801416350545f, 0.6316020404153182f},
    {0.7427423518128491f, 0.4950905721264709f, 0.6404481586115758f},
    {0.4056536683098403f, 0.5641742878008087f, 0.13209810111010312f},
    {0.07657416594732258f, 0.5159728306829499f, 0.23876088018915986f},
    {0.22488387810236876f, 0.03948460653245178f, 0.09084738250003799f},
    {0.9352982310899847f, 0.5431619422812616f, 0.7519883158497762f},
    {0.5213915058574992f, 0.14257895212883676f, 0.3920439623397928f},
    {0.6185960143818965f, 0.4100269878839754f, 0.9853676390989962f},
    {0.6041250051326912f, 0.6332294524724884f, 0.01762897628702198f},
    {0.7618450432614107f, 0.5454591346712353f, 0.2475270250811905f},
    {0.8724463062704714f, 0.680743458687505f, 0.31008474402089703f},
    {0.6537150169341365f, 0.8387863942052394f, 0.9766261529737913f},
    {0.15279363990895833f, 0.6773529689922219f, 0.08127738174240529f},
    {0.07509231095354352f, 0.47687652821585014f, 0.8873612290711581f},
    {0.4367252999548854f, 0.9124177002157494f, 0.02566854760953985f},
    {0.5750592606761794f, 0.9535103460762843f, 0.03590457783881207f},
    {0.3938687730687719f, 0.01621602334071026f, 0.08244062458055423f},
    {0.0683887920292785f, 0.7421419420599326f, 0.7262807385855726f},
    {0.7513707327148343f, 0.6560493288458644f, 0.6062411010655031f},
    {0.47040771096103784f, 0.7561878114154339f, 0.2612422271679514f},
    {0.6885408510281057f, 0.3883237429300399f, 0.5840518940638657f},
    {0.5451509686971024f, 0.6821031404159721f, 0.595426534525232f},
    {0.11907884196695406f, 0.18286935468173826f, 0.05770300463126077f},
    {0.4102452200289579f, 0.7530463201518767f, 0.5575903119533169f},
    {0.41571273265810627f, 0.5191574810870443f, 0.8281661607142099f},
    {0.34701024318159135f, 0.5412720028422017f, 0.527754934586135f},
    {0.4461659405901798f, 0.7046419116166381f, 0.09073738572093526f},
    {0.6245511829085316f, 0.7466723227667861f, 0.8643447769248409f},
    {0.349095091459554f, 0.47407242665505656f, 0.9266694795016404f},
    {0.2358736653761787f, 0.6552965281552361f, 0.7458734225844086f},
    {0.9198791432748217f, 0.11273414947002236f, 0.4913541483521574f},
    {0.13400114743881608f, 0.2272761107088791f, 0.9683944553221068f},
    {0.3555605475936945f, 0.768686904839732f, 0.49114868089868224f},
    {0.6753506132147046f, 0.7140289461786495f, 0.514126259216376f},
    {0.5323515432056553f, 0.7142582309173261f, 0.41163974969242434f},
    {0.8732727247013824f, 0.6093259320563016f, 0.15036365885351288f},
    {0.8635430088233385f, 0.4079143460170104f, 0.7824038711422202f},
    {0.7881248252394911f, 0.9996497003496909f, 0.01558847832091348f},
    {0.10943894635255047f, 0.8729407392357217f, 0.05067053858897075f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 4: random", "[votess]") {

  const int k = 127;
  std::vector<std::array<float, 3>> xyzset = {
    {0.1396263682904504f, 0.7947694105132403f, 0.29421412919139334f},
    {0.8431045540096546f, 0.821236918163726f, 0.3116194147507071f},
    {0.07398238331131668f, 0.5932666564731042f, 0.2616475635287685f},
    {0.2149067506159157f, 0.10201850491981734f, 0.898788137931265f},
    {0.5346404506662684f, 0.9972230195132585f, 0.02218765902337272f},
    {0.4436228320638723f, 0.613767712581058f, 0.1403454041975961f},
    {0.2852958767508774f, 0.24094073789961568f, 0.27823601875840664f},
    {0.9962473621824112f, 0.6404138650918854f, 0.978294501407111f},
    {0.5902033215741912f, 0.3289181117119381f, 0.13461663549846214f},
    {0.12151631644920746f, 0.17079075558734425f, 0.9252931592862399f},
    {0.8154168938725491f, 0.6765198168556009f, 0.3132740368204765f},
    {0.7807459203564355f, 0.15839666955094878f, 0.18364800488207944f},
    {0.4117578826381061f, 0.9214257693461688f, 0.7504438317717729f},
    {0.15180771802934157f, 0.38346427843861086f, 0.7748380455194913f},
    {0.626125354010994f, 0.04855034740234865f, 0.17952194698717883f},
    {0.877805634999216f, 0.5974505453091088f, 0.18761604619102246f},
    {0.06732076361784212f, 0.673075576088156f, 0.9647198964816677f},
    {0.8875930068894523f, 0.0067611366619535485f, 0.05066423008025689f},
    {0.37738328942058463f, 0.36853565755216877f, 0.5072518031459144f},
    {0.25161200359550384f, 0.8258036636123295f, 0.48056410270449323f},
    {0.10294628632109193f, 0.04592798561731992f, 0.9800527475765451f},
    {0.3356788312308857f, 0.4297442262613844f, 0.5527240535707029f},
    {0.06263735561313999f, 0.7082963185109792f, 0.0012015577321070614f},
    {0.1097355596467493f, 0.30179999317339046f, 0.9159620043477507f},
    {0.9248699025981332f, 0.6604470058205233f, 0.12047071404615461f},
    {0.711192720263272f, 0.8600066778413519f, 0.7336572778271891f},
    {0.7723685189014646f, 0.4788840228369501f, 0.6112134055919252f},
    {0.5919959903612818f, 0.09926947712455336f, 0.8529890375544841f},
    {0.22476562245187648f, 0.8105391784675868f, 0.7023015961615584f},
    {0.003222672650177616f, 0.2333057775738533f, 0.14635042178435786f},
    {0.49496673746511566f, 0.43475667752785363f, 0.697817142183871f},
    {0.1026422929776325f, 0.6496887795794392f, 0.23988079962753017f},
    {0.697653888455178f, 0.20094157172804472f, 0.5586612461971745f},
    {0.8337224729562359f, 0.4175210103069239f, 0.12071315578539032f},
    {0.7732455635475046f, 0.9750891863091208f, 0.33393874482650665f},
    {0.7414565493914649f, 0.8715977226853999f, 0.4249213340549034f},
    {0.8275940373270485f, 0.561659694159767f, 0.1290596935710414f},
    {0.2535366185751943f, 0.7746792365707164f, 0.5892593414580386f},
    {0.7034566225482893f, 0.7845537862213505f, 0.5270318427998133f},
    {0.0013452608860298199f, 0.6721255164834894f, 0.3788913481867221f},
    {0.6377112606452865f, 0.34739424293554033f, 0.8458677088619108f},
    {0.10195935880872187f, 0.3399850385592339f, 0.2295880672840167f},
    {0.10961903841673315f, 0.5414180070582852f, 0.1744244322041104f},
    {0.5266603302682088f, 0.624031687636542f, 0.8645178149770607f},
    {0.9201233397201951f, 0.42033210810525f, 0.8552478794786619f},
    {0.28510647444232384f, 0.046210101584801544f, 0.14348459214135834f},
    {0.7322973875351921f, 0.5274515957172455f, 0.31764600603500126f},
    {0.32448061252550564f, 0.09809781756412206f, 0.9096369430608915f},
    {0.3762941977299987f, 0.7650112282261259f, 0.48783912743964875f},
    {0.9210673038855411f, 0.37642686719082763f, 0.019082173993073215f},
    {0.9466294878750545f, 0.8513775847755478f, 0.810670977436235f},
    {0.7112207926601704f, 0.17651384199838716f, 0.7176448835038721f},
    {0.8584379172091859f, 0.44632572901890644f, 0.9768316279151171f},
    {0.17504582429415505f, 0.32740708320967904f, 0.6194502737087529f},
    {0.6488420746989335f, 0.005850049809168589f, 0.2594531138086139f},
    {0.44077343659560275f, 0.8029338132779378f, 0.345615721086757f},
    {0.1893823685561664f, 0.015953184991877034f, 0.8622663351037246f},
    {0.025148731836834304f, 0.014986070953417863f, 0.14847961878708626f},
    {0.6892815866275067f, 0.2903614377753393f, 0.4515843931590652f},
    {0.4797948576040745f, 0.32691997387352667f, 0.165610879061741f},
    {0.06362868226488805f, 0.9175957908852169f, 0.9289926125951815f},
    {0.39625189440838937f, 0.5920746461565923f, 0.4355630785833424f},
    {0.35652631871353446f, 0.9875942616169574f, 0.7497682391542387f},
    {0.4507310929929593f, 0.4411947303794048f, 0.5346838109135255f},
    {0.1775461233363752f, 0.8494388787078226f, 0.29046611344974393f},
    {0.5100052913814546f, 0.48654510276567775f, 0.7411239562935064f},
    {0.7648874690717907f, 0.37576629670699835f, 0.3140619145764658f},
    {0.5566950467110018f, 0.41891133281755943f, 0.22705209499297407f},
    {0.4343505434592899f, 0.4175067694695813f, 0.6587347183288403f},
    {0.013198431629197427f, 0.9706489719695351f, 0.3879276838672683f},
    {0.8133209463754811f, 0.6983555500633686f, 0.47234851874248485f},
    {0.2151353871962095f, 0.5493331438391322f, 0.8532674102029005f},
    {0.6840497892267241f, 0.4754052469626987f, 0.05977948389472543f},
    {0.5519853526437575f, 0.20533837193463933f, 0.562452980696912f},
    {0.07978738762496596f, 0.32003527298904955f, 0.24260517402205395f},
    {0.2866890464820825f, 0.47089978686848455f, 0.4917198294347198f},
    {0.9082706330561403f, 0.8298937740812318f, 0.6905824526478093f},
    {0.6625164753258116f, 0.009824941784927432f, 0.7351133433629571f},
    {0.19368263251392437f, 0.358772822865407f, 0.30484979302591153f},
    {0.9361627321847268f, 0.8440459937854866f, 0.04851535458067524f},
    {0.11237418157111434f, 0.8304689919618078f, 0.4211882675319478f},
    {0.9021039175799109f, 0.004090015476304831f, 0.23611303031070885f},
    {0.3269573819209516f, 0.306609642199693f, 0.322335090603714f},
    {0.13454093247505283f, 0.5750713946063516f, 0.8675051398184673f},
    {0.6252366107186274f, 0.28979582859470576f, 0.8217534606473975f},
    {0.5484897012317063f, 0.7913390789818298f, 0.575142184180776f},
    {0.8737888767584497f, 0.5752644591048561f, 0.8756074796825972f},
    {0.8901638481067269f, 0.0872192076387317f, 0.7863346539986013f},
    {0.6978888136586775f, 0.6335095678623496f, 0.6504976732620104f},
    {0.12136109218227409f, 0.6122048894755323f, 0.041073865697618284f},
    {0.050229571172136556f, 0.3841910733806819f, 0.09925767101369354f},
    {0.7632090642655681f, 0.724663397206806f, 0.997618265863656f},
    {0.11862436995828118f, 0.26628699183476856f, 0.8604663691077122f},
    {0.08856027608751815f, 0.7754565866771208f, 0.0963773651383707f},
    {0.19665295546992845f, 0.9274168491091761f, 0.5426620367559464f},
    {0.8504444540634475f, 0.2649212056444148f, 0.12388996430022059f},
    {0.14818408606521105f, 0.9753364939979237f, 0.2805047031496435f},
    {0.7476134021116031f, 0.8591592715218321f, 0.51994421181089f},
    {0.005890581006816609f, 0.24290744580583867f, 0.8812026003485981f},
    {0.7025010661563368f, 0.5569586245332333f, 0.4547764264290459f},
    {0.6001581342825045f, 0.33719780439774116f, 0.09491511445271461f},
    {0.39653826360304534f, 0.9833634134056399f, 0.23287862406798288f},
    {0.3712242032083737f, 0.8120567580445599f, 0.16805058159334674f},
    {0.8803973377101004f, 0.18257647875845417f, 0.679519420503685f},
    {0.26803008654645866f, 0.6274863611155427f, 0.9202119682578792f},
    {0.11854261182090975f, 0.5366710545563691f, 0.5101318876068934f},
    {0.871476420772414f, 0.3491830093938906f, 0.9383385549797079f},
    {0.31499284463400334f, 0.5684836608264628f, 0.156369799377013f},
    {0.794811162410806f, 0.7887734941089334f, 0.22627422637340744f},
    {0.8492027775020287f, 0.005654901732993323f, 0.03335899962209243f},
    {0.9902223552731497f, 0.13825631734941668f, 0.18287477928902163f},
    {0.3364971440303811f, 0.9862472286042676f, 0.9883825256564772f},
    {0.6655352860787357f, 0.801058902001242f, 0.4823905164642267f},
    {0.25827806457844826f, 0.8046428724007509f, 0.9727212817238919f},
    {0.9374685112609384f, 0.6191907922380159f, 0.32196285811726144f},
    {0.9726870154020252f, 0.016246079756696563f, 0.2667288564037281f},
    {0.22449357094554845f, 0.3693665166574772f, 0.6410874189439575f},
    {0.9633909699135306f, 0.10795347184662951f, 0.9901368501628581f},
    {0.3597813789365679f, 0.2950033974314019f, 0.14628850559480566f},
    {0.755532584769261f, 0.7814246659250867f, 0.5993788062442688f},
    {0.9417776178928321f, 0.7996772833107824f, 0.29727677708427147f},
    {0.31156459810019566f, 0.4858471167109035f, 0.1727099640976646f},
    {0.9003426981337807f, 0.7686194165430982f, 0.021622122527459764f},
    {0.9981856214797005f, 0.6779833958497581f, 0.7396105032828449f},
    {0.07044184731309411f, 0.7737219683156462f, 0.6158814671103083f},
    {0.9474518517936584f, 0.727117799509432f, 0.3488823142297065f},
    {0.6348287842744769f, 0.38704329818956185f, 0.350659281937893f},
    {0.2162445571693803f, 0.04931371356566483f, 0.8735773129265422f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 5: random", "[votess]") {

  const int k = 127;
  std::vector<std::array<float, 3>> xyzset = {
    {0.5580372210932838f, 0.44059442996154463f, 0.9431794912318463f},
    {0.6181446936937005f, 0.9948724912826195f, 0.19741634587249168f},
    {0.7482245467319215f, 0.08958895043626736f, 0.6911540479333089f},
    {0.9442972966389629f, 0.034804450005952f, 0.7358714846880887f},
    {0.6460193446632462f, 0.13483191363324798f, 0.0008773455776368566f},
    {0.7384952191232909f, 0.3521207024951464f, 0.21054589107890198f},
    {0.11072261626531021f, 0.8646882504991624f, 0.7644036757455408f},
    {0.8804622533598007f, 0.34691801899967356f, 0.3772965602481847f},
    {0.1954919618026839f, 0.7946491931060216f, 0.3550242911375229f},
    {0.3136485445923516f, 0.7634524233019679f, 0.7000021351464599f},
    {0.04665072788300062f, 0.1421714350340676f, 0.2544584765587228f},
    {0.1063567049933477f, 0.22466229955521888f, 0.5281385834743599f},
    {0.46478400344730797f, 0.26837379474561884f, 0.4704963484060217f},
    {0.3786041859595616f, 0.028013038188847594f, 0.9758901871129616f},
    {0.5678495274183123f, 0.08418095006836024f, 0.5910262387005403f},
    {0.21130239435535525f, 0.3638344641515241f, 0.4718401545303649f},
    {0.31098641281113293f, 0.7196494291813644f, 0.6197172810654656f},
    {0.8907077598983993f, 0.6836349290948527f, 0.7565237093541664f},
    {0.03311621488344785f, 0.7627470159902439f, 0.045744046509947456f},
    {0.28287945797234304f, 0.3271971507314225f, 0.5536381720975885f},
    {0.2378827127833424f, 0.505373392115861f, 0.22601673230600638f},
    {0.2857052103081207f, 0.3758266742073598f, 0.7498383116336776f},
    {0.3963101500616314f, 0.10673128964699174f, 0.47394146902463385f},
    {0.33300436030691893f, 0.8749570073145055f, 0.9863996579626695f},
    {0.027894757564532968f, 0.2531501887224431f, 0.9222413101677001f},
    {0.021106716129502323f, 0.3527109022297731f, 0.5212774087262042f},
    {0.6751315654176401f, 0.002889154295541485f, 0.1522830524286053f},
    {0.43385963164544783f, 0.6359863565002745f, 0.06294160325784959f},
    {0.6349300609386777f, 0.41599639189898197f, 0.48167287205493603f},
    {0.9966037432360093f, 0.5315422462765599f, 0.8928846263705938f},
    {0.39083595372829694f, 0.672620008178949f, 0.5173508356899069f},
    {0.9033000187958641f, 0.8538168560891292f, 0.5425271067261239f},
    {0.55130538258967f, 0.08477425787644566f, 0.0961148134348565f},
    {0.5068285632853939f, 0.6214033207937689f, 0.6437174211836052f},
    {0.7969840056662426f, 0.9707464434651701f, 0.6013202565699864f},
    {0.5546770622639127f, 0.9421067908917276f, 0.8728188116544112f},
    {0.7207531908079994f, 0.18205021276876765f, 0.5201194781255231f},
    {0.1506243961624152f, 0.23680967161425615f, 0.48456623889939265f},
    {0.8889432840895685f, 0.5447765446204753f, 0.06482039975775977f},
    {0.6632336846327476f, 0.13855418504873773f, 0.5337189906691162f},
    {0.6978234578369079f, 0.7038611390088823f, 0.8078420533660945f},
    {0.1506790767652635f, 0.2070776781053718f, 0.03701078913006928f},
    {0.03595761907759065f, 0.1481799240482875f, 0.6401040210565593f},
    {0.025777123034434357f, 0.9063252341892059f, 0.41796700691132227f},
    {0.7778134832762531f, 0.5932432255924985f, 0.4690750117048669f},
    {0.9833297352644456f, 0.39239884911273337f, 0.8580591744524086f},
    {0.41516947920317737f, 0.7698392887660331f, 0.37888497056106163f},
    {0.8561669751391349f, 0.7762292525421653f, 0.1075760865846096f},
    {0.945343967922718f, 0.2769052650728544f, 0.03501453891379103f},
    {0.21862488225456966f, 0.18996362282194457f, 0.6642331755175238f},
    {0.9240072762127133f, 0.2351292291362923f, 0.4425084386924967f},
    {0.5446386296680693f, 0.46343438085030175f, 0.664479910335938f},
    {0.6015249134887904f, 0.2703578542278323f, 0.16464291573951295f},
    {0.5680430620475271f, 0.8938050456219537f, 0.09192256090601425f},
    {0.3065451942986873f, 0.8297375150229869f, 0.011154240147325023f},
    {0.306328191165525f, 0.5460699077462998f, 0.7899230610454692f},
    {0.21835637868552216f, 0.6647636780820093f, 0.41778643651918546f},
    {0.510221203652973f, 0.21030817424535964f, 0.519283808715577f},
    {0.7704220331451606f, 0.5032522430278891f, 0.8209248464964312f},
    {0.42485026078058397f, 0.6551141152786812f, 0.7951911238324068f},
    {0.6421743895759827f, 0.002160429278817988f, 0.834494536826756f},
    {0.9936678426956396f, 0.6857197020279809f, 0.46646954313792865f},
    {0.9049844720759652f, 0.17030375435884748f, 0.5883588438970833f},
    {0.2892464193630879f, 0.7937857896790499f, 0.8825855335393584f},
    {0.2939480852302826f, 0.2605079613900353f, 0.5493447125150791f},
    {0.44756680846211794f, 0.24406476664458976f, 0.6494291502482781f},
    {0.17546814785798337f, 0.22022001898844534f, 0.40271004282327294f},
    {0.5065069336627528f, 0.48080047606718457f, 0.24128529862135895f},
    {0.3511528837253851f, 0.27346306230643347f, 0.9366810329915114f},
    {0.8917489311510377f, 0.7723442040160817f, 0.522038222363559f},
    {0.9521268717767193f, 0.2428882286368177f, 0.8026402375859609f},
    {0.937657766837024f, 0.8663800233845669f, 0.4180758654524829f},
    {0.45615354301518474f, 0.7200524257944705f, 0.3433012384452092f},
    {0.9282647416009799f, 0.8437353294636828f, 0.35172949909598816f},
    {0.09755149590819068f, 0.26502091162475006f, 0.19176152714100247f},
    {0.9816602267473057f, 0.9822281762953923f, 0.7077592994846785f},
    {0.40194134252856717f, 0.03318510535353614f, 0.3666245189935077f},
    {0.34509310470403964f, 0.6804691475950692f, 0.7319850440791548f},
    {0.27323224322430417f, 0.5290494043248559f, 0.817256737466878f},
    {0.8639194023264035f, 0.5715595207125813f, 0.6232099674210652f},
    {0.19924655448615014f, 0.027817959744807275f, 0.18873324722902962f},
    {0.7300382195813118f, 0.26432974013630406f, 0.37759756747153395f},
    {0.4364134837165926f, 0.09507846834606992f, 0.28063666371761253f},
    {0.9780900125829375f, 0.3936309022972607f, 0.5579405487769644f},
    {0.6397320674858568f, 0.33196393903184385f, 0.7491748129550241f},
    {0.03767892954956942f, 0.5690686259929071f, 0.817023172930793f},
    {0.39871614021260526f, 0.1595762396370708f, 0.948014554043259f},
    {0.7525372086482166f, 0.040874571437538254f, 0.9195716334502976f},
    {0.3279969211929381f, 0.8245019901450372f, 0.3872197131730749f},
    {0.7157487389413439f, 0.608501264115057f, 0.8452809667341271f},
    {0.3598704585084229f, 0.4386052302712563f, 0.4888507159549106f},
    {0.510753936818237f, 0.7488677770091812f, 0.37310633035825247f},
    {0.4530437279406718f, 0.701631436788215f, 0.42596331845363244f},
    {0.018768093393001672f, 0.4025361557540089f, 0.7399788736626659f},
    {0.19398395747667163f, 0.7044420430974534f, 0.24497109368859515f},
    {0.07053490210891866f, 0.15231680841939255f, 0.903738913987638f},
    {0.3831748465108352f, 0.087650759686006f, 0.3664769194033185f},
    {0.27958499595988395f, 0.7440216429279765f, 0.263226425841239f},
    {0.8574007568612775f, 0.15656625000404367f, 0.9142047572092246f},
    {0.5039305591309681f, 0.9256921467203888f, 0.30459922647584603f},
    {0.6275771508435242f, 0.868300755218467f, 0.7356848648623582f},
    {0.2958751906999837f, 0.06173896250147537f, 0.04731166168090206f},
    {0.3491042674305964f, 0.7999666461284548f, 0.6422140497847221f},
    {0.3585566481754545f, 0.05264645072766727f, 0.17155017062591282f},
    {0.012034183492518613f, 0.6807226278953263f, 0.22996840922608353f},
    {0.6987456217520822f, 0.646227970818582f, 0.4232706680070939f},
    {0.35553688294200525f, 0.19660470869235902f, 0.7644111566971138f},
    {0.045237546459276246f, 0.5431446472350631f, 0.7779316450146198f},
    {0.6541317484461878f, 0.34833098391774975f, 0.5643388216325631f},
    {0.8053230156751621f, 0.5188555762225497f, 0.3714105878363534f},
    {0.273088905233255f, 0.3915210586001143f, 0.8999386244029947f},
    {0.40273319934522267f, 0.6217496959679899f, 0.21294282465077663f},
    {0.539166681921763f, 0.12705815344694305f, 0.7534259093058885f},
    {0.13902274797927439f, 0.04889068039725941f, 0.0062621464643752844f},
    {0.7547410231385255f, 0.644465848080032f, 0.1251640538436597f},
    {0.7227345061934174f, 0.3723762326941673f, 0.8015906339790883f},
    {0.3511334755738883f, 0.361668459917448f, 0.6637572362703845f},
    {0.5216620554749419f, 0.17018489612729715f, 0.37971810755954927f},
    {0.22455100881854906f, 0.11486916713817386f, 0.8144175240032752f},
    {0.9857235365093395f, 0.1851574440555085f, 0.697941214739585f},
    {0.09212616585968636f, 0.7506227918391234f, 0.07227127968416402f},
    {0.17844054240245022f, 0.7864084906201977f, 0.3363749524071532f},
    {0.544561976427385f, 0.3194583129857935f, 0.3889388893816673f},
    {0.3298640368078072f, 0.7117447730101906f, 0.2960655980048803f},
    {0.370813579265611f, 0.652538188104165f, 0.6531388575784123f},
    {0.8030521527220335f, 0.7390771426122037f, 0.642613467005461f},
    {0.9438902970101292f, 0.4473907126039445f, 0.13132213893847577f},
    {0.23876209956363148f, 0.9151859508161013f, 0.9545359028707073f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 6: random", "[votess]") {

  const int k = 127;
  std::vector<std::array<float, 3>> xyzset = {
    {0.523280488564618f, 0.7604481676848338f, 0.7097251039048987f},
    {0.8297667326138849f, 0.34087863186256673f, 0.7441793904242211f},
    {0.5841185516181913f, 0.5307341373983272f, 0.24839600207917578f},
    {0.8946482858674927f, 0.548053812641551f, 0.25218598572295914f},
    {0.8475148818597978f, 0.3791679930936491f, 0.21599691317995973f},
    {0.4294416197948102f, 0.6557974778858077f, 0.9939349721454056f},
    {0.21135472045000303f, 0.5161379131615569f, 0.832606954468305f},
    {0.43464864582478646f, 0.6869688646546183f, 0.8314871303631813f},
    {0.6369264636361122f, 0.7169448833821854f, 0.7108020686060499f},
    {0.8337405383846168f, 0.25680521247409804f, 0.5668364187514454f},
    {0.9091175728328236f, 0.8485127864774167f, 0.4410918693796907f},
    {0.9606605187190488f, 0.6235005559913048f, 0.6564811982590347f},
    {0.06178037234020617f, 0.9778597082600053f, 0.7196562284196615f},
    {0.5565867640856624f, 0.8378588352647162f, 0.05962743709232099f},
    {0.6500982309347247f, 0.00899463373781162f, 0.19227254297777818f},
    {0.5887608117907029f, 0.14490699447281352f, 0.4843602458337267f},
    {0.7821446881658832f, 0.23746620619142234f, 0.5010617643733715f},
    {0.14212784060290162f, 0.22676418430594958f, 0.3905919621359377f},
    {0.25105488970972134f, 0.8661539310304607f, 0.39649649225185823f},
    {0.9782927847018937f, 0.7018847824973524f, 0.40726658400683813f},
    {0.3426748538017974f, 0.16456185966924075f, 0.4448015541700574f},
    {0.32768835831034837f, 0.3080733726538344f, 0.5575214270342689f},
    {0.49204466614317965f, 0.28414842130678886f, 0.7289250956636083f},
    {0.8145072016018932f, 0.6920205146270826f, 0.5712540400198604f},
    {0.07269763094952908f, 0.06790461538203996f, 0.22397202605104793f},
    {0.523356147434527f, 0.9777334026182269f, 0.46274482064270195f},
    {0.5703567603481896f, 0.6935989227777568f, 0.7213977546172968f},
    {0.8892948628619557f, 0.705752522907519f, 0.4210794787916795f},
    {0.9097537164680387f, 0.6723541697257638f, 0.7890011449964721f},
    {0.3800883922388295f, 0.4509311586797534f, 0.7675277999671766f},
    {0.26426593656253494f, 0.7946675330920743f, 0.46296585038376525f},
    {0.548733269008434f, 0.07483255907127118f, 0.6315895973820892f},
    {0.5587970463298801f, 0.8154721184357832f, 0.5370708440087173f},
    {0.3518235743835567f, 0.503185348961406f, 0.8541791336180038f},
    {0.6392618175251126f, 0.7665698226269736f, 0.45648840085743614f},
    {0.3684793321122076f, 0.639144634799186f, 0.6742516202103251f},
    {0.7694642093347841f, 0.6310569470459861f, 0.15558397718375905f},
    {0.7727699218388654f, 0.7936169211969372f, 0.8884567710390481f},
    {0.13061208902150423f, 0.46643406627504147f, 0.5573573564600753f},
    {0.15814296961325336f, 0.6178055002669787f, 0.9745962891659915f},
    {0.045231431309095904f, 0.2912822693263659f, 0.5251146637035605f},
    {0.0031054160808989817f, 0.39887621423053243f, 0.9463614020148589f},
    {0.7195940009289904f, 0.41933558460668396f, 0.7598458364482221f},
    {0.4624492852650499f, 0.4518418422906002f, 0.868775873986191f},
    {0.713652627669263f, 0.9863266343224021f, 0.8239972749310587f},
    {0.9601433515091368f, 0.2990931190516978f, 0.08295215884729412f},
    {0.7222033568251507f, 0.9501177883369679f, 0.4443750424344358f},
    {0.017790058580876567f, 0.9638727503750262f, 0.36978996792406704f},
    {0.8103447700013862f, 0.9552389669351203f, 0.23991498868006012f},
    {0.46612520652343015f, 0.7706675328728124f, 0.8065422229218142f},
    {0.09238024934203637f, 0.3116576491963977f, 0.10680139071611083f},
    {0.3691192665041432f, 0.2071065481220471f, 0.6602546336352644f},
    {0.5116029173654464f, 0.10835629179905326f, 0.7698222892337779f},
    {0.0795692483302608f, 0.6425422275607495f, 0.9455637474354314f},
    {0.7882762367555721f, 0.4223565736335211f, 0.9345961681989567f},
    {0.6062439922324816f, 0.7152321977397335f, 0.8240451635432285f},
    {0.33567174825158186f, 0.15483807257592896f, 0.8772287415528932f},
    {0.539743636298535f, 0.6969284793658751f, 0.9119228377882002f},
    {0.4613667760157799f, 0.8550077067274368f, 0.04056309318319573f},
    {0.10319327571720327f, 0.8352798134990339f, 0.38520877131593656f},
    {0.7695595416539328f, 0.3328006055693493f, 0.7238442749270169f},
    {0.039106766124886505f, 0.9898278442893119f, 0.12647337542410497f},
    {0.7637035219209387f, 0.9995361229411507f, 0.04504323996581994f},
    {0.13378431734810248f, 0.38850817625128664f, 0.5880351798903569f},
    {0.6525802598101136f, 0.5303422424876608f, 0.23659476429809512f},
    {0.13877421373898224f, 0.6829850200434366f, 0.46755385993994436f},
    {0.06027680481422926f, 0.64785594348111f, 0.6104031999037304f},
    {0.42744161013963844f, 0.9847646979947496f, 0.8495814543639801f},
    {0.05445247326265035f, 0.5382685728714475f, 0.9295621675088659f},
    {0.18357270310353113f, 0.10691121377195345f, 0.11540504091759562f},
    {0.598986384851254f, 0.04731683878991433f, 0.5362761089006844f},
    {0.855533288885323f, 0.7965110003001116f, 0.03597925740553842f},
    {0.08072488239960973f, 0.30967631532696094f, 0.7191268343283396f},
    {0.7295218304545986f, 0.5522570163471491f, 0.6733656495896988f},
    {0.9494214786626438f, 0.8313359707346074f, 0.21288415244116998f},
    {0.10827276980210043f, 0.3154683305288941f, 0.1589204205699717f},
    {0.6806380042767533f, 0.8226790856007135f, 0.43627863420665935f},
    {0.9298816773236566f, 0.8682952681453591f, 0.6115651563945327f},
    {0.2726683444729f, 0.9296705711594683f, 0.7167441936572496f},
    {0.5647263839361427f, 0.3970358254009382f, 0.8690812238615857f},
    {0.4655701362358937f, 0.7551754610588525f, 0.6700894182973385f},
    {0.03683602121909879f, 0.03423015450577305f, 0.4497252216478562f},
    {0.668213374146282f, 0.41235116041559494f, 0.9715589407506545f},
    {0.720036214278258f, 0.28943855201690316f, 0.09821832581043188f},
    {0.7198931753650947f, 0.7747691938064729f, 0.21638424006475565f},
    {0.731094069961714f, 0.34005886929198414f, 0.6476012984921249f},
    {0.912368064869813f, 0.1909768623381375f, 0.4923556465491852f},
    {0.08956839713886533f, 0.9424629638715272f, 0.8417903902027546f},
    {0.7265141978245188f, 0.8544011747458763f, 0.9052913498455951f},
    {0.6691861871865892f, 0.8499272564097563f, 0.8479927271624398f},
    {0.9937787235542924f, 0.9618212222251895f, 0.4297478600676501f},
    {0.9852238600200536f, 0.3114261447804898f, 0.8304815935218439f},
    {0.39778155228685486f, 0.6133124336612658f, 0.5033167800133095f},
    {0.2281395209375604f, 0.79713459725097f, 0.26666426082082273f},
    {0.44387497158196787f, 0.3883106488400391f, 0.5209848041041849f},
    {0.35278868018935994f, 0.2319025334481829f, 0.00526662294502267f},
    {0.3146403893079607f, 0.399387196743615f, 0.5008711030774479f},
    {0.1420289649152524f, 0.5151796111034266f, 0.4124062943779171f},
    {0.46499490195971094f, 0.19152071861357622f, 0.23524975551146365f},
    {0.766683014134723f, 0.5263588662435468f, 0.9848526098800209f},
    {0.41537681733159737f, 0.8304756924078242f, 0.5145231047953516f},
    {0.9182698078673237f, 0.9567273379632022f, 0.3417683124538873f},
    {0.8611529652798158f, 0.07130687724534546f, 0.584032453509096f},
    {0.9493781023553743f, 0.10300394918176992f, 0.08239213330834672f},
    {0.04568247269534986f, 0.987987118102302f, 0.6243939216875635f},
    {0.03242787813271797f, 0.3901072148139416f, 0.4037812619379727f},
    {0.39155489352776973f, 0.7660614531486707f, 0.10214468848292912f},
    {0.6577532321965678f, 0.12430288417052782f, 0.27742027198219243f},
    {0.4254264967610467f, 0.019411594483727423f, 0.40221455572106457f},
    {0.04414687365524095f, 0.11850449879846359f, 0.7925734904973754f},
    {0.9748765784583954f, 0.851253778959308f, 0.6877854646091923f},
    {0.9918000524098567f, 0.27202599166817854f, 0.40173666501990624f},
    {0.5767829691693005f, 0.20644650136816678f, 0.7791222658007723f},
    {0.08152171084209192f, 0.3238360132285856f, 0.042386818953337846f},
    {0.5205062870961429f, 0.03921982517009137f, 0.07579144213704159f},
    {0.11557933036825108f, 0.10935007715907452f, 0.5485030388532223f},
    {0.899883166489184f, 0.18958256598880707f, 0.9977908967664151f},
    {0.9566732825456384f, 0.7132954488284226f, 0.39741964877654323f},
    {0.5757824406141185f, 0.44826487510202495f, 0.47433015452728033f},
    {0.21275941513273422f, 0.9445830847883632f, 0.5181746964853587f},
    {0.2649009691496752f, 0.9697732294639153f, 0.5770428930821465f},
    {0.8600560964556846f, 0.8216533548669004f, 0.14634444381821188f},
    {0.2475528516869996f, 0.08588604577600367f, 0.6672367846086656f},
    {0.7581548801602694f, 0.5840003775623355f, 0.3868905955849121f},
    {0.6086684746514862f, 0.4625945266139957f, 0.7783565381095718f},
    {0.8604875885733532f, 0.9192956875618264f, 0.36484601918363135f},
    {0.46366989465930997f, 0.10261496679968152f, 0.16879984070598109f},
    {0.4691773419219112f, 0.23557710046748914f, 0.4562919553183118f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 7: random", "[votess]") {

  const int k = 127;
  std::vector<std::array<float, 3>> xyzset = {
    {0.6480455704617128f, 0.7009652946199577f, 0.7795102123397902f},
    {0.5855401137600749f, 0.2539573697212547f, 0.49249206667814627f},
    {0.7128862826098412f, 0.34693308594649386f, 0.2686300888667459f},
    {0.2424831677270235f, 0.9789929836382848f, 0.5360995117895034f},
    {0.10288826260307471f, 0.6232961303085784f, 0.28774430569288323f},
    {0.5038297432431151f, 0.03888238335540306f, 0.9442733016035261f},
    {0.27328519291898146f, 0.697173424536121f, 0.5509228419901163f},
    {0.8310268249199256f, 0.38362688711586257f, 0.8251781425820983f},
    {0.3950465028876221f, 0.3809266127122205f, 0.07022265923933724f},
    {0.1639453891752325f, 0.9217993629504961f, 0.5747569682043598f},
    {0.36086915369092254f, 0.8836026808044923f, 0.9518189803487536f},
    {0.60395622172903f, 0.24407141375897856f, 0.39880986796691764f},
    {0.35497352695545004f, 0.7410406041790271f, 0.34023197605750954f},
    {0.539121295442952f, 0.9198534795347171f, 0.5289402273243199f},
    {0.9729723335310191f, 0.7118307046891118f, 0.7034258141142279f},
    {0.16246146242362047f, 0.35210128725561873f, 0.6610933875812494f},
    {0.32416727295267855f, 0.8278028654909009f, 0.5876782594193121f},
    {0.961184090172817f, 0.11988200102076141f, 0.5672832908318087f},
    {0.8449365834383786f, 0.8573596756010916f, 0.808608175399936f},
    {0.8756075791120114f, 0.9006519914761814f, 0.9867096539826309f},
    {0.6254684635585197f, 0.8453406916032857f, 0.4584986127506411f},
    {0.8472740979860779f, 0.04842004280403844f, 0.017522653881947958f},
    {0.8228576568537297f, 0.7397706518084884f, 0.4317722049527756f},
    {0.8887132255443702f, 0.9329250187615908f, 0.21522788560153805f},
    {0.13787428797156698f, 0.2553258985280139f, 0.6437200308265265f},
    {0.6847781695684828f, 0.3058641020568921f, 0.0699702673224869f},
    {0.3795019901477604f, 0.43913598289926126f, 0.8395530491321544f},
    {0.6346817971186862f, 0.9824702814316576f, 0.5349048724614963f},
    {0.9819757935845104f, 0.10156709610694759f, 0.09107224984878504f},
    {0.26719827128294893f, 0.04985674748665925f, 0.12154126347748329f},
    {0.20048730629539746f, 0.9232771672971972f, 0.41987033300986143f},
    {0.36743271371113306f, 0.22323492513940146f, 0.5388957560451172f},
    {0.765981244852599f, 0.8536524387898375f, 0.9009439767887184f},
    {0.4348190209427053f, 0.4331593113824347f, 0.5943925631196397f},
    {0.7775527883388477f, 0.8575906263644338f, 0.9724062959589626f},
    {0.652713454568388f, 0.615761964368037f, 0.6827518925922803f},
    {0.2780114465048006f, 0.007151080602947668f, 0.647934323975237f},
    {0.22000084316339008f, 0.08644341049515225f, 0.5842211466558237f},
    {0.5259182099711918f, 0.8765719997560234f, 0.7135846396310175f},
    {0.593998727378058f, 0.5501097586662064f, 0.7350082979223749f},
    {0.03919379813764878f, 0.83603934158174f, 0.02844384965671476f},
    {0.9989272755999171f, 0.8170995783346657f, 0.7987967915026483f},
    {0.4840550497769458f, 0.1830898535627442f, 0.7919749850608594f},
    {0.6923406115118267f, 0.3692519743105389f, 0.2043875055475376f},
    {0.8317759466860846f, 0.9487641065458602f, 0.015405737058679425f},
    {0.3368760641447077f, 0.42158773416763196f, 0.9082788299037762f},
    {0.027222860824903883f, 0.16705328867405123f, 0.8364774359119667f},
    {0.19347119801380097f, 0.26692010654927467f, 0.11528901040655848f},
    {0.01784884353695604f, 0.6045008474642171f, 0.8996015321864139f},
    {0.20845768346762727f, 0.7537406041205973f, 0.2529950550132962f},
    {0.17353236542145356f, 0.6847369576114974f, 0.3690517041082164f},
    {0.14530043223818978f, 0.7585724717190483f, 0.6981320112636245f},
    {0.7476020478903849f, 0.9757795184672448f, 0.2223471726452254f},
    {0.013463526593584296f, 0.499741447367133f, 0.7912132198696809f},
    {0.018468292817186094f, 0.33647847302382683f, 0.333419684403118f},
    {0.559919442641413f, 0.03194785501995068f, 0.6967204440587024f},
    {0.5254620064214108f, 0.38541218232993f, 0.2734494508601477f},
    {0.17987104474179094f, 0.022178529149763815f, 0.5895921244808178f},
    {0.8680147099471343f, 0.6841349938307707f, 0.33342153078575165f},
    {0.8089893418336617f, 0.16564295950570251f, 0.33000406148221917f},
    {0.46933708248744965f, 0.9919419614496986f, 0.706436236724628f},
    {0.5725084983108573f, 0.06415754172770216f, 0.018433256355123384f},
    {0.14453391264507853f, 0.703067113041179f, 0.04802642454820505f},
    {0.27901003026980864f, 0.2904867769906857f, 0.48399658346193264f},
    {0.8605329382774719f, 0.9672326379033181f, 0.14737016157825944f},
    {0.9294142525458043f, 0.8511033821332862f, 0.8680653539104676f},
    {0.16085509172435275f, 0.002155658832381002f, 0.18532066369186595f},
    {0.4357584557843259f, 0.18866686623419582f, 0.5110869362894548f},
    {0.930901668101433f, 0.72052250003004f, 0.750248351455916f},
    {0.43849083858110693f, 0.7888780115020846f, 0.5495217679344369f},
    {0.9762660133674536f, 0.17381289733535432f, 0.5598400500869033f},
    {0.3358416165923772f, 0.7487668106073492f, 0.9659501647970615f},
    {0.4969844873177258f, 0.5762866447788872f, 0.6848180325646037f},
    {0.594092244163401f, 0.40636647407644566f, 0.8231376826674738f},
    {0.5276618178660735f, 0.6867463455093574f, 0.6160401786935562f},
    {0.48813121952266825f, 0.84410212420293f, 0.6209746865658294f},
    {0.29961595614320846f, 0.17501141951627264f, 0.9949090289720426f},
    {0.8153074415134639f, 0.6198087496826309f, 0.14522507075980828f},
    {0.5455467399045653f, 0.986543516073442f, 0.8608654483997572f},
    {0.0638550132645005f, 0.145316989844821f, 0.9910110561496394f},
    {0.9231298922551014f, 0.7355974873817119f, 0.7461785350148148f},
    {0.1343439446507103f, 0.5147711147310787f, 0.6273693015706109f},
    {0.7271612625441959f, 0.17377218303376307f, 0.934914807787077f},
    {0.66273770598304f, 0.27341816535153485f, 0.7583198720524463f},
    {0.9365732948678616f, 0.5404214910611491f, 0.25829259121343906f},
    {0.4835808020035247f, 0.6562791493989129f, 0.8035100095161719f},
    {0.08982860215386335f, 0.456767966314668f, 0.061575036741851275f},
    {0.3998258434457794f, 0.4637286977709808f, 0.15233186058454495f},
    {0.21981103919072742f, 0.07181746916866039f, 0.4568893447645852f},
    {0.1876460697295138f, 0.8114964680834277f, 0.5949440818371365f},
    {0.6341371958737981f, 0.1614697040313785f, 0.9042944346658554f},
    {0.8536922645362844f, 0.20700074917605304f, 0.45887044712495995f},
    {0.9259480263818856f, 0.2224879575979125f, 0.9907632729391548f},
    {0.12758907236596317f, 0.8215501973277274f, 0.46056504469770576f},
    {0.6983591331883391f, 0.6571519168814735f, 0.8750967635245519f},
    {0.3126322154438772f, 0.043097431554615984f, 0.9802177926239549f},
    {0.8020291862044421f, 0.5123814914522818f, 0.5089598605136177f},
    {0.4246980853637057f, 0.34650735259331045f, 0.5453465190937916f},
    {0.44221364582435363f, 0.1721452019548565f, 0.5693084842340592f},
    {0.47077754734909694f, 0.7318288879864736f, 0.40912721930306395f},
    {0.808368953930678f, 0.7069506842581641f, 0.08292204112397061f},
    {0.19970702889668623f, 0.029810319740500968f, 0.4047309855248511f},
    {0.5423529468427557f, 0.5606728035640336f, 0.3629816372376168f},
    {0.693365595101746f, 0.5523746310293319f, 0.3855381735682496f},
    {0.534727610502356f, 0.7807957289607861f, 0.16433907250626767f},
    {0.28041220292350444f, 0.9268637069973577f, 0.898695235656108f},
    {0.40698213013068496f, 0.6129428489531371f, 0.7045688166662151f},
    {0.985824822801687f, 0.8492924456448881f, 0.5053777247133872f},
    {0.05119878251944887f, 0.4091381063396492f, 0.04454923351216433f},
    {0.2717061030721091f, 0.23294574997245854f, 0.45078472449572715f},
    {0.7463075055028132f, 0.1520844933303046f, 0.723381534415144f},
    {0.9540560671921948f, 0.33997795005564757f, 0.6896397127789622f},
    {0.7281682301435798f, 0.2916205293491001f, 0.3734234199614891f},
    {0.5359074115291647f, 0.1130925560416759f, 0.1035202145459927f},
    {0.47393425966628366f, 0.07419351187792134f, 0.47593468673143524f},
    {0.20305632901830228f, 0.29078397843166937f, 0.4583615964853974f},
    {0.16165468926865345f, 0.08240240646727315f, 0.02348101829020155f},
    {0.8640320544111177f, 0.03184710921973144f, 0.13008326120790925f},
    {0.46225208570198395f, 0.403912941935339f, 0.4911351755725134f},
    {0.043699549553241845f, 0.9803446047798227f, 0.3489636754029205f},
    {0.38302293817963884f, 0.9913961111484775f, 0.47958664240390725f},
    {0.8878163339586167f, 0.22553832189362422f, 0.7158277762989821f},
    {0.49257602878649387f, 0.6505758131833609f, 0.14347957250577514f},
    {0.5559689163403992f, 0.7713469900410447f, 0.5705369055912265f},
    {0.5980483711777154f, 0.641754790867916f, 0.4152843700041493f},
    {0.5377028629136082f, 0.7120928844770993f, 0.4042974781836023f},
    {0.00853169151888633f, 0.2054825333138789f, 0.42450352133842406f},
    {0.43765531628782506f, 0.09877126367899447f, 0.743217303288231f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 8: random", "[votess]") {

  const int k = 127;
  std::vector<std::array<float, 3>> xyzset = {
    {0.7085540026776955f, 0.5884481230804274f, 0.8035932557382208f},
    {0.5616717510120182f, 0.5450527736093457f, 0.014512326864917102f},
    {0.9294770472567959f, 0.4371939154579525f, 0.008970299436473761f},
    {0.8311715987509166f, 0.04577181862391955f, 0.7219567813014613f},
    {0.4101184627030966f, 0.6565319177920367f, 0.48070856482628854f},
    {0.49914183803640844f, 0.5658235578984715f, 0.637705674786431f},
    {0.9921421848546504f, 0.17366340997706786f, 0.575864381814472f},
    {0.21110664491251563f, 0.2547358104379265f, 0.26895270461193954f},
    {0.016274051246061183f, 0.7323806044921403f, 0.3193874892063653f},
    {0.057847501795414535f, 0.5014693913313206f, 0.720265467177848f},
    {0.4457924744932069f, 0.1567724084289489f, 0.9242046553288988f},
    {0.5999307261250771f, 0.079261275365058f, 0.7320335114596781f},
    {0.8373763840897392f, 0.7966811636229841f, 0.004243378087488314f},
    {0.7764353582955512f, 0.2557305300470033f, 0.9264591847166564f},
    {0.7543225580003605f, 0.6223326781787972f, 0.38353197251544746f},
    {0.7123994264209765f, 0.7326364270954497f, 0.49057666842729264f},
    {0.41258507086069196f, 0.5239680486835038f, 0.610892932330053f},
    {0.9371702645922332f, 0.7076010019367126f, 0.23637998487722534f},
    {0.33183642867782126f, 0.9395200568380335f, 0.7633435086305885f},
    {0.7617801525568052f, 0.05112402883240974f, 0.29000541620451026f},
    {0.5134198455415258f, 0.606187251783558f, 0.5937084548185783f},
    {0.4199461485131192f, 0.3589302623563866f, 0.3003449077383692f},
    {0.4002507608508077f, 0.5870036779915158f, 0.16735294675079526f},
    {0.20629460814922795f, 0.4630152484107808f, 0.7492948225204962f},
    {0.9966850875506736f, 0.11526178520103991f, 0.4596470055388677f},
    {0.7538448525951225f, 0.20943951783668757f, 0.9543341581894905f},
    {0.5887310336869179f, 0.7779285943938017f, 0.2713343103847895f},
    {0.2597398620111988f, 0.9903321993541583f, 0.42095623188430453f},
    {0.6250002698462799f, 0.33553774233860034f, 0.713669688517965f},
    {0.9768893464200581f, 0.8527017727983203f, 0.3299094438384028f},
    {0.6952760683244492f, 0.8736477925303691f, 0.5948961038486152f},
    {0.7425097540491505f, 0.1762540406157247f, 0.4678612200778183f},
    {0.09146878131827496f, 0.9115668904220434f, 0.781797025313154f},
    {0.022732147490007515f, 0.5381597483324294f, 0.1570064235458133f},
    {0.18724218046586927f, 0.7761018173970633f, 0.3000547764610614f},
    {0.08279551244302119f, 0.4171496655363429f, 0.6418048539940482f},
    {0.5624246574771194f, 0.4464532743886427f, 0.8275416375816947f},
    {0.28257493808411227f, 0.06460949246321945f, 0.9950669532709597f},
    {0.28223004646333216f, 0.8282373199027655f, 0.6714660337069205f},
    {0.2987648087671855f, 0.03718807473025043f, 0.2090668604596897f},
    {0.021551305290015033f, 0.8262320077793921f, 0.7049277361024421f},
    {0.16180542847585755f, 0.9178458166184367f, 0.7218732613756186f},
    {0.13022235966927487f, 0.8786832834121673f, 0.7048372371118653f},
    {0.11932043457911023f, 0.2601912575215982f, 0.5436937906955962f},
    {0.7469518506689273f, 0.7377491424070831f, 0.1532649717303104f},
    {0.53164383989705f, 0.7478333217902288f, 0.6639086889507136f},
    {0.9111869598543229f, 0.22480857863801895f, 0.05774896044079303f},
    {0.45402108176361666f, 0.5733471527615267f, 0.5375680053161613f},
    {0.4001431410813062f, 0.8948748806512852f, 0.7866072951712005f},
    {0.02217913540408789f, 0.27214360542584126f, 0.010069068531457503f},
    {0.4459476454617537f, 0.1166855201350595f, 0.45804617102120926f},
    {0.7379756471295428f, 0.13437168336317484f, 0.10006857483692877f},
    {0.43543678931023944f, 0.6814564577186824f, 0.5435645064613489f},
    {0.6786981620415458f, 0.8232070220868168f, 0.7461271233139584f},
    {0.7108999200653457f, 0.4008391987466964f, 0.763958983550926f},
    {0.7703853511203199f, 0.2066383226080517f, 0.8029877867271507f},
    {0.23260802455827934f, 0.6568932802227891f, 0.4459970115450128f},
    {0.7505633573619347f, 0.34226113598541774f, 0.8198810500100919f},
    {0.31240840268026315f, 0.6884658855774514f, 0.48808433854714695f},
    {0.5506957230496997f, 0.6425877312149422f, 0.722462586393823f},
    {0.6749885388145768f, 0.9428287383866403f, 0.1959511252970123f},
    {0.43150680277850584f, 0.1671604511390029f, 0.21709302874793224f},
    {0.12974809662867326f, 0.5381935235277296f, 0.037416120174501244f},
    {0.6625428122779149f, 0.8901382803934251f, 0.585233129798718f},
    {0.8690882781022164f, 0.4735934186872175f, 0.04769385939827275f},
    {0.9150726540700925f, 0.5919215996223673f, 0.43923643600513285f},
    {0.9861599065712604f, 0.4673630179631991f, 0.6646300795460736f},
    {0.2140560279649356f, 0.955763680717837f, 0.013517761531773309f},
    {0.23528800998110166f, 0.0005100790365716312f, 0.8846718126049404f},
    {0.9511014788753238f, 0.530073824639192f, 0.3572722930428508f},
    {0.1365014946913391f, 0.8031471561969867f, 0.5942725605545472f},
    {0.8868363560776348f, 0.5049583769633514f, 0.9748954787016441f},
    {0.23244831831014567f, 0.47737971504474175f, 0.2834341733504804f},
    {0.29979547947279084f, 0.8940127050043966f, 0.9490109560789531f},
    {0.7247256462424059f, 0.7836338170541717f, 0.08080919833689415f},
    {0.8488609431957412f, 0.7449103688741592f, 0.06182560701448303f},
    {0.7064623810804804f, 0.5417837279612038f, 0.8352166587581703f},
    {0.8499130513251351f, 0.1556385720438458f, 0.9045514068517746f},
    {0.3227323897182647f, 0.03278589310766655f, 0.45991545075855256f},
    {0.2097442258345038f, 0.0793531738458545f, 0.1477252762035296f},
    {0.47434744804249473f, 0.15366469324463583f, 0.04017946921613569f},
    {0.9703865383454713f, 0.0847461568025164f, 0.5997686036013479f},
    {0.3770692474834355f, 0.18158862838551693f, 0.2768335383765059f},
    {0.28598041143057595f, 0.874070752195772f, 0.5298923741446496f},
    {0.29687028811369265f, 0.11610208801365718f, 0.3822659887792714f},
    {0.24109207762985885f, 0.7986483396681159f, 0.6424922661059647f},
    {0.13779942785192423f, 0.8474454551593289f, 0.7240346910629716f},
    {0.9651888364183309f, 0.467228994402032f, 0.6374130014819824f},
    {0.2656085635659279f, 0.32154947697780456f, 0.136998863662539f},
    {0.09458629537770036f, 0.6513128985557031f, 0.024322904898044118f},
    {0.0740300111237796f, 0.33544397650801516f, 0.15227583708611858f},
    {0.5452288868599935f, 0.8102039378168923f, 0.12290968912249345f},
    {0.6258986316729576f, 0.25876325268736555f, 0.9432833043212877f},
    {0.43081431262021785f, 0.7737307126609662f, 0.4459321596083555f},
    {0.23451128943033006f, 0.02195307406783986f, 0.059759770352918684f},
    {0.779317023884458f, 0.706865831898016f, 0.3297611239620154f},
    {0.269902740654979f, 0.5391426224775993f, 0.9866136895828111f},
    {0.46940436631094573f, 0.0610997528985423f, 0.08035543534559142f},
    {0.9654189760413289f, 0.17084132692324372f, 0.6572974588104538f},
    {0.9427116531006183f, 0.6922274849706386f, 0.9866012275950852f},
    {0.5910866207733202f, 0.1913056669055303f, 0.822693695765074f},
    {0.8371794549481809f, 0.3583771241098581f, 0.9733577965314442f},
    {0.7316422730418033f, 0.01576318516578168f, 0.6805128297617637f},
    {0.2890107061640145f, 0.4333617778884641f, 0.6918024212654986f},
    {0.20189779370155103f, 0.9865825385376337f, 0.37978943753535344f},
    {0.6147748837151309f, 0.7387835991618875f, 0.23091409792799722f},
    {0.016652290517862434f, 0.8111604409551934f, 0.24128436689927968f},
    {0.18022361854714108f, 0.5624138150053529f, 0.25633367704493093f},
    {0.9645865927568016f, 0.7345992445625044f, 0.11299913797687944f},
    {0.21856644932392955f, 0.6810480010840126f, 0.17624388439059036f},
    {0.4112937098366698f, 0.6871097774689547f, 0.5266747390680833f},
    {0.9748700565656452f, 0.8074880023894421f, 0.5181250196890217f},
    {0.11566416689753167f, 0.9789739222153049f, 0.4501549451250898f},
    {0.41706502416005287f, 0.2794662896554001f, 0.6321979358057382f},
    {0.16933006246955506f, 0.009397963890748207f, 0.32159960261232157f},
    {0.20989012936082696f, 0.17491264422185526f, 0.014363834336691084f},
    {0.08860635747357848f, 0.5703185013241214f, 0.6470000309438116f},
    {0.6708136508247814f, 0.7181974469053007f, 0.840656697739583f},
    {0.8224056626038292f, 0.20078799166543093f, 0.8436619992072019f},
    {0.7542648172875844f, 0.9095334934169321f, 0.41040753985512246f},
    {0.05156962299790735f, 0.24722843425391838f, 0.39531461891783826f},
    {0.813558441236768f, 0.17172895669283272f, 0.23612511750296628f},
    {0.6447195628007875f, 0.7772781477459736f, 0.904943223746253f},
    {0.03552298545518906f, 0.64401994298682f, 0.047829543929420626f},
    {0.8410419930967687f, 0.254884631471479f, 0.9969569072068408f},
    {0.1942931407641012f, 0.4872712118106042f, 0.21681394929551956f},
    {0.4510056113329065f, 0.8326323355745924f, 0.7440945531904078f},
    {0.6328909976640321f, 0.09665541382341958f, 0.9841664048365746f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 9: random", "[votess]") {

  const int k = 127;
  std::vector<std::array<float, 3>> xyzset = {
    {0.5966080717507484f, 0.17817218261075451f, 0.6561344439746352f},
    {0.6911954705943849f, 0.6172853996614281f, 0.4596373129282443f},
    {0.16594751366439786f, 0.72371763308939f, 0.5908770400968131f},
    {0.6319419433860934f, 0.15838714935352838f, 0.5034709382525541f},
    {0.7613234322808076f, 0.3856373709666563f, 0.4847849641255829f},
    {0.5724499665228848f, 0.24409013178562244f, 0.7277886563521686f},
    {0.9850504717265062f, 0.4724185513322088f, 0.14895113330328158f},
    {0.7124831185377658f, 0.6158153582232926f, 0.5376572570616801f},
    {0.7274544798762411f, 0.48672734295804165f, 0.6778192977462657f},
    {0.32319808583911347f, 0.6532921457644443f, 0.9067841227577601f},
    {0.3378972405512033f, 0.2013786500788236f, 0.6135501279868606f},
    {0.12589732394307884f, 0.18525642969191247f, 0.38311310196032067f},
    {0.536177915054626f, 0.3944385233762664f, 0.063837762575506f},
    {0.40584757905633495f, 0.3676800697681524f, 0.3044321629571882f},
    {0.5062695004698615f, 0.5864214007832036f, 0.33060689710032287f},
    {0.43053139533643914f, 0.2400585643030435f, 0.16454690556553064f},
    {0.18235450193888214f, 0.024004791262283276f, 0.4846350100627955f},
    {0.9647721713973978f, 0.8534721711444101f, 0.8141378740459754f},
    {0.9983957472339522f, 0.4629251258737531f, 0.8987360332634582f},
    {0.8231308804874072f, 0.6499539502187025f, 0.9773738395630506f},
    {0.9738308160635424f, 0.5873803771274745f, 0.1647727670894411f},
    {0.6942327241176253f, 0.8973341954248678f, 0.2023901867222746f},
    {0.18168000925190586f, 0.3951463270539739f, 0.02827021659588791f},
    {0.6694637892336176f, 0.6032452114716957f, 0.7952305828459653f},
    {0.7541119013795266f, 0.21843960205866808f, 0.6042663259610266f},
    {0.7987514851357707f, 0.3778659026101474f, 0.1506649795080086f},
    {0.5463126181908278f, 0.16759709583235916f, 0.4494494445465158f},
    {0.8904232608827207f, 0.35748860187261f, 0.8919491508261882f},
    {0.5432408260636215f, 0.9054722796316738f, 0.47913805242273055f},
    {0.6064786487696432f, 0.14406237968427282f, 0.8967074385682582f},
    {0.3034381337212264f, 0.8565996578770348f, 0.7589694065307251f},
    {0.6635682319602401f, 0.5991764252301233f, 0.46515111224970884f},
    {0.9162312290256225f, 0.6383960387656503f, 0.01834799190114489f},
    {0.23680502387949953f, 0.7469139651779979f, 0.7193323398004936f},
    {0.9704506255696601f, 0.8605635279417927f, 0.4349093291037607f},
    {0.26801957629554407f, 0.13240519928097227f, 0.2629035415641845f},
    {0.19911226723562114f, 0.060722627327305934f, 0.980962275385557f},
    {0.4619632554915666f, 0.057342429234572445f, 0.34016398499860434f},
    {0.24102790205111013f, 0.7782168455128571f, 0.34974729659954995f},
    {0.5035539778184184f, 0.23440216820753224f, 0.027553050436019078f},
    {0.40429235035917255f, 0.026521017997985896f, 0.9964027953067772f},
    {0.6119302236287943f, 0.19637307663135783f, 0.5683659157604425f},
    {0.23288983915029027f, 0.48192230273669323f, 0.3786402695059695f},
    {0.5923711733038117f, 0.6843182975985264f, 0.007536631730596155f},
    {0.48871706932555614f, 0.7761592848798116f, 0.022995861662688633f},
    {0.5488593312109644f, 0.9941403133162746f, 0.6428571016315138f},
    {0.7296286864889959f, 0.8719895483016944f, 0.7104484206764098f},
    {0.32226484947373146f, 0.647793881529958f, 0.8614431949427983f},
    {0.44315626698407384f, 0.20937962456436532f, 0.32671517363103053f},
    {0.7404956338580674f, 0.578491566257635f, 0.9614725222800138f},
    {0.8638319818647575f, 0.08608156042242876f, 0.4966040725821971f},
    {0.7818824399027108f, 0.8113289400205763f, 0.194436596058425f},
    {0.8116153475454436f, 0.12024919756136654f, 0.0364679285897368f},
    {0.35362103487538854f, 0.8905576107458414f, 0.3385379056542337f},
    {0.5518211319713775f, 0.053413817984971024f, 0.07373645765937498f},
    {0.06151808928652358f, 0.23775405280904016f, 0.44401102344864707f},
    {0.7290953897334284f, 0.13388124038108162f, 0.7786295970279454f},
    {0.06058879609166634f, 0.7508931664696529f, 0.09041151361882227f},
    {0.6395318980003124f, 0.41735686036036923f, 0.10857281260249363f},
    {0.26465598545702007f, 0.8494840349921979f, 0.09400777200065802f},
    {0.9456079570356634f, 0.24958238941460043f, 0.08880599835538538f},
    {0.2718780747132239f, 0.7293452080202525f, 0.5119758205796402f},
    {0.8358629412865375f, 0.3025811747010122f, 0.051217246512417436f},
    {0.21803993693038604f, 0.1264192495316242f, 0.6463973762577536f},
    {0.7667978823724986f, 0.6005125147165045f, 0.9434998905092696f},
    {0.794077227241055f, 0.10323200006843825f, 0.7407845807741409f},
    {0.8254307396275252f, 0.8263102889801927f, 0.7209998828795694f},
    {0.08114962535218218f, 0.4137408849638198f, 0.9126826106498394f},
    {0.12268205630573181f, 0.21869251041413595f, 0.45569125160855484f},
    {0.9405102736787858f, 0.210410711247769f, 0.5014232314152752f},
    {0.09090356955906731f, 0.4093767190369244f, 0.5211872516339762f},
    {0.799604311591685f, 0.7825747497112568f, 0.7314901627693408f},
    {0.9836418882970882f, 0.3467779897852249f, 0.6382893000966954f},
    {0.3540902429719247f, 0.5018869782382955f, 0.6977644313038377f},
    {0.7595552751613679f, 0.8013821491368146f, 0.06661862891945591f},
    {0.21696146556132434f, 0.20526582675200278f, 0.13097806246033694f},
    {0.706360236545783f, 0.027009821106424803f, 0.5266958570719085f},
    {0.325221853207872f, 0.6071531391655566f, 0.7234141572282848f},
    {0.1848571250833414f, 0.09825515922784256f, 0.23213659589789892f},
    {0.06222924627075421f, 0.5451497899058955f, 0.018044100164647414f},
    {0.2054257760312853f, 0.5565096407249014f, 0.6176070465945093f},
    {0.6835434961697501f, 0.2661472056607588f, 0.2784994616805688f},
    {0.5004576884437402f, 0.37346726868478874f, 0.4420972852982269f},
    {0.9500032213098174f, 0.5407815118400521f, 0.43572212894544393f},
    {0.8425408349505082f, 0.2697079641652167f, 0.6344543085993594f},
    {0.826596019856254f, 0.03159865008395424f, 0.2487280018008774f},
    {0.06373020446380517f, 0.6514354325225243f, 0.051189599810312014f},
    {0.35596017614359476f, 0.6215988088297347f, 0.4056469473754797f},
    {0.1687383981410876f, 0.5435962445158237f, 0.021488024393569338f},
    {0.57804373201446f, 0.8775047592016795f, 0.35339439120469884f},
    {0.18752399422625532f, 0.6588844075426378f, 0.3311900887213143f},
    {0.8490297861097945f, 0.2074786759144127f, 0.6971587030021302f},
    {0.10732163744134149f, 0.3684580631166462f, 0.1089399598024311f},
    {0.9582143248137993f, 0.6493547533000809f, 0.4281844128888519f},
    {0.23078619366493758f, 0.4769993421839812f, 0.5345474262698495f},
    {0.5754915651532807f, 0.16461982234060302f, 0.5940808162910358f},
    {0.4378943822215078f, 0.2368258053886142f, 0.6596637549544642f},
    {0.30796862477317744f, 0.3463759011869899f, 0.6435188056886476f},
    {0.12122834719199393f, 0.10423853636088021f, 0.715117026626427f},
    {0.6507886797465455f, 0.7731171992083893f, 0.14994214844151954f},
    {0.8892687511465841f, 0.9566256434731013f, 0.5411305961595754f},
    {0.5203983902966257f, 0.2848725073364946f, 0.8576100181643758f},
    {0.016477472107665148f, 0.07304706052509469f, 0.7255236238956695f},
    {0.7603671638460836f, 0.30111440743050566f, 0.682311443237156f},
    {0.08657525842757474f, 0.20169096248167473f, 0.2625617547612732f},
    {0.6313137321280466f, 0.8683284066656511f, 0.500365042077115f},
    {0.6982325528051242f, 0.1775687125029657f, 0.4692377884457378f},
    {0.4624037633942655f, 0.18403689620377017f, 0.18501046151257106f},
    {0.12142842945992605f, 0.584588302761027f, 0.9175937980973871f},
    {0.7677457192272775f, 0.2665707109414809f, 0.5713594401886052f},
    {0.8963310408132312f, 0.006961478814648592f, 0.9892552914749313f},
    {0.42487526892836425f, 0.7248442122845712f, 0.2329878993090203f},
    {0.1973168804123926f, 0.2575799672804777f, 0.428014195994436f},
    {0.020375924603576068f, 0.13287139483919785f, 0.4943058830792437f},
    {0.285778027744793f, 0.09429959604715143f, 0.4291802702216475f},
    {0.4084785814709304f, 0.022869007623645077f, 0.23343204868292777f},
    {0.2547476680406632f, 0.5056073391102525f, 0.7753491258576864f},
    {0.8267086633496953f, 0.7301798179223248f, 0.1413419260801021f},
    {0.6063839875313534f, 0.03626266086656993f, 0.9072152881081733f},
    {0.10126292299780582f, 0.4592852493345492f, 0.06706761317750398f},
    {0.44708656391209345f, 0.6231026804783144f, 0.47599262494305994f},
    {0.2507769483584289f, 0.7495067635277499f, 0.4570551453114805f},
    {0.967745153030368f, 0.18062327408109757f, 0.3945135715957484f},
    {0.42529774202497383f, 0.8614759209697331f, 0.5506945911536887f},
    {0.23611685952073724f, 0.024785427544162908f, 0.543852176320604f},
    {0.85149030799756f, 0.27869117907686936f, 0.272019424717054f},
    {0.5513085120087654f, 0.6085996104800097f, 0.3311530447429346f},
    {0.8725078259733736f, 0.07571113822663422f, 0.04477317794361191f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 10: random", "[votess]") {

  const int k = 127;
  std::vector<std::array<float, 3>> xyzset = {
    {0.08157829861772381f, 0.7070585517247621f, 0.686598694945001f},
    {0.4244567411896999f, 0.4376566049693932f, 0.6825600858953818f},
    {0.26880754481775393f, 0.9806843601911457f, 0.6917571444328624f},
    {0.613934101058985f, 0.7544712795620191f, 0.4065848185023171f},
    {0.33585616896043513f, 0.8851100011667372f, 0.8820353781949373f},
    {0.8532475723737887f, 0.8477304092877441f, 0.05167945370542204f},
    {0.6414042357259596f, 0.908210012278127f, 0.4935464503848481f},
    {0.1477962547702144f, 0.1186409351619393f, 0.5419159058508713f},
    {0.44047410718104074f, 0.44829253322287277f, 0.5253694304433716f},
    {0.309919898612805f, 0.3303909804299955f, 0.10659946393253317f},
    {0.4543794226011747f, 0.3881611349911017f, 0.9592453041510568f},
    {0.8243150934648503f, 0.38780071550263717f, 0.06864478487874526f},
    {0.022718176247659705f, 0.14771540082955592f, 0.6863279120875698f},
    {0.21163110756030756f, 0.2825163972741994f, 0.878325162649821f},
    {0.7464346742352785f, 0.3045851969442035f, 0.04405564731827327f},
    {0.9803437464294337f, 0.14239610842456496f, 0.30149061890003703f},
    {0.12647178826652639f, 0.3164533002962462f, 0.21825226383402518f},
    {0.5558815692517772f, 0.9324786237542149f, 0.6231672953818157f},
    {0.984704408062279f, 0.34723626638397265f, 0.004836465569945547f},
    {0.13668873332024922f, 0.5781225998479015f, 0.688554566040286f},
    {0.8944299578977256f, 0.0931117969776114f, 0.785401882261629f},
    {0.16848626985645787f, 0.610258481355715f, 0.3616010919204251f},
    {0.9077172034495414f, 0.9901200547288935f, 0.3657491306188899f},
    {0.5559174926735158f, 0.8477076583178901f, 0.41501407090923403f},
    {0.9398547007162833f, 0.392089724579202f, 0.8791328703253525f},
    {0.823420696832125f, 0.1893583423639995f, 0.698983078910143f},
    {0.7517389448838339f, 0.6448840473217158f, 0.6871541426309583f},
    {0.4368631027868146f, 0.6626020578440082f, 0.854817286876605f},
    {0.8689648952595882f, 0.308916284876502f, 0.3259198978607969f},
    {0.9028120082842774f, 0.3949711239757189f, 0.06119765363874008f},
    {0.49345354419221754f, 0.6385708183388087f, 0.07150205238242302f},
    {0.7500190375989453f, 0.5029607166584549f, 0.7850446269613803f},
    {0.6632251586974398f, 0.40432229030063727f, 0.5536882855216239f},
    {0.9256637978689017f, 0.9022684701864004f, 0.4479204625078933f},
    {0.19562869202212285f, 0.3151431333842313f, 0.6017381401769204f},
    {0.8309097293333683f, 0.883167928258251f, 0.4487769781537876f},
    {0.13955460923414398f, 0.05275574628777324f, 0.6559975679540796f},
    {0.08458105268222549f, 0.3148734426027967f, 0.6071472349463832f},
    {0.6694788931405248f, 0.4297539156047142f, 0.0470664565724872f},
    {0.35396978314822913f, 0.330190650538041f, 0.9640691542347393f},
    {0.719522755392816f, 0.358862677117172f, 0.1791199284083318f},
    {0.06365801846676367f, 0.1313588548118474f, 0.21793616460654364f},
    {0.3200609881529277f, 0.9829390679205549f, 0.14007285379717305f},
    {0.6104982184937618f, 0.05024006824889071f, 0.4020876238775991f},
    {0.17991396593588027f, 0.26147972220193294f, 0.4037460640889251f},
    {0.13671604456966058f, 0.7702577358135182f, 0.10984345850553878f},
    {0.7192687728714436f, 0.21365014775644864f, 0.9931985986734054f},
    {0.20443215824294636f, 0.5767234197251677f, 0.5541089818333279f},
    {0.14800699312618026f, 0.9582195361406527f, 0.4419137395308874f},
    {0.004206632921644138f, 0.10076787478398819f, 0.655025560392573f},
    {0.5158241162527938f, 0.8731318016821561f, 0.9406789006010104f},
    {0.8432400619500222f, 0.7574281249750656f, 0.9750541183154692f},
    {0.4967591530513088f, 0.6841258658212962f, 0.9379474280243161f},
    {0.14883046329231375f, 0.9101149490160015f, 0.9629127050542258f},
    {0.8655015064657078f, 0.24917439770542393f, 0.7511342521383569f},
    {0.03010837997451077f, 0.5248343365915695f, 0.15723155455720106f},
    {0.15612472128640842f, 0.7904562685288505f, 0.49506225482469923f},
    {0.18958287308360156f, 0.20684342086439766f, 0.052801071839964964f},
    {0.13339920424268548f, 0.6769127762364722f, 0.4094922599555073f},
    {0.490838433413912f, 0.5475720262526377f, 0.09265210796906664f},
    {0.5846995873862616f, 0.24243902152870678f, 0.33659232667505534f},
    {0.29398144496891343f, 0.4807282866670637f, 0.023151660470990598f},
    {0.28028887034414096f, 0.32626479490331173f, 0.5305435549180706f},
    {0.5017233985006865f, 0.6041107175462664f, 0.46371790223655274f},
    {0.42480942418103607f, 0.401950114675784f, 0.2060299421578048f},
    {0.6395424007791431f, 0.41324021270104505f, 0.638948649783589f},
    {0.8763543877354802f, 0.09852429057549306f, 0.6722670503776995f},
    {0.48871449501802045f, 0.0235301928441789f, 0.9531099175674728f},
    {0.14586655115584302f, 0.9337376007102843f, 0.589586020598896f},
    {0.22217064572391032f, 0.19831263108555452f, 0.8133529109602637f},
    {0.1671049788707193f, 0.6798384402198108f, 0.5271755137626969f},
    {0.6274827686199337f, 0.4633734057673795f, 0.9173044446087847f},
    {0.5854591384258523f, 0.3004688319807858f, 0.11069424311418707f},
    {0.7206138774718285f, 0.6182763798653307f, 0.9973488656215568f},
    {0.7851806301964444f, 0.14881858817850424f, 0.04821469855592386f},
    {0.8397087360277348f, 0.6137095677153673f, 0.08066553032279289f},
    {0.13154914541441665f, 0.3145818490808565f, 0.4380830948705198f},
    {0.887990860672026f, 0.8172010998774657f, 0.46442210820589314f},
    {0.4661114216255553f, 0.5536135898909376f, 0.19295083761808351f},
    {0.22063790142674533f, 0.5023541564984394f, 0.7688569351774448f},
    {0.9203245983562881f, 0.016417387784623427f, 0.3354691731005479f},
    {0.9702998565109999f, 0.14354156707986532f, 0.8022299468110221f},
    {0.5626535728262673f, 0.09946294835644631f, 0.3810353225418176f},
    {0.31378664415859014f, 0.12098617476177487f, 0.5899018883150908f},
    {0.8746337211642351f, 0.12794606978632428f, 0.2505942292796124f},
    {0.29047627579947466f, 0.11172921655307555f, 0.839557706062135f},
    {0.8655658168985142f, 0.6320647266544128f, 0.7277342885016108f},
    {0.4381657570682146f, 0.19507368716797446f, 0.5331071512939596f},
    {0.8805171556884983f, 0.6545880449114332f, 0.363685067693696f},
    {0.8172202085180279f, 0.4395230018547218f, 0.5660295051907986f},
    {0.11186822919605288f, 0.39527278444560154f, 0.8220539186470939f},
    {0.6437112619664037f, 0.14330839432364717f, 0.08759383345498228f},
    {0.718182286016008f, 0.6917253815912672f, 0.3862737625890976f},
    {0.3606610429536702f, 0.3949140216401159f, 0.15994304227644496f},
    {0.8701538022589965f, 0.808597514159605f, 0.9014963492825048f},
    {0.6165599257855869f, 0.9672613040947231f, 0.11998854806835058f},
    {0.051429237700096664f, 0.52325187144294f, 0.3547654048773301f},
    {0.5059303671354469f, 0.08892656753352723f, 0.38494753660792047f},
    {0.6293044181441f, 0.524057430619297f, 0.00938877754137879f},
    {0.9731005858633127f, 0.7306890157227323f, 0.33157145743699024f},
    {0.6612578972491885f, 0.29792449154307077f, 0.19810888025341733f},
    {0.00977692371035166f, 0.6118034129904166f, 0.8801167919813399f},
    {0.1329573986845657f, 0.1517232790018841f, 0.10011542467997403f},
    {0.5062074010392151f, 0.026094668844358848f, 0.8327467599229651f},
    {0.8373177538754337f, 0.4857290243915606f, 0.8691800231790273f},
    {0.36030922284514066f, 0.30944855162453255f, 0.1519502992817452f},
    {0.23271755801999983f, 0.4733500706596425f, 0.8173719935250969f},
    {0.6427272995925475f, 0.2218954121160911f, 0.509176689325937f},
    {0.7438173531834247f, 0.5931616658378228f, 0.2444492989533843f},
    {0.9973619370927121f, 0.3722620122254994f, 0.3299389183413166f},
    {0.7014127607484547f, 0.46893831582714685f, 0.7884469759985683f},
    {0.09726077465628613f, 0.01363109339978874f, 0.19348928248683406f},
    {0.3303162576553804f, 0.10737334496341433f, 0.922091455054844f},
    {0.34702593862563713f, 0.06051159343420376f, 0.36947007717062563f},
    {0.817185921220663f, 0.010804350518045625f, 0.8656557593895172f},
    {0.8226392103126434f, 0.07877946973303818f, 0.1031240604465441f},
    {0.051120940957500305f, 0.2369387640194942f, 0.17588013171571681f},
    {0.7464733868306606f, 0.8922179112268069f, 0.03732037121816845f},
    {0.06486543655711674f, 0.13669976180705623f, 0.9118485862198101f},
    {0.7527751342287908f, 0.50153239618611f, 0.6905342071125782f},
    {0.3143731566742166f, 0.183584897643971f, 0.8993473292532183f},
    {0.35798721294092994f, 0.310049267263512f, 0.08602820423385316f},
    {0.7617673130096713f, 0.4275290027230174f, 0.5292346284579066f},
    {0.028310527661339124f, 0.5959845949167646f, 0.9816220060547187f},
    {0.03748388140735148f, 0.5685116461126679f, 0.8541537725476991f},
    {0.07674509639378402f, 0.4490618729223027f, 0.44509986822880454f},
    {0.053929543727345375f, 0.08508813696132289f, 0.5149605591285816f},
    {0.05958701472375294f, 0.8228912488247632f, 0.2265300868654131f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 11: random", "[votess]") {

  const int k = 127;
  std::vector<std::array<float, 3>> xyzset = {
    {0.3931287620568975f, 0.13993132145009368f, 0.016713264655829896f},
    {0.6112142449081069f, 0.6955629663213971f, 0.38922488489128715f},
    {0.5449881506340293f, 0.37792493457283227f, 0.3442413749475972f},
    {0.33828307043444883f, 0.6176084814762044f, 0.2886242124993187f},
    {0.7903237733888235f, 0.2793859861168341f, 0.06305522345200787f},
    {0.8573338763693633f, 0.5385839500560765f, 0.5254256919992352f},
    {0.5426148260553119f, 0.13721278945669146f, 0.12277460703163479f},
    {0.6161339497928329f, 0.8641677182494214f, 0.227073830932227f},
    {0.5901538268264137f, 0.7395446608629632f, 0.14243959473652823f},
    {0.8307970369386373f, 0.7875247287423024f, 0.6340852451433462f},
    {0.4392766068937698f, 0.5902462435938426f, 0.6638066732337554f},
    {0.9692619945533527f, 0.6870534258053939f, 0.696996739276745f},
    {0.7719031406867903f, 0.9971307417300667f, 0.9313315101677495f},
    {0.3469251901897934f, 0.06877041924315697f, 0.41799796297259195f},
    {0.989097132446991f, 0.7269420511727966f, 0.22431789134183655f},
    {0.41416732342946905f, 0.480304019254818f, 0.4976063217650599f},
    {0.2533695879272547f, 0.6806879796239605f, 0.06878018619395265f},
    {0.15812453576904695f, 0.05458158982689176f, 0.5237937662077318f},
    {0.8492812272819422f, 0.19678893199320047f, 0.37184238812432413f},
    {0.765841149790572f, 0.25564132953932805f, 0.30121016252946864f},
    {0.33994752954400764f, 0.4506067285488182f, 0.2344934546454358f},
    {0.3543051980549541f, 0.4489244127811276f, 0.4599066717279301f},
    {0.5525391329576498f, 0.33450194632675945f, 0.33672705640504774f},
    {0.8237942255596025f, 0.5464542065863123f, 0.6482040098239914f},
    {0.16990580843645597f, 0.13899644871105055f, 0.861875887007961f},
    {0.8096572379208591f, 0.7456676906221673f, 0.7025747798150654f},
    {0.6275413391933071f, 0.061863014459505705f, 0.4041225902710541f},
    {0.1142348251065951f, 0.22554781988571093f, 0.5329236080397167f},
    {0.634732130856565f, 0.5961648290471486f, 0.5381240682714552f},
    {0.4460601203264025f, 0.4122271788478147f, 0.8982565453914272f},
    {0.8751811278964261f, 0.07556984967869973f, 0.06569083742725135f},
    {0.3006795515448979f, 0.9035033472132851f, 0.7125130078047155f},
    {0.7932919347391258f, 0.29081644040846955f, 0.7514222411236836f},
    {0.4133585868818057f, 0.3976642126121861f, 0.2594058512005384f},
    {0.4058365691898629f, 0.39817663926171754f, 0.6720704588743972f},
    {0.6030849986873504f, 0.12319623898218846f, 0.5757166024911938f},
    {0.5229174224680911f, 0.5489838959708465f, 0.6583881456638028f},
    {0.5842094514755992f, 0.9278973591283635f, 0.40936344451915807f},
    {0.5190957184347882f, 0.13080032038482436f, 0.9237111720947786f},
    {0.5625447743988711f, 0.9079156372841921f, 0.2657050672178761f},
    {0.847369238582972f, 0.6954792950148952f, 0.5903642125787381f},
    {0.25506226329611326f, 0.7382529373559311f, 0.05849396681686281f},
    {0.22749275385003076f, 0.9138462481487793f, 0.001117221933840784f},
    {0.0045451699916626565f, 0.9781460769723954f, 0.8235748331872286f},
    {0.6967621552273756f, 0.6338011418548724f, 0.7202547064152781f},
    {0.7153098920443649f, 0.8540400645294767f, 0.9653382407854244f},
    {0.5663585009710416f, 0.5302959028153488f, 0.8710064199307023f},
    {0.29968515030166265f, 0.26781438926801715f, 0.43206647812443566f},
    {0.8194127645283356f, 0.22505110736561573f, 0.21849388156219263f},
    {0.3155518217885568f, 0.3822455865442351f, 0.15895909437336353f},
    {0.11441059448375812f, 0.7163612174248584f, 0.6141553915572205f},
    {0.14503738076635087f, 0.757721414668232f, 0.046654281233806216f},
    {0.4850341490668727f, 0.21975755219327409f, 0.020534930925739103f},
    {0.1097611524429204f, 0.8960841480348356f, 0.48904968116711056f},
    {0.6346245506077948f, 0.5825754673751011f, 0.5477220091002807f},
    {0.5105882951957983f, 0.31885748219484844f, 0.4145858339730293f},
    {0.6869452952985774f, 0.17122860631056502f, 0.8461983302431965f},
    {0.2602042948957525f, 0.14917505082419824f, 0.7665836701320229f},
    {0.2484946283405307f, 0.8635000811439764f, 0.8365394154640818f},
    {0.6274556600640174f, 0.6137866212662226f, 0.3356433995498499f},
    {0.5796749465129631f, 0.5315694781741358f, 0.021157615689748832f},
    {0.8671072343897218f, 0.8839925820223505f, 0.19552343727043753f},
    {0.6265011732194761f, 0.6118654780159672f, 0.05795598809382185f},
    {0.9476480428005006f, 0.7023195484352273f, 0.0007795406817902029f},
    {0.955933566762957f, 0.23567472864782002f, 0.09414718042164016f},
    {0.8101171127861878f, 0.9856381556539144f, 0.6882488355466553f},
    {0.21815557514636452f, 0.2980984719111661f, 0.8994235930554719f},
    {0.7469375912998293f, 0.9132170573249382f, 0.82906173647411f},
    {0.874353059236903f, 0.5971714054450703f, 0.5421026926648079f},
    {0.3623568343452208f, 0.0003055674445330281f, 0.29184913706800386f},
    {0.5894369878012895f, 0.3414855180490812f, 0.3816960853877476f},
    {0.0644028357003743f, 0.23795698933375664f, 0.054756567060762595f},
    {0.6916331615740187f, 0.7434691161770042f, 0.2285143773267665f},
    {0.7793877548071394f, 0.9930804658169529f, 0.5811385778536001f},
    {0.014451198787461372f, 0.04673310333989178f, 0.5269453544655729f},
    {0.9099833096257625f, 0.5393807991977198f, 0.21215856560997726f},
    {0.9161930798466367f, 0.07393145447083005f, 0.7637222187685254f},
    {0.18559784276066182f, 0.7498522679837932f, 0.4297533326165902f},
    {0.1012937320808821f, 0.8575824786573363f, 0.35958217684034244f},
    {0.2932898925477021f, 0.15517814396577756f, 0.046231070346679726f},
    {0.9331911408737461f, 0.8463662865952079f, 0.8555512182721586f},
    {0.23275068192984305f, 0.7451707214973712f, 0.11982140501248928f},
    {0.14583444587442218f, 0.5624764230586861f, 0.18540765487237043f},
    {0.6809315062431615f, 0.011420691630244617f, 0.03133796149983292f},
    {0.5716198785464973f, 0.6461793812328787f, 0.5428255703519516f},
    {0.06030533854123421f, 0.45115585541655023f, 0.732193687024677f},
    {0.12188514300505848f, 0.6920148214095817f, 0.3408586936755471f},
    {0.32112247882243505f, 0.18734819560726812f, 0.5211260445633785f},
    {0.6416645321950857f, 0.67695256863525f, 0.7779618616475289f},
    {0.6409328754992301f, 0.9123276249211629f, 0.6376366412515122f},
    {0.1409191668273203f, 0.38192677499658056f, 0.796977722837477f},
    {0.9525442705723843f, 0.1389550458419042f, 0.9747162517430861f},
    {0.2124867517129594f, 0.9499493963965033f, 0.04214478334262872f},
    {0.9071587554262639f, 0.25983488517377007f, 0.20556806442112607f},
    {0.0889591891969459f, 0.6998319628798847f, 0.05775741966214276f},
    {0.7869776806939204f, 0.6077875446387785f, 0.7466689340003282f},
    {0.3255347117185502f, 0.5984610028588052f, 0.6554845370238175f},
    {0.27434296901066735f, 0.8176878787587991f, 0.8599783334635639f},
    {0.2376693137141478f, 0.00037093875065385973f, 0.7974846360209301f},
    {0.8303530461380147f, 0.19735413993954276f, 0.9433101634889123f},
    {0.07219784594564882f, 0.7208017175454535f, 0.5575721543941162f},
    {0.6321550568807247f, 0.5445686078422665f, 0.6882631430482614f},
    {0.36839120559246397f, 0.006637243007820093f, 0.0025839310078293876f},
    {0.5574367211631378f, 0.6925036604212534f, 0.5956513870437056f},
    {0.17147153565503648f, 0.769101126175696f, 0.31774670525634663f},
    {0.3838201131509682f, 0.8185017702464623f, 0.09902374148862303f},
    {0.8809658182583614f, 0.9381211673372196f, 0.7354986924641639f},
    {0.3796671839793657f, 0.15853051093086556f, 0.6775881189870415f},
    {0.1974736452743313f, 0.7645870199628912f, 0.868886103912684f},
    {0.25907755986241277f, 0.7794598539967276f, 0.9082932888607409f},
    {0.8600628675493612f, 0.17646465776229936f, 0.016402686027277347f},
    {0.07952592166010153f, 0.8743327542887899f, 0.8193969396678114f},
    {0.41305363079589485f, 0.022815385901886143f, 0.5838832092249565f},
    {0.13826060423290454f, 0.6368757492634576f, 0.2456888254481887f},
    {0.6197406473434598f, 0.879626337848012f, 0.03354567732640257f},
    {0.05511220145105f, 0.20241075002937325f, 0.8848616756981724f},
    {0.35134201970020884f, 0.5764894258391297f, 0.9241175024884506f},
    {0.15948023442632997f, 0.8429415577926456f, 0.09670311084262218f},
    {0.8139358477159683f, 0.9039219596276475f, 0.9940163652905838f},
    {0.9254803845713031f, 0.18442462507125956f, 0.8656186551039358f},
    {0.06198719774893813f, 0.33025487020095823f, 0.45835552602564567f},
    {0.9143928650322407f, 0.46082634645821186f, 0.032383217538098696f},
    {0.8570297628685384f, 0.7611424503569986f, 0.014268368370220053f},
    {0.9044173697289523f, 0.7504429421687558f, 0.6123768000385656f},
    {0.27602621229217617f, 0.7496565295261611f, 0.08786392019462297f},
    {0.5672849016534828f, 0.862256591924222f, 0.12399193330677383f},
    {0.5907444125026609f, 0.4018050153906728f, 0.3668677790246343f},
    {0.7882479039113373f, 0.1008843489334007f, 0.4692321003306166f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 12: random", "[votess]") {

  const int k = 127;
  std::vector<std::array<float, 3>> xyzset = {
    {0.4086823234373327f, 0.03072532508048953f, 0.42380839446248775f},
    {0.5851735702131546f, 0.10023100383376071f, 0.7457207722033128f},
    {0.19794008459232593f, 0.3757700554226324f, 0.9127098109420425f},
    {0.11034080298608295f, 0.12192991237566819f, 0.7552340600080966f},
    {0.7345273316743669f, 0.30614538077069453f, 0.839517968702908f},
    {0.33653734145615377f, 0.19112245783199422f, 0.6145407211521579f},
    {0.1657763408784666f, 0.5389472537328742f, 0.9044678249016502f},
    {0.3138629329950474f, 0.9204574687399011f, 0.5808170141948893f},
    {0.9773162940235539f, 0.33035315099746654f, 0.527328918682555f},
    {0.47031197998072016f, 0.13964966836904158f, 0.18071804325745255f},
    {0.09139011257573226f, 0.4399299383165364f, 0.5976441514106612f},
    {0.1799378141165674f, 0.8288759426009589f, 0.9309063396053081f},
    {0.4214730651507478f, 0.6417625980966771f, 0.2797571089761268f},
    {0.19866855162855523f, 0.47288038484524275f, 0.16952198128849794f},
    {0.8263172217075698f, 0.926051653669427f, 0.38351070594594916f},
    {0.4825899680809197f, 0.9134436996472227f, 0.5154923372179447f},
    {0.8493725422362363f, 0.0718811898045163f, 0.029330623228839392f},
    {0.40008727946485156f, 0.023356568557131085f, 0.10952111155546718f},
    {0.2997461199877878f, 0.4149855003258237f, 0.1900897235071516f},
    {0.419084741666951f, 0.07097642321163378f, 0.3681721674337536f},
    {0.17585112925501356f, 0.8581736654986953f, 0.2360573939206725f},
    {0.17109773628982194f, 0.903855150468801f, 0.8626540002829507f},
    {0.5528905346696786f, 0.36755289962470916f, 0.27971897730193884f},
    {0.6662052832081162f, 0.179668763217796f, 0.034289304338498305f},
    {0.11365964980459031f, 0.04470783423360325f, 0.11713147844119398f},
    {0.6978012105084257f, 0.32296533003668726f, 0.6928128376034065f},
    {0.8933094410600512f, 0.5431061748135455f, 0.7047377717323079f},
    {0.7063621218928492f, 0.8794708228844675f, 0.6969607031420341f},
    {0.37278928541215495f, 0.08023891555338303f, 0.7271711808137443f},
    {0.3664003561129435f, 0.7400809425780311f, 0.7099661726736561f},
    {0.5375030506006784f, 0.21327123727355357f, 0.6128603896585948f},
    {0.4576517602520289f, 0.3120334502213221f, 0.9931585497221984f},
    {0.013295380572497129f, 0.9974722508240149f, 0.9472189185029125f},
    {0.13250244563624347f, 0.03217718556002391f, 0.5923874058446956f},
    {0.9684624351341088f, 0.21617733557990948f, 0.20198891652598372f},
    {0.058523212489586696f, 0.3834273703554798f, 0.6854220599153602f},
    {0.583218334529706f, 0.7729906057945432f, 0.4431299253808597f},
    {0.4698011073864078f, 0.12934190216712604f, 0.8038638833414916f},
    {0.7728949448369238f, 0.8898173701288548f, 0.3877255137708907f},
    {0.8784628319051347f, 0.11331348550731701f, 0.48402661556882753f},
    {0.8959609492492238f, 0.38860339549990963f, 0.6328753161043787f},
    {0.7272885370184501f, 0.6137299763389761f, 0.10640054619121897f},
    {0.10512868574605683f, 0.27908184775835476f, 0.6025827584396503f},
    {0.8691799162408679f, 0.9486275184385815f, 0.7643884373353834f},
    {0.7781846271070437f, 0.3566055807800578f, 0.41426145884220233f},
    {0.38533884270965735f, 0.9823388507396884f, 0.06952565916449138f},
    {0.3706817692554255f, 0.6555018025143123f, 0.7258029513153434f},
    {0.10032762962187669f, 0.8078480809020185f, 0.45833324067528414f},
    {0.9800110131501618f, 0.6343671624070333f, 0.2907560053548377f},
    {0.2336244268004355f, 0.22014789149325809f, 0.7894038924633853f},
    {0.006736809741656136f, 0.9023734383992636f, 0.3696561770192833f},
    {0.738974421875329f, 0.7846474082003205f, 0.3928032504070609f},
    {0.2768988633879791f, 0.9294653901570883f, 0.5904007022084321f},
    {0.18807111808137889f, 0.5848845307657492f, 0.46530606825788845f},
    {0.9767133678291887f, 0.06767000479192287f, 0.8294848735310912f},
    {0.263823173092836f, 0.11701444399117655f, 0.7769599054900264f},
    {0.3789738727935166f, 0.2645460451952055f, 0.9801301147243698f},
    {0.8729051490384836f, 0.09084777672786248f, 0.9958889346049951f},
    {0.0729716432004125f, 0.4613716802137594f, 0.368536554707081f},
    {0.7344945563374232f, 0.27748174961064576f, 0.02772185943162231f},
    {0.08976671391122337f, 0.9892203197451278f, 0.09633816954581709f},
    {0.16491871812738734f, 0.01895186786474823f, 0.5664748108919216f},
    {0.9209423551884611f, 0.7318377337629766f, 0.7696667586152259f},
    {0.16224883468114626f, 0.5204544065081664f, 0.5390296749113329f},
    {0.24721959659854054f, 0.24316813684690164f, 0.6092868396473226f},
    {0.45168088150507146f, 0.1079352327627181f, 0.040617237497433845f},
    {0.12136592073732333f, 0.13882245819939742f, 0.8821805948426322f},
    {0.29524336620162683f, 0.9130856103245636f, 0.7036833097068547f},
    {0.16176631107554784f, 0.7371284282921404f, 0.25614807402193174f},
    {0.9711496363556319f, 0.2180274296994681f, 0.00910456219931266f},
    {0.7230008801767881f, 0.9495136425254047f, 0.3790993099357839f},
    {0.6366897796325434f, 0.6420985644082973f, 0.08793707276039053f},
    {0.27456677340097035f, 0.4802525574250014f, 0.17943433230809935f},
    {0.39648690454481994f, 0.937690601541094f, 0.405165002066046f},
    {0.3219468498684799f, 0.9845050155196301f, 0.8294144294643874f},
    {0.092915869173124f, 0.5318276620832104f, 0.11503614910312665f},
    {0.4210272927392684f, 0.5473285601883849f, 0.30170798838686175f},
    {0.2588706730569966f, 0.816136315258698f, 0.3756242865088528f},
    {0.5922748411410425f, 0.9282990140206944f, 0.41923574729346125f},
    {0.8371149293765225f, 0.37442097284735665f, 0.3814825965361871f},
    {0.49222058261704005f, 0.0428433224038407f, 0.3156649492726099f},
    {0.7863697190810838f, 0.727142598480008f, 0.21310082766737903f},
    {0.28419348641690045f, 0.050164953231109366f, 0.6420828551650194f},
    {0.08036081943486617f, 0.28295301025198527f, 0.9679389383667364f},
    {0.46873020545766464f, 0.9078031643002095f, 0.6846044316294495f},
    {0.39916486953961616f, 0.8869800867705236f, 0.43545521100476425f},
    {0.4900587274946189f, 0.9364697831129354f, 0.6432990683879598f},
    {0.18417823845349213f, 0.18338632214010053f, 0.45889908725532513f},
    {0.8391708992727602f, 0.8646385937946558f, 0.661255403615974f},
    {0.09973405758314469f, 0.43998804171987305f, 0.32121973146102867f},
    {0.006496712324122744f, 0.8222410702202535f, 0.6638415847409642f},
    {0.9146894563912829f, 0.2254966841263616f, 0.3395314490546518f},
    {0.3293522740626571f, 0.8924970296168474f, 0.36614029866259745f},
    {0.15082967266863745f, 0.894241638591239f, 0.9980674919071546f},
    {0.9726821590679453f, 0.2707524741365397f, 0.9822079319867225f},
    {0.8570323594122814f, 0.36026873513550217f, 0.5717020814413528f},
    {0.6222294041207871f, 0.2718804478929384f, 0.5845489822811516f},
    {0.8700447913965171f, 0.3380318916814684f, 0.39382206821591004f},
    {0.38769271378213177f, 0.9337959444780652f, 0.5795771013239487f},
    {0.8715787360085954f, 0.17061856135612974f, 0.33555529524517436f},
    {0.9966303254082274f, 0.6100318310473969f, 0.635394486087722f},
    {0.8250705725883061f, 0.09344285951843134f, 0.11214188359295052f},
    {0.5198085276424782f, 0.15196213273527515f, 0.9069012017614132f},
    {0.593367104208749f, 0.093572538499063f, 0.1363485569005607f},
    {0.4633690537487827f, 0.767014694987612f, 0.6871747860073764f},
    {0.08574458398936535f, 0.533857406677828f, 0.7872760302973326f},
    {0.38464296427739975f, 0.106730551159685f, 0.020117983790792993f},
    {0.3889025404145403f, 0.4931247853894546f, 0.1396207448067719f},
    {0.31267417649343754f, 0.3299454834684087f, 0.5439704514909297f},
    {0.8363192877259534f, 0.7490569159708726f, 0.42448757344439936f},
    {0.5121712441920094f, 0.8444164868005251f, 0.44245733850884583f},
    {0.7166604059271448f, 0.12792951587488122f, 0.04979948676847701f},
    {0.3527892888321511f, 0.023231470115886443f, 0.08845547858380332f},
    {0.4565970730773008f, 0.47823545237450293f, 0.555462375828602f},
    {0.662718378290521f, 0.7620695807735732f, 0.2416907012023337f},
    {0.7669494409957853f, 0.9007461141441595f, 0.21478971139952274f},
    {0.06539933171921197f, 0.39055588777204064f, 0.9201260250253487f},
    {0.1569737189172813f, 0.30733580374293235f, 0.11976963602240942f},
    {0.9316029492458351f, 0.15152995189417262f, 0.8923755990173363f},
    {0.20135853484174548f, 0.9140431483911419f, 0.3779173364383881f},
    {0.07864266684770715f, 0.29402250299506116f, 0.6000946046899603f},
    {0.1759791282129729f, 0.17949148983177698f, 0.7667205700774145f},
    {0.921005714539946f, 0.6754214505982654f, 0.2256844327621016f},
    {0.2685722307477494f, 0.3294822469876767f, 0.5226029292321597f},
    {0.30297745649270436f, 0.9577367985738355f, 0.20999517308072357f},
    {0.8690794716594891f, 0.06584095724079542f, 0.5268419778341148f},
    {0.9169067865664959f, 0.6355081781935011f, 0.5499567795439202f},
    {0.24303523245990744f, 0.2029073634871984f, 0.8450925426078852f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 13: random", "[votess]") {

  const int k = 127;
  std::vector<std::array<float, 3>> xyzset = {
    {0.41894744989842914f, 0.9189688734271512f, 0.4472801992006842f},
    {0.07915455697791396f, 0.5669366083742804f, 0.5642988271928994f},
    {0.47747920458486126f, 0.34495148285446997f, 0.7931572326222016f},
    {0.4338970795050847f, 0.166299427832599f, 0.8477419406432621f},
    {0.7254399759566895f, 0.0013208082249974717f, 0.7593061389690895f},
    {0.8261299611860412f, 0.17250401646776714f, 0.2619779942618171f},
    {0.9633324482632123f, 0.3700692569849259f, 0.04745911957588733f},
    {0.12993927046413978f, 0.694492324058075f, 0.6581369588134407f},
    {0.7329976927958954f, 0.2441677660305812f, 0.3007611456438043f},
    {0.7017934735025201f, 0.11766654854563996f, 0.7967871444472377f},
    {0.30352073006573244f, 0.19838864034223647f, 0.5433759429157492f},
    {0.7490600302517474f, 0.8622092493162099f, 0.9302073394984712f},
    {0.7147114337244733f, 0.932008345462327f, 0.32965065956038986f},
    {0.11176166738342996f, 0.17524805337154925f, 0.9713961302241373f},
    {0.9440873306478396f, 0.2504494143411611f, 0.8319545801449434f},
    {0.47271739838716365f, 0.8980642327384161f, 0.18649791079913747f},
    {0.4544455595360045f, 0.22335368165444314f, 0.19652294386879532f},
    {0.5103830063219005f, 0.6401369677742816f, 0.025175293872208182f},
    {0.11869284112867884f, 0.8716954981629618f, 0.13870812662431786f},
    {0.06491236002276835f, 0.4285583514733753f, 0.400577227595617f},
    {0.02740114110154057f, 0.38801937799937736f, 0.0729852315148607f},
    {0.22793286098339538f, 0.872270967085553f, 0.944559218954342f},
    {0.07514675540132565f, 0.17368328545693412f, 0.41206734453542304f},
    {0.23826337261780461f, 0.6024719487370785f, 0.01824718767474942f},
    {0.27583986229991364f, 0.8525837748818363f, 0.38916206595582814f},
    {0.31057803496908065f, 0.8597495319545393f, 0.7533264552006171f},
    {0.2397514154938658f, 0.9988192883610874f, 0.9604117710371199f},
    {0.49068355451158296f, 0.8530446307540688f, 0.845682464600643f},
    {0.027390301461775124f, 0.18727335066505013f, 0.892300979856393f},
    {0.34601146257836357f, 0.4331448806423791f, 0.25464508528766183f},
    {0.07200955776518891f, 0.31275327635635797f, 0.06492619052847814f},
    {0.5782060864668056f, 0.14551995791875993f, 0.5522460464556833f},
    {0.06976945316594041f, 0.28620246834493923f, 0.7251993455178285f},
    {0.3626822213571369f, 0.29776051949264104f, 0.797857201662927f},
    {0.4169396447397846f, 0.3435167002203443f, 0.664856262488887f},
    {0.17181732187356968f, 0.27129751551327663f, 0.6292002119919506f},
    {0.028168198868937955f, 0.17050613615365873f, 0.08326917789649024f},
    {0.5431180760911717f, 0.639217603895777f, 0.9904984280026947f},
    {0.9532896525573962f, 0.8941108172860351f, 0.7538850554046213f},
    {0.24669510255126836f, 0.8709884156263089f, 0.8756792224157013f},
    {0.7820782773444579f, 0.8932574217525072f, 0.44795789637578154f},
    {0.5366375941501358f, 0.7338032441535414f, 0.4236269010475635f},
    {0.9601382321709949f, 0.7608658305224997f, 0.3385314466129914f},
    {0.03676082135280223f, 0.03560088505968817f, 0.7154939599366973f},
    {0.896701004858904f, 0.7808006104577938f, 0.17388181117840829f},
    {0.7995728542050003f, 0.18503368251873142f, 0.7683477821555578f},
    {0.30898562026938603f, 0.3777931731619337f, 0.5456852639125517f},
    {0.7064088079793439f, 0.8358723286078773f, 0.4667792279183366f},
    {0.9181121998275614f, 0.8841401605685139f, 0.32253209401879f},
    {0.11070897842135619f, 0.18405436085881655f, 0.39361048417840416f},
    {0.6701905379867817f, 0.7368778560255285f, 0.6475059418575133f},
    {0.4035522194109957f, 0.14630134975601694f, 0.8376772613730954f},
    {0.6248217221489508f, 0.3477868917061663f, 0.3164972489281409f},
    {0.08388085198417172f, 0.4125253205562084f, 0.9850648771620966f},
    {0.4014415010587854f, 0.5030138742721387f, 0.6891350376553408f},
    {0.27041652749334677f, 0.3865744887993703f, 0.7887975501080622f},
    {0.1055059132843188f, 0.1803159891700845f, 0.6392674320199052f},
    {0.536185345826886f, 0.6123112276732855f, 0.8651779804322233f},
    {0.6018111362753135f, 0.5322748786812451f, 0.5989372976425567f},
    {0.4309195007286437f, 0.02479822255616304f, 0.6207297597914522f},
    {0.3439872345637637f, 0.07389942102323421f, 0.42262123836370535f},
    {0.5509217894546329f, 0.3463864550894096f, 0.2414023355128806f},
    {0.5792174751199063f, 0.18915959825204087f, 0.288792178483006f},
    {0.7766610622781387f, 0.8949110527506556f, 0.04326140727843275f},
    {0.5062110532380423f, 0.0982338014880153f, 0.004961346855206772f},
    {0.04584157416658163f, 0.190562237912431f, 0.2880579591587533f},
    {0.29114840984154344f, 0.5061706185903755f, 0.6914806990992648f},
    {0.5199186178667264f, 0.5645337568139576f, 0.003106500302200388f},
    {0.15462842943292043f, 0.7590596703852456f, 0.4222380879911136f},
    {0.5614097785144809f, 0.5246429151157624f, 0.46567529410898256f},
    {0.8867755549522551f, 0.6673110149348876f, 0.967080501471062f},
    {0.13790347566850558f, 0.977829138547279f, 0.6241924800970582f},
    {0.10672624330759961f, 0.6423361128915132f, 0.3205639851832597f},
    {0.9851143989810516f, 0.7995533525162671f, 0.5339962062036089f},
    {0.3310026931653173f, 0.7542874136908984f, 0.36538581683755367f},
    {0.4190547366583891f, 0.8520050626800667f, 0.7133327234536435f},
    {0.14948618050462137f, 0.25987442459839116f, 0.285580889909142f},
    {0.5205152814266071f, 0.988868906651143f, 0.7124595241048678f},
    {0.9547030814860867f, 0.16130683622380504f, 0.35730423413859436f},
    {0.9319044638023007f, 0.6682193962940983f, 0.5527418440929491f},
    {0.8845411667558366f, 0.6409573007966122f, 0.2558479664525872f},
    {0.5027986579064923f, 0.5236573668668025f, 0.39671760770945674f},
    {0.6715652288680297f, 0.5010667097562094f, 0.14184525878808618f},
    {0.7766015592852513f, 0.6325059025481438f, 0.8262179997216115f},
    {0.6071019286741978f, 0.46149555771712014f, 0.3460544082469674f},
    {0.11545802030268881f, 0.6359490759738826f, 0.06275626850174121f},
    {0.18355239407883073f, 0.37405026058105073f, 0.8939243139789751f},
    {0.2353683970135848f, 0.49924349316405436f, 0.1654685169154675f},
    {0.7370654814304703f, 0.5099198541679524f, 0.6960804454685159f},
    {0.38564775882078817f, 0.941495665986647f, 0.8485136198241714f},
    {0.9624151366925368f, 0.6391252778116263f, 0.08304994307079694f},
    {0.16836739563988f, 0.9692392707769278f, 0.47542065576966774f},
    {0.5014831771423041f, 0.34990494951639806f, 0.13941838934509743f},
    {0.5770411386537677f, 0.9548220122319285f, 0.45846364651792537f},
    {0.9368301368443647f, 0.502226459914949f, 0.5890883538677376f},
    {0.9069204581989586f, 0.33216380162390013f, 0.7879285181528082f},
    {0.6719691099138092f, 0.6315629866095317f, 0.5013608482714466f},
    {0.12673452830908016f, 0.9696931970349338f, 0.15775851480130443f},
    {0.592283282916268f, 0.7660200203256335f, 0.3029179915957708f},
    {0.4168948160520185f, 0.43238667883960524f, 0.3433803953860294f},
    {0.37011834991413106f, 0.16263026433693573f, 0.7026768894416978f},
    {0.8585211530432776f, 0.715122039050087f, 0.9036853263137855f},
    {0.5999174520276057f, 0.7256718756668765f, 0.9672106321304528f},
    {0.7168281005737902f, 0.3267072466810762f, 0.13966632277548108f},
    {0.28302463974716763f, 0.1969395515307535f, 0.6894341985507861f},
    {0.01066810610205049f, 0.565529930349715f, 0.0593074390150069f},
    {0.5150856634280063f, 0.07182981110905418f, 0.4213970077980034f},
    {0.9441918278407667f, 0.4780315453517634f, 0.17397603013592988f},
    {0.018373605449364616f, 0.5900389617576262f, 0.880119418776077f},
    {0.9341179327322487f, 0.18505032496782703f, 0.9895037809459889f},
    {0.34810325456130875f, 0.30843172493033233f, 0.5319510635451022f},
    {0.5037328117611076f, 0.6639044764486349f, 0.03577075898730531f},
    {0.28357338963747625f, 0.0015349511799316318f, 0.4537935648182323f},
    {0.059831243790839594f, 0.8344976035445899f, 0.470240900032208f},
    {0.9737317245152013f, 0.7327976515132623f, 0.7886240398360435f},
    {0.2876000025248965f, 0.5419951093803398f, 0.09652503528609613f},
    {0.20027328678898593f, 0.43931801686255423f, 0.11357517599976652f},
    {0.07943868443924618f, 0.3242308779278136f, 0.9783523302851295f},
    {0.29446276185299736f, 0.32758747400887067f, 0.6824529949746845f},
    {0.9674354750138386f, 0.6773309452716619f, 0.7858479653285764f},
    {0.8992188276465897f, 0.1834352159404259f, 0.6773523835444367f},
    {0.4925285412676904f, 0.743343340407123f, 0.6023632020239416f},
    {0.5902533400873203f, 0.07494467347591416f, 0.1846181750656236f},
    {0.8223189434213756f, 0.8362858428261774f, 0.13462513795845021f},
    {0.34025369989066334f, 0.8671538408342784f, 0.5028028866443254f},
    {0.41358222482293516f, 0.16059700801501675f, 0.15099194882250888f},
    {0.45319755650364657f, 0.6055089138448103f, 0.31308566308119823f},
    {0.20702492349822277f, 0.9104933772474836f, 0.9594500595627534f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 14: random", "[votess]") {

  const int k = 127;
  std::vector<std::array<float, 3>> xyzset = {
    {0.5758301347060624f, 0.07283818757913052f, 0.6645080042292881f},
    {0.29458971282902147f, 0.5953510149679658f, 0.4610204537989563f},
    {0.18510156729864968f, 0.11707973403153726f, 0.8306348352420472f},
    {0.5602239787235145f, 0.17321331316828492f, 0.8676827340586437f},
    {0.7614304415635131f, 0.692911484984964f, 0.6362865795934323f},
    {0.6826413750735465f, 0.2567091661042965f, 0.19856276423944075f},
    {0.3377333573245377f, 0.12195235418633599f, 0.28162193210818487f},
    {0.6616993339512923f, 0.37034927973469345f, 0.9128937161708264f},
    {0.8617467557455147f, 0.3550466457308261f, 0.9001709334358088f},
    {0.6893235517236093f, 0.8035296942170372f, 0.9856541098441002f},
    {0.3251243244996693f, 0.2595788211846013f, 0.33504115597473016f},
    {0.09870191745173884f, 0.8873925757416236f, 0.5436888478294388f},
    {0.9072003761649827f, 0.36210789285542033f, 0.11241597763781852f},
    {0.23925354158056633f, 0.2168301442174112f, 0.2632037030281812f},
    {0.4778430009046054f, 0.6928796061160408f, 0.36463279009630845f},
    {0.23430516782416666f, 0.7200945831943029f, 0.74882339891513f},
    {0.5951482384371789f, 0.31559150757800825f, 0.1637455111911198f},
    {0.12156904241198385f, 0.0077173208848645425f, 0.32980991061859544f},
    {0.4534332401972315f, 0.7435169870403475f, 0.6796657646433186f},
    {0.4589595152057918f, 0.1025177540177703f, 0.3240403889881299f},
    {0.49950496667615263f, 0.6512787572052616f, 0.6074507696699203f},
    {0.47552183843798457f, 0.544911017387219f, 0.43144580280978084f},
    {0.22106225029217674f, 0.9950827141428276f, 0.340846894394491f},
    {0.7311166773309987f, 0.4317102207550122f, 0.27742371395435705f},
    {0.7988570385450454f, 0.27470151339244187f, 0.9031776516959271f},
    {0.38489364511885105f, 0.025356023853719933f, 0.3901498141716875f},
    {0.8829800959596593f, 0.21045683511387558f, 0.4674473302001044f},
    {0.8750002129511354f, 0.9179908488649638f, 0.5580181075889004f},
    {0.8078416291986054f, 0.19431195395386647f, 0.8677363464100265f},
    {0.7299761862060259f, 0.3147755959485724f, 0.82203273659162f},
    {0.9184821712818231f, 0.4570221953934891f, 0.7717032059447577f},
    {0.15993238411621147f, 0.049996836026152236f, 0.8390481337988438f},
    {0.6935618218559825f, 0.007378462142837661f, 0.7461579718114634f},
    {0.1282751650873294f, 0.9071619834274923f, 0.3044956679065851f},
    {0.8831798125819781f, 0.1703435408997307f, 0.7767338193727937f},
    {0.9064282969508944f, 0.9393179650631207f, 0.8202809419522242f},
    {0.4733621664174519f, 0.16385133288668807f, 0.8455010697241225f},
    {0.43225860149465944f, 0.26929368605509607f, 0.8633275791886638f},
    {0.9183072589477792f, 0.17358116896733033f, 0.2806380849261927f},
    {0.5487487496079945f, 0.20457325988825736f, 0.44690660888481093f},
    {0.25065477957554616f, 0.6736376362673978f, 0.9873617122035192f},
    {0.4741718140770328f, 0.7365070798273747f, 0.009831536539855135f},
    {0.1612626197186312f, 0.9318095764114684f, 0.9609640759226297f},
    {0.881714449943141f, 0.9673619685289784f, 0.3477442794561312f},
    {0.2634851132698254f, 0.6133787499505462f, 0.9600447786696547f},
    {0.8633088852750129f, 0.14961793956855474f, 0.1950174694461666f},
    {0.4036953467748836f, 0.6998340051622566f, 0.1785587458542175f},
    {0.6284938982168239f, 0.7560801035002483f, 0.23894120260772056f},
    {0.7456436039045906f, 0.6189648514745225f, 0.8382809809795249f},
    {0.4573606997456766f, 0.5995908198300749f, 0.857628571346271f},
    {0.12796855720031708f, 0.9514699700741863f, 0.7253604591173297f},
    {0.6861432075686822f, 0.4138804329108121f, 0.44328807502534384f},
    {0.38351355563015455f, 0.4683400627729285f, 0.5971905773995246f},
    {0.6844390127215175f, 0.6003185684345266f, 0.842214971934929f},
    {0.5917885840423681f, 0.5398864527861764f, 0.23163225167490187f},
    {0.4156954287623771f, 0.1914177387119147f, 0.24943160339236348f},
    {0.33658454725671316f, 0.9854228191946866f, 0.9156470796239502f},
    {0.8660718173323543f, 0.16887072078774956f, 0.07071643694510588f},
    {0.5245322236484072f, 0.1458530354326124f, 0.15531336991057465f},
    {0.719920884349941f, 0.8093679291693125f, 0.8461822497856697f},
    {0.7250926505312952f, 0.02209445492579709f, 0.944506756367185f},
    {0.22527793554012776f, 0.6200755038199569f, 0.877342850474393f},
    {0.7302480495402861f, 0.07190119510819892f, 0.6570627426685177f},
    {0.304938430361433f, 0.250009688699548f, 0.4900607495131256f},
    {0.30533495627457985f, 0.7780133998302531f, 0.8005847138610379f},
    {0.2024636455743707f, 0.4290546838830829f, 0.04625874664764762f},
    {0.02030390767326684f, 0.6221651110393958f, 0.2821169811042754f},
    {0.8940742709220221f, 0.535142358798046f, 0.4061486669648249f},
    {0.853052941183496f, 0.7564463250749999f, 0.03440647063876334f},
    {0.892838259407789f, 0.12249922354842357f, 0.9261041166316392f},
    {0.7787793788123551f, 0.7253859801697355f, 0.0043040455682938905f},
    {0.7840728394990625f, 0.9819102825493483f, 0.9850059435323434f},
    {0.7436074758786159f, 0.17787901084236812f, 0.23331737288871068f},
    {0.1394751998528999f, 0.3257529517661163f, 0.7373419828894875f},
    {0.37668318435454806f, 0.2189703640327375f, 0.5921881591112461f},
    {0.39803061410358664f, 0.6556551561286529f, 0.16739838439821664f},
    {0.9155880930450645f, 0.8172215154930894f, 0.7508277295451967f},
    {0.20599264432718034f, 0.40856009728845855f, 0.3700157372664722f},
    {0.987028166080214f, 0.32340547440353296f, 0.09903513878518233f},
    {0.18937030460791038f, 0.4088997258679702f, 0.10176032030731852f},
    {0.08093588847079358f, 0.7732696557653821f, 0.4026356011168899f},
    {0.6623107482189575f, 0.1376567761731674f, 0.9964043711745718f},
    {0.9296842983348905f, 0.9086681448625216f, 0.42708850388494457f},
    {0.7893974874028371f, 0.3016119961718614f, 0.6686923693247709f},
    {0.5392048935364157f, 0.7818708438097183f, 0.4210841581168119f},
    {0.764591930808684f, 0.9895271219572617f, 0.6151826355903413f},
    {0.9667744260600545f, 0.12154778837011315f, 0.4000507564005854f},
    {0.8058851097963269f, 0.5290462263412862f, 0.02623889291391046f},
    {0.25486346046967956f, 0.36281488370645065f, 0.18224854431974458f},
    {0.0034550558012483856f, 0.8647327799598256f, 0.9459332151540816f},
    {0.9219551085114277f, 0.6166282596155419f, 0.6573272987780924f},
    {0.290795743290688f, 0.3383540818222389f, 0.8265261577878251f},
    {0.9550319499475101f, 0.45887897802665367f, 0.029512486048464237f},
    {0.8814717272558849f, 0.6564528650416421f, 0.8495211791461003f},
    {0.30598173070845136f, 0.7560718700865026f, 0.28399043924820766f},
    {0.8658534326631441f, 0.7919219379502398f, 0.15425417995781598f},
    {0.8109144470358715f, 0.6929619403540442f, 0.7604084225261583f},
    {0.7176220494696324f, 0.8896782986343093f, 0.32881865399927324f},
    {0.4281662903698472f, 0.1551663808140209f, 0.8741033768501735f},
    {0.5476378955685675f, 0.8535510411872275f, 0.5887573824749204f},
    {0.06938276668177557f, 0.7882525642094442f, 0.9074171068936314f},
    {0.37123714441270217f, 0.5313578577026407f, 0.6726396127706905f},
    {0.6587940503395655f, 0.4558967760417155f, 0.8105761976230087f},
    {0.0862918134105709f, 0.6939574596343072f, 0.5307380565173427f},
    {0.4455767105636169f, 0.0005729943380519131f, 0.7016821216885154f},
    {0.7261456598966498f, 0.9418674801021195f, 0.45188528602416766f},
    {0.1005569710050398f, 0.8708366141899722f, 0.17551870446276463f},
    {0.7712740140738105f, 0.05605422493867096f, 0.3833985307546227f},
    {0.15458694255530425f, 0.811298862134245f, 0.5829827361084325f},
    {0.7153311892508313f, 0.635906859007628f, 0.7482497624140257f},
    {0.7205414170912067f, 0.48496535092524184f, 0.11184060009420971f},
    {0.9643899337698884f, 0.2833862207064205f, 0.09161779519272983f},
    {0.6687073816096426f, 0.7824050991907893f, 0.606055305461788f},
    {0.1759750714724212f, 0.3754377830677549f, 0.856171080320575f},
    {0.34165185234214057f, 0.5487562716355648f, 0.5581635110768102f},
    {0.0017818651253626028f, 0.25567511166596935f, 0.3877673725807206f},
    {0.7487570692481453f, 0.8201858415014868f, 0.6626973393363178f},
    {0.12604894313037718f, 0.7727461918584336f, 0.7056175726418484f},
    {0.6417277832538584f, 0.07380644910898804f, 0.9852158272875287f},
    {0.9445355969299496f, 0.6204045660453821f, 0.8245755311088419f},
    {0.8882158178157726f, 0.4318752052295677f, 0.24761930517670594f},
    {0.049357478366021224f, 0.5036915237009225f, 0.8175143565416123f},
    {0.5515839910555105f, 0.936771516611738f, 0.9162884946896361f},
    {0.9896574787328594f, 0.4445684763011204f, 0.5094557444658465f},
    {0.1422451507531266f, 0.005929647002333782f, 0.05536240343659593f},
    {0.004283478971104815f, 0.4957236849721848f, 0.9754723179973083f},
    {0.14455992629808367f, 0.2595153422263522f, 0.15190343658827865f},
    {0.43399715735589606f, 0.9609694672090059f, 0.6556740916851335f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 15: random", "[votess]") {

  const int k = 127;
  std::vector<std::array<float, 3>> xyzset = {
    {0.7976051467373575f, 0.372269269424617f, 0.9479394856083188f},
    {0.9448572570667696f, 0.20229960637586752f, 0.9852378944867576f},
    {0.9618108593317594f, 0.3971666234912319f, 0.83059220258582f},
    {0.2813535130562703f, 0.7375724042205599f, 0.5177193545466127f},
    {0.47135122886950853f, 0.3894591872855355f, 0.9640030563845462f},
    {0.8891544497600125f, 0.7765365230779203f, 0.9026655435147158f},
    {0.2832059068781605f, 0.9627181067754763f, 0.13179077479053847f},
    {0.5337455040424428f, 0.8180517797942933f, 0.9882383582113117f},
    {0.8367119675801614f, 0.6370832336747093f, 0.5155283772324631f},
    {0.3237368251244217f, 0.5576950230169413f, 0.8500917947447824f},
    {0.5422809477340644f, 0.9301025252669525f, 0.6862255318235209f},
    {0.885915453799355f, 0.9358859725575764f, 0.5527837172618373f},
    {0.10478280992015498f, 0.3259860960340064f, 0.13716360395733007f},
    {0.6203703697036264f, 0.03285957597856337f, 0.35599216826653146f},
    {0.632410005412995f, 0.06663173529961497f, 0.2016904810196416f},
    {0.5356701279305945f, 0.08815518226979702f, 0.07503142172252308f},
    {0.05708173132682259f, 0.024232538754007216f, 0.2296409190235763f},
    {0.22281544270528197f, 0.2575424209785706f, 0.7496441690518576f},
    {0.07526435830112277f, 0.09329142520694522f, 0.09278116762759103f},
    {0.8642334809364681f, 0.6917641337239012f, 0.48155773859988626f},
    {0.5607515429027778f, 0.4921958178058089f, 0.1866883179953297f},
    {0.4172503660230633f, 0.8395185999601306f, 0.43667811554229363f},
    {0.8715503429045455f, 0.561849535938356f, 0.634172033678114f},
    {0.428092310337575f, 0.3252335712083817f, 0.48301120280820187f},
    {0.24837196485799096f, 0.7034710254935097f, 0.17372850100276604f},
    {0.021043771051203697f, 0.2195087808781656f, 0.10077936204381777f},
    {0.1529589993513244f, 0.3215012559945236f, 0.9493249010129515f},
    {0.028232511311998332f, 0.3853919283264283f, 0.14171679045077268f},
    {0.7655564135041907f, 0.6100078493574232f, 0.8535183654529931f},
    {0.7022817693814238f, 0.740457585016486f, 0.9392967406267932f},
    {0.32059558213860784f, 0.7347343131541342f, 0.10218235670940223f},
    {0.7600721107513264f, 0.8667829366407017f, 0.3065555169875662f},
    {0.9610980884107493f, 0.9746286113297825f, 0.9274565552436512f},
    {0.19826187515259797f, 0.32321457843960566f, 0.2947480105652437f},
    {0.7765521903779854f, 0.5687249251491551f, 0.23113414804676535f},
    {0.09475390077653345f, 0.17747680121636167f, 0.4724035974041846f},
    {0.8676640198052313f, 0.7142709419179133f, 0.32528363924339854f},
    {0.6016134096365842f, 0.5623559837432958f, 0.9963669679718152f},
    {0.7682027774415392f, 0.9207045924737125f, 0.029763009565968335f},
    {0.9368381764439393f, 0.3342104638137746f, 0.9600333305909601f},
    {0.0634424161326288f, 0.7767677594441005f, 0.8337758174883915f},
    {0.770998644347615f, 0.8233216801819176f, 0.6173098999304525f},
    {0.21082277443631936f, 0.7170030192512458f, 0.6539813480549671f},
    {0.6005955859084546f, 0.26869876935708514f, 0.6417712900507981f},
    {0.10103350800498234f, 0.021818848342100905f, 0.7448342971237494f},
    {0.5887667651918224f, 0.6272801962578579f, 0.3235553323336342f},
    {0.5155323181136486f, 0.407921530039169f, 0.7387703754897637f},
    {0.30275040894511696f, 0.5455999209112611f, 0.4002884040322149f},
    {0.13924076119699202f, 0.42786081032152845f, 0.7730853159711826f},
    {0.1290490441470813f, 0.5907615071079293f, 0.1081275533189694f},
    {0.4264846309363932f, 0.19478705539185426f, 0.5294722966883839f},
    {0.8644226270018068f, 0.3421659884551279f, 0.28017477580158245f},
    {0.6918127844747892f, 0.6103606041958655f, 0.9278012379075513f},
    {0.31195128051519017f, 0.4572976872345871f, 0.4799433374952806f},
    {0.8748975933784493f, 0.36066535323649873f, 0.903071954022388f},
    {0.27753830225446674f, 0.23161901624781844f, 0.3502749533273365f},
    {0.34687909876972767f, 0.7599058104744465f, 0.9909654981857019f},
    {0.2835317257260688f, 0.5750159475639356f, 0.6868987784937631f},
    {0.6517114446322616f, 0.06407874389258927f, 0.30093785335405143f},
    {0.44693748253550225f, 0.2637971992851025f, 0.46061404648995774f},
    {0.20538269296641087f, 0.11130768753156217f, 0.2037349085296546f},
    {0.16001888836896683f, 0.8258413390749253f, 0.03283930042880934f},
    {0.8524373154373563f, 0.357072541764927f, 0.6841291207549048f},
    {0.5529883483452338f, 0.36656941586222336f, 0.38132079639141425f},
    {0.9074212118652399f, 0.47542649789410263f, 0.9133464977949447f},
    {0.7157497343067587f, 0.3889483618616514f, 0.7232020956827374f},
    {0.5755841380300726f, 0.6683626839895467f, 0.5269717521375118f},
    {0.48668527790216476f, 0.6556827349484153f, 0.17009608368982343f},
    {0.050625831282129496f, 0.2329817060471634f, 0.9150404206442614f},
    {0.6385019971888409f, 0.46558752686673377f, 0.6074009885723111f},
    {0.8918108110349472f, 0.9772755814311698f, 0.23104806808891554f},
    {0.4355473621854131f, 0.6305295243300815f, 0.2945892889780961f},
    {0.15574598874435208f, 0.6392127368843129f, 0.027442909469028942f},
    {0.673304424657436f, 0.6953448419968624f, 0.3398743877773531f},
    {0.28495325540847694f, 0.33868004978461885f, 0.3331638276561508f},
    {0.29961089368674954f, 0.0871555125384792f, 0.4152808573480994f},
    {0.9702922518280944f, 0.8627872348762959f, 0.5151339650272813f},
    {0.46887348340183044f, 0.8061956553899731f, 0.378931283812597f},
    {0.7376932428401007f, 0.4853458043322266f, 0.02702950131414328f},
    {0.5007603690253005f, 0.21887346372502803f, 0.25514761082708304f},
    {0.9209748922699129f, 0.7024523141442107f, 0.37077439360702424f},
    {0.7047299198028826f, 0.2515138904958689f, 0.5603815029997574f},
    {0.44897749432793366f, 0.9569080739376892f, 0.5292613962737712f},
    {0.3701218532448486f, 0.8907385351051539f, 0.23216555814475648f},
    {0.4301477568764549f, 0.9980133461867788f, 0.3154071942742369f},
    {0.6608159219303797f, 0.9052549275482773f, 0.5925078232069436f},
    {0.022488909181402783f, 0.6552306029466531f, 0.717614858360882f},
    {0.6023846467866539f, 0.33276149911748243f, 0.47792094059115875f},
    {0.1821377265085774f, 0.4055028529771041f, 0.19822331841230867f},
    {0.5882649387148801f, 0.1581292052079586f, 0.30658661351388483f},
    {0.5631617109772418f, 0.4133329917837334f, 0.8881621127559789f},
    {0.9410691002326129f, 0.6613073864879465f, 0.2722688508491806f},
    {0.3366903194288259f, 0.8954469839029546f, 0.6863160226158984f},
    {0.24483576860054101f, 0.1301358022368857f, 0.4567898189145455f},
    {0.33580959007061006f, 0.6062293911767089f, 0.7509762761506514f},
    {0.7910028234347684f, 0.7884873240999825f, 0.9922493847247481f},
    {0.9384364936694487f, 0.24785731131337796f, 0.07379764336164718f},
    {0.6736606643840233f, 0.6346940541633646f, 0.4782373396182652f},
    {0.030197000935571094f, 0.4857644569351206f, 0.6144384981993252f},
    {0.46972099995985617f, 0.24960027759624925f, 0.14090162529388728f},
    {0.9231402506035696f, 0.6708590931018406f, 0.8177761839630272f},
    {0.6250971641412147f, 0.6440970460837704f, 0.9836238543482541f},
    {0.16567303973437397f, 0.24796574965600393f, 0.7483985116081104f},
    {0.9057480492902675f, 0.17085371633140567f, 0.8322779968820379f},
    {0.9713724958272211f, 0.2436330754046362f, 0.039139651990884095f},
    {0.581902583376868f, 0.667781011095209f, 0.6950161003382903f},
    {0.020990814323968654f, 0.5515251514033765f, 0.026488531613331867f},
    {0.40431220739405915f, 0.9552357397889161f, 0.40753333586484874f},
    {0.3699136304515219f, 0.7867645771251109f, 0.7306947425275938f},
    {0.9179781510046382f, 0.3748688934565695f, 0.11095567131062434f},
    {0.27595307087823095f, 0.87319137018105f, 0.7986861425266417f},
    {0.18792966036850922f, 0.6419128341941862f, 0.36621994597091934f},
    {0.7713663583914241f, 0.334775276558265f, 0.6401693964972255f},
    {0.9365830699354697f, 0.7716313393138348f, 0.2999694253289149f},
    {0.05866629266625456f, 0.5063435172959541f, 0.6709938275345798f},
    {0.6404139204029071f, 0.6548884675211287f, 0.397106622832026f},
    {0.992035498151632f, 0.36099300028825954f, 0.5859170188315981f},
    {0.2173785365863865f, 0.42451033678683636f, 0.44391582539613683f},
    {0.7368421126994792f, 0.028981221105047306f, 0.08387340296196144f},
    {0.2509655860691292f, 0.29011395568038545f, 0.33998809539695096f},
    {0.2332458676961936f, 0.6688020789819107f, 0.1633351982812392f},
    {0.10740124678881069f, 0.44855647948988686f, 0.42851147705853176f},
    {0.8005394510269616f, 0.18951876819165314f, 0.3573968524075437f},
    {0.9130623931689866f, 0.2998916020124166f, 0.04717952136782466f},
    {0.2213020875381908f, 0.3855190230197766f, 0.6693475749985849f},
    {0.5825600513461321f, 0.14653474878629413f, 0.7007803181815113f},
    {0.06647915247099945f, 0.1105470542722562f, 0.6176452547988315f},
    {0.38552427257380306f, 0.22343491769827517f, 0.720058348912781f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 16: random", "[votess]") {

  const int k = 127;
  std::vector<std::array<float, 3>> xyzset = {
    {0.011023599761946001f, 0.7146839987338278f, 0.0018917541590773856f},
    {0.8522516397929731f, 0.5970820316936553f, 0.0019007759767466492f},
    {0.37679526451550316f, 0.44525276519188595f, 0.17942186315971842f},
    {0.4320101120766239f, 0.16142833018045f, 0.8771746726664692f},
    {0.3764576367880986f, 0.19661411828284225f, 0.4524589143158676f},
    {0.23256436091632549f, 0.030451385421422006f, 0.8619212852323166f},
    {0.8185068479324356f, 0.8878361146980019f, 0.706928810685177f},
    {0.09025297166924318f, 0.3349296830248627f, 0.6046269835617065f},
    {0.9791330471111132f, 0.9091894228831423f, 0.6949075106093866f},
    {0.853577815504626f, 0.18415438443227927f, 0.9832951622574924f},
    {0.7520943108142452f, 0.9173795178917009f, 0.49680543713366354f},
    {0.6954486228907313f, 0.2470729157914877f, 0.24783107009641225f},
    {0.9877249704015314f, 0.7063386853493868f, 0.203347402746603f},
    {0.10059108630045066f, 0.5424575450873435f, 0.5447133544353784f},
    {0.1600171312912292f, 0.034686285859744204f, 0.8041514025777904f},
    {0.8127701849376534f, 0.17078884414771467f, 0.29149421513226315f},
    {0.5643039988998964f, 0.5223094964549543f, 0.7183492435469003f},
    {0.905334396826138f, 0.8277599899185026f, 0.5880509428545074f},
    {0.19674841908582053f, 0.5247408604491394f, 0.311780383925648f},
    {0.18764977153009588f, 0.8209814727804526f, 0.9402533686340505f},
    {0.6728434143297569f, 0.7297540881524786f, 0.8004178928058903f},
    {0.6184550277177353f, 0.0386447851364804f, 0.9261989296743686f},
    {0.9591203870113064f, 0.6881801012710411f, 0.0913313850789329f},
    {0.8471792508373869f, 0.6875217191223616f, 0.2048217832099828f},
    {0.979244715832874f, 0.5225628171539316f, 0.7204818941477502f},
    {0.32703863275878764f, 0.8973885818196027f, 0.5312306584168622f},
    {0.15570577277137443f, 0.5580474631882183f, 0.32473226742042016f},
    {0.5482024986903508f, 0.12943880257840978f, 0.9325330911512087f},
    {0.2369654366655165f, 0.5057700491399273f, 0.10180513710622319f},
    {0.0257633830194528f, 0.7092053315548099f, 0.4164442929933925f},
    {0.04396754410909953f, 0.19568761042335447f, 0.3586692134393079f},
    {0.046553093547819224f, 0.16130566497909526f, 0.10769159516712778f},
    {0.006950240651055761f, 0.28748715567334937f, 0.16140465751277056f},
    {0.44489584477723687f, 0.11679812599033956f, 0.6202470321797074f},
    {0.2155001556353836f, 0.2370681828047727f, 0.09145219739941601f},
    {0.6628608256151575f, 0.5096662114652818f, 0.800914082932096f},
    {0.47681381034835213f, 0.3680382003755759f, 0.730214984436358f},
    {0.27859639239741507f, 0.12087332563334441f, 0.854089952935611f},
    {0.43453732358973074f, 0.8484481825249799f, 0.5192627783230805f},
    {0.1218223113954442f, 0.008152303058855281f, 0.5062338237272166f},
    {0.10020000372757876f, 0.16172389043006963f, 0.5080830534010855f},
    {0.37025232181141166f, 0.07034330324873073f, 0.36082507027498434f},
    {0.06999892376506123f, 0.033617597031268875f, 0.723026489980091f},
    {0.935430001462522f, 0.7974931608619847f, 0.19598939741163146f},
    {0.35845370670069276f, 0.43484404193787296f, 0.3610684933463544f},
    {0.43242174791587007f, 0.6536319373713102f, 0.43470840400666266f},
    {0.8898325697441976f, 0.2291232794439162f, 0.1475229268299343f},
    {0.34935070235284627f, 0.23476261012443078f, 0.22198612129940476f},
    {0.12410264802427351f, 0.5126420494683239f, 0.1400175472063856f},
    {0.43987403000210445f, 0.22524613276090344f, 0.8398894970117534f},
    {0.9451366687025015f, 0.5955101141999677f, 0.7832362532482717f},
    {0.5225316411330037f, 0.28483788101501695f, 0.985486711437899f},
    {0.025913734986355963f, 0.9405460609953483f, 0.6511361367853564f},
    {0.811415764434757f, 0.5503354331234578f, 0.16646303752040603f},
    {0.6671012952290178f, 0.2893715237464689f, 0.4745417972159094f},
    {0.21227967821296656f, 0.7526847147846568f, 0.872582682029543f},
    {0.3425936027196418f, 0.6513918524964047f, 0.8918136088659403f},
    {0.145499603405288f, 0.6372695366301543f, 0.16288466062910145f},
    {0.8056972457652487f, 0.8357283604257612f, 0.2979541957547246f},
    {0.3473892130873002f, 0.1830002403480988f, 0.9173553624791532f},
    {0.9504730838770423f, 0.8781539550393648f, 0.05743708036531303f},
    {0.8937995158793415f, 0.8252785930555259f, 0.7377921005580861f},
    {0.2569875085727117f, 0.481651757004969f, 0.9809527699104154f},
    {0.407964169998158f, 0.5811485639302683f, 0.6391564792428709f},
    {0.3890340834522942f, 0.836848204161078f, 0.47870530759833807f},
    {0.6655153532468565f, 0.2515826265017028f, 0.4219908705518748f},
    {0.5491201950922192f, 0.11931387068855714f, 0.2157312449044092f},
    {0.4636238238989693f, 0.4135875540323095f, 0.009120192310371977f},
    {0.7554587326994174f, 0.9713382374682431f, 0.32839322678986127f},
    {0.8924731264795578f, 0.26795542636663505f, 0.3586361431762225f},
    {0.885761907980569f, 0.996336445151929f, 0.5410795326086769f},
    {0.21184578153284772f, 0.44355639391506274f, 0.8404104964358752f},
    {0.04733362805980912f, 0.5726735342322052f, 0.9673124083208237f},
    {0.24451276041924652f, 0.45224885092888933f, 0.7158521979561053f},
    {0.1291026935072611f, 0.8245468530779687f, 0.412368484578681f},
    {0.4087143670894269f, 0.23862411619455692f, 0.29226925548521765f},
    {0.9825735222543833f, 0.3196629051538983f, 0.2522235835118205f},
    {0.34395315695550577f, 0.22944871092514096f, 0.9886013791417857f},
    {0.15218618920137694f, 0.6633719206286103f, 0.06285835533310014f},
    {0.6986961258017094f, 0.9480605994946254f, 0.19461663473388557f},
    {0.03629851656342076f, 0.30998721790537354f, 0.0020305201607359047f},
    {0.7929975681783711f, 0.3365039499467992f, 0.7665006275669451f},
    {0.5615926742199223f, 0.6120258485803005f, 0.6134456173541127f},
    {0.6373663196015869f, 0.4433171707080188f, 0.14710012502937875f},
    {0.7149442879125641f, 0.8909734826004413f, 0.5709292220930242f},
    {0.6733529561125441f, 0.9544893814335083f, 0.18351293217893894f},
    {0.45193741447619107f, 0.47928921106194444f, 0.196314586777515f},
    {0.27531187811450386f, 0.7079423469350967f, 0.46248717630976177f},
    {0.46631272998985274f, 0.8927546585644854f, 0.8173825649911631f},
    {0.2929048169140861f, 0.5941914303687827f, 0.7706896697336351f},
    {0.8563548070776189f, 0.16211312128587319f, 0.5830725468433814f},
    {0.3353591629257261f, 0.5811223308485031f, 0.7398438910690582f},
    {0.40674304665350935f, 0.12923883831904748f, 0.4334250613628028f},
    {0.9736114603842586f, 0.06350608000841784f, 0.5094582625181227f},
    {0.24175093773604406f, 0.8658296382950638f, 0.7150278419968137f},
    {0.8054548972677675f, 0.228104302046357f, 0.7210895623980962f},
    {0.20028310985968545f, 0.21165304872819513f, 0.34837553227831797f},
    {0.15839783500431037f, 0.7142549222220002f, 0.24600536343427426f},
    {0.3558578713380297f, 0.8700745664608406f, 0.897428875153302f},
    {0.12457768577919992f, 0.1700767588084955f, 0.5745476062066344f},
    {0.2955189417189473f, 0.5312384824340578f, 0.17753567506238f},
    {0.03867884803534183f, 0.08909252513526456f, 0.7490772338609846f},
    {0.25737110345106284f, 0.7843221532791287f, 0.2456630580917838f},
    {0.9005224990704058f, 0.8014502332395524f, 0.11207620816477593f},
    {0.9926111257976321f, 0.26389964144597844f, 0.9011812381343173f},
    {0.33739283182104784f, 0.6683250786723257f, 0.5039604965150071f},
    {0.6793954362509755f, 0.1730923275112033f, 0.39983985532802224f},
    {0.5640331776338291f, 0.30922855425522333f, 0.7390696212903429f},
    {0.4405149465129684f, 0.021134477367101723f, 0.8112062565834568f},
    {0.9305938148210025f, 0.27413738179161773f, 0.28707728095127016f},
    {0.3149361655975903f, 0.9709581590454447f, 0.3519640782225403f},
    {0.6822955282931067f, 0.3227387207456448f, 0.3083129846226942f},
    {0.13609390801415955f, 0.8557695163175327f, 0.12251385893024669f},
    {0.030290003047893532f, 0.8310364933685085f, 0.11616600424833168f},
    {0.5329599621917145f, 0.6918144483081952f, 0.303245559362893f},
    {0.5088152807739137f, 0.663025834019657f, 0.47327687051214185f},
    {0.10589821001864641f, 0.8768058100952026f, 0.6892545560535046f},
    {0.2550654146739041f, 0.9423420627178968f, 0.5492994772831985f},
    {0.41906181358904626f, 0.5950010942095332f, 0.9844623618646284f},
    {0.3633283571163981f, 0.6462677180708963f, 0.5281956879182819f},
    {0.5104958350271358f, 0.7537506733260142f, 0.5403946618942973f},
    {0.14284153171925107f, 0.7111877956357336f, 0.19462417796565168f},
    {0.776986871276135f, 0.22089055877251662f, 0.20685397973673414f},
    {0.08116090392944897f, 0.32897189277776795f, 0.706790985318509f},
    {0.6981450272590204f, 0.6005183616894416f, 0.3091554673461102f},
    {0.7830176452056902f, 0.7803923839419348f, 0.3668584100011153f},
    {0.8624515574229051f, 0.08696454123096331f, 0.7347792788981633f},
    {0.1690627887368944f, 0.778348466097274f, 0.8422045030948674f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 17: clustered", "[votess]") {

  const int k = 99;
  std::vector<std::array<float, 3>> xyzset = {
    {0.601167424988196f, 0.5296470863841296f, 0.4983626395283876f},
    {0.49355148708246727f, 0.4480870040597318f, 0.4261526778271264f},
    {0.6783239943447094f, 0.537745665535078f, 0.497971995648106f},
    {0.5064747896452451f, 0.6224531702353024f, 0.6790770471865124f},
    {0.4668174060668726f, 0.7359233313510178f, 0.5455148385767377f},
    {0.3712354033629285f, 0.4512887095612528f, 0.38130996174391363f},
    {0.5692722094890045f, 0.5199986504723978f, 0.5527934874252036f},
    {0.5273929788985957f, 0.569191035802056f, 0.44556258220320133f},
    {0.4950176096770994f, 0.5425263946702145f, 0.4853745014736152f},
    {0.4486839191125076f, 0.6112513282563442f, 0.5192802686032882f},
    {0.36688746887584356f, 0.5641540906769836f, 0.3882408398058217f},
    {0.33342906380469406f, 0.5672620738882075f, 0.4931108816698309f},
    {0.4084264738331242f, 0.4485213743039448f, 0.3627044688100093f},
    {0.5039756281489409f, 0.5281250979962195f, 0.39193612142509804f},
    {0.6174864937028945f, 0.48030366296488797f, 0.5519198064009992f},
    {0.5422753323741679f, 0.5572791837784534f, 0.3443866416504925f},
    {0.4441512578430831f, 0.35545957179348453f, 0.34768922666414176f},
    {0.3585645472574365f, 0.4570321250803888f, 0.47267078426099673f},
    {0.5645921369560325f, 0.5214984047672713f, 0.5931112367697794f},
    {0.3638885495337752f, 0.614229091279646f, 0.4079018122352712f},
    {0.36970922812527496f, 0.513354426240685f, 0.464879193380273f},
    {0.5533016350879508f, 0.5114416981504089f, 0.477674983193642f},
    {0.5153714623648634f, 0.5251422073034201f, 0.6116940421946873f},
    {0.45178454183038047f, 0.6784149164732267f, 0.4259214001889052f},
    {0.40480511650322315f, 0.6349534007518349f, 0.40537187556287924f},
    {0.5875055594195758f, 0.4365372949139845f, 0.6499689893731746f},
    {0.5503567847558932f, 0.5769389169186399f, 0.39456351951358537f},
    {0.2986194339338094f, 0.41937157244849543f, 0.48966612591569797f},
    {0.6210842440560022f, 0.5985075892895685f, 0.6317723584409151f},
    {0.5010605143153201f, 0.5899838532590593f, 0.7126666481328133f},
    {0.3896778166792618f, 0.6441483250692716f, 0.5045788380934678f},
    {0.36358094761177895f, 0.6324702730686552f, 0.4162138124621102f},
    {0.5126324971760188f, 0.4792642190587108f, 0.4500407139351287f},
    {0.4714528664139349f, 0.5097252738666384f, 0.5142761415046163f},
    {0.5211628673292454f, 0.5791182466837054f, 0.43329516828794984f},
    {0.2875358579047096f, 0.36179640906154165f, 0.5441417525874797f},
    {0.5058893833747714f, 0.44332875552359263f, 0.505515392816438f},
    {0.44757760481399783f, 0.49510601050761044f, 0.5203374530717141f},
    {0.6376811018488231f, 0.35758840150449667f, 0.6041093050175117f},
    {0.47912332454050954f, 0.6110018471551872f, 0.38819746737450883f},
    {0.35728544042721344f, 0.41088380550339926f, 0.5287793869876664f},
    {0.612143971543777f, 0.32364775307243815f, 0.45484594213463214f},
    {0.4679508796312342f, 0.3894687927044434f, 0.4853977743682231f},
    {0.5158138247899786f, 0.4399338532595572f, 0.6327083987118067f},
    {0.554265420834379f, 0.4825198644048887f, 0.29565348983472817f},
    {0.5340789402099139f, 0.37901899530363514f, 0.4784828984439259f},
    {0.4743243177969154f, 0.37671344594681866f, 0.4542992823163644f},
    {0.5553754958106699f, 0.46906607257387073f, 0.4853586736627251f},
    {0.5216481183063923f, 0.5425466592395227f, 0.580273556067032f},
    {0.5997613090723165f, 0.3610540478681207f, 0.5233299977492821f},
    {0.5119836640484569f, 0.5436655711454548f, 0.450106640294328f},
    {0.30515566072755573f, 0.5636751609490154f, 0.46849463834794f},
    {0.4786273200927764f, 0.3472244984996734f, 0.5767990713788863f},
    {0.4796516225600489f, 0.44954526880460344f, 0.4997610772724967f},
    {0.41404244659971834f, 0.589320171542101f, 0.40005213069414775f},
    {0.27701083173476343f, 0.34874073526314386f, 0.7080210938369613f},
    {0.589682944243712f, 0.40253031939301975f, 0.4210259539214094f},
    {0.4709333364615617f, 0.46577266240765414f, 0.5912173581658421f},
    {0.5260014523190123f, 0.5117117730140732f, 0.46443581462069233f},
    {0.45892622226739943f, 0.35923164062437146f, 0.5333385428786312f},
    {0.4292978218405609f, 0.4992014874015235f, 0.5119885617039158f},
    {0.47786765061100545f, 0.500353101420514f, 0.5246753204890768f},
    {0.3648944129063888f, 0.4539417611568059f, 0.4825803364837601f},
    {0.5750919846630982f, 0.5462728950956283f, 0.5362119434039799f},
    {0.31305898697809087f, 0.45554255603963734f, 0.599277505295749f},
    {0.5641507415944832f, 0.42462448548984744f, 0.5562188448639609f},
    {0.494045809282309f, 0.6057490107193622f, 0.3673722854397355f},
    {0.5732834030320809f, 0.7943399541132368f, 0.3358979285053393f},
    {0.6834685900460067f, 0.33524082983231723f, 0.47795542252138745f},
    {0.4623858408566791f, 0.344743762611212f, 0.5056084885346217f},
    {0.4916644139063799f, 0.5970641792951072f, 0.3371495838477955f},
    {0.45900570303297744f, 0.6031664544830815f, 0.4220693248336294f},
    {0.3973009195349073f, 0.5336944412752067f, 0.7303430092412958f},
    {0.5739623182786823f, 0.49959173273839397f, 0.5395985371042145f},
    {0.4872841764999197f, 0.4935265820102795f, 0.5349931045966614f},
    {0.6236787260993278f, 0.4347014559749119f, 0.6077568090311128f},
    {0.6532983585712716f, 0.3115995103338863f, 0.46146052992826514f},
    {0.5590072386224629f, 0.5420698379917109f, 0.46144898927098127f},
    {0.521050344401554f, 0.7001710207773506f, 0.4985360332164608f},
    {0.6359761579949943f, 0.35818927471037054f, 0.536952277435087f},
    {0.39026275283115647f, 0.4853547280444707f, 0.6866300555797156f},
    {0.5611276810063086f, 0.6635149598567806f, 0.4291053713159511f},
    {0.5999709876557294f, 0.47991335743694147f, 0.4207286376078489f},
    {0.47522439510861003f, 0.49307478023156814f, 0.5031927432994908f},
    {0.4250574721240268f, 0.6056516794557045f, 0.5411264865711548f},
    {0.4958248889166539f, 0.6070550685946623f, 0.5042061631967674f},
    {0.6308644721053166f, 0.5004929302613251f, 0.6582072231515295f},
    {0.49529773949965683f, 0.38530530987293127f, 0.5000571779735731f},
    {0.4486031633852943f, 0.5907929778500391f, 0.41619117721124194f},
    {0.3595766142763343f, 0.5266689422626742f, 0.4644749229620429f},
    {0.4905095692903433f, 0.42242494239543926f, 0.4374283411375134f},
    {0.4473529933580125f, 0.4516022017102346f, 0.23590983573218227f},
    {0.5935420300202761f, 0.530258959393154f, 0.529000297618937f},
    {0.44729852239596335f, 0.4963497064058996f, 0.37637783251353796f},
    {0.5177791129660613f, 0.5995196896661452f, 0.6209259205671978f},
    {0.550609235750692f, 0.48715205626754393f, 0.5309491749514805f},
    {0.4516106411689414f, 0.37130445688907643f, 0.39766492205920023f},
    {0.5140645621396125f, 0.39219676454495267f, 0.4240877175812868f},
    {0.5010442649462443f, 0.39354163179066354f, 0.2643857684520424f},
    {0.40963931368127793f, 0.36416301206012225f, 0.5221608337536702f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 18: lattice", "[votess]") {

  const int k = 26;
  std::vector<std::array<float, 3>> xyzset = {
    {0.1f, 0.1f, 0.1f},
    {0.1f, 0.1f, 0.5f},
    {0.1f, 0.1f, 0.9f},
    {0.1f, 0.5f, 0.1f},
    {0.1f, 0.5f, 0.5f},
    {0.1f, 0.5f, 0.9f},
    {0.1f, 0.9f, 0.1f},
    {0.1f, 0.9f, 0.5f},
    {0.1f, 0.9f, 0.9f},
    {0.5f, 0.1f, 0.1f},
    {0.5f, 0.1f, 0.5f},
    {0.5f, 0.1f, 0.9f},
    {0.5f, 0.5f, 0.1f},
    {0.5f, 0.5f, 0.5f},
    {0.5f, 0.5f, 0.9f},
    {0.5f, 0.9f, 0.1f},
    {0.5f, 0.9f, 0.5f},
    {0.5f, 0.9f, 0.9f},
    {0.9f, 0.1f, 0.1f},
    {0.9f, 0.1f, 0.5f},
    {0.9f, 0.1f, 0.9f},
    {0.9f, 0.5f, 0.1f},
    {0.9f, 0.5f, 0.5f},
    {0.9f, 0.5f, 0.9f},
    {0.9f, 0.9f, 0.1f},
    {0.9f, 0.9f, 0.5f},
    {0.9f, 0.9f, 0.9f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 19: fibonacci_sphere(8)", "[votess]") {

  const int k = 7;
  std::vector<std::array<float, 3>> xyzset = {
    {0.4316481022186976f, 0.7707070026624881f, 0.999999f},
    {0.9053413416285837f, 0.33968357608471256f, 0.864734028131938f},
    {0.044980109438807536f, 0.38637570025332874f, 0.7294680562638759f},
    {0.805274685488643f, 0.9853709133015262f, 0.5942020843958139f},
    {0.6309764453554457f, 1e-06f, 0.45893611252775207f},
    {0.12229405637631838f, 0.8234593704415192f, 0.3236701406596901f},
    {0.9464668866512381f, 0.5721811378961699f, 0.18840416879162808f},
    {0.35365905282086707f, 0.3298067343985586f, 0.053138196923566104f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 20: fibonacci_sphere(24)", "[votess]") {

  const int k = 23;
  std::vector<std::array<float, 3>> xyzset = {
    {0.45498046791524616f, 0.6447641872894843f, 0.999999f},
    {0.7309512777138526f, 0.3981623722477224f, 0.9572270639761924f},
    {0.2070222013310226f, 0.420462440057527f, 0.9144541279523849f},
    {0.6962147257456773f, 0.8177649585642214f, 0.8716811919285774f},
    {0.5860394722436747f, 0.11508715774145804f, 0.8289082559047698f},
    {0.16035630551673716f, 0.763494440387062f, 0.7861353198809624f},
    {0.9616323246687711f, 0.5573756576284326f, 0.7433623838571547f},
    {0.19401863880339862f, 0.15069069560540121f, 0.7005894478333471f},
    {0.497966410284014f, 0.9989644489249168f, 0.6578165118095396f},
    {0.8547925821569399f, 0.145028624239098f, 0.6150435757857321f},
    {1e-06f, 0.5421407388153343f, 0.5722706397619245f},
    {0.9085587257411171f, 0.8284796030858338f, 0.529497703738117f},
    {0.42923944202448083f, 0.0013831792480104334f, 0.48672476771430945f},
    {0.22596245342800667f, 0.9320535662375118f, 0.44395183169050195f},
    {0.9955020803957892f, 0.38783196378128376f, 0.4011788956666944f},
    {0.07718014399383617f, 0.27287053225615854f, 0.35840595964288685f},
    {0.6620652343039318f, 0.9583353668696944f, 0.3156330236190793f},
    {0.69084912361899f, 0.09012173142079363f, 0.27286008759527186f},
    {0.11363168433935791f, 0.682868084649132f, 0.23008715157146412f},
    {0.8878617952426923f, 0.6359010963154224f, 0.18731421554765668f},
    {0.3329625946298537f, 0.19094991313621124f, 0.14454127952384924f},
    {0.4344637337558595f, 0.8129275139475807f, 0.10176834350004149f},
    {0.7142998355198091f, 0.3694292318164736f, 0.058995407476234045f},
    {0.3631291215826654f, 0.4862687487431819f, 0.016222471452426543f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 21: fibonacci_sphere(64)", "[votess]") {

  const int k = 63;
  std::vector<std::array<float, 3>> xyzset = {
    {0.466121007585302f, 0.5815291511301941f, 0.9968600266459421f},
    {0.6358236284988967f, 0.4306402583801314f, 0.981036851619816f},
    {0.31004869291067966f, 0.44359109866843593f, 0.96521367659369f},
    {0.6179724709398651f, 0.6952193819542799f, 0.9493905015675639f},
    {0.5487870998468379f, 0.24445855977151504f, 0.9335673265414378f},
    {0.2696648266628299f, 0.6664298931490087f, 0.9177441515153117f},
    {0.8025443922245971f, 0.5314649028441476f, 0.9019209764891857f},
    {0.2834171107688617f, 0.25375685478075144f, 0.8860978014630596f},
    {0.4913285182343308f, 0.8420329370631965f, 0.8702746264369335f},
    {0.7470690385257251f, 0.2380280403940191f, 0.8544514514108075f},
    {0.12423898112359665f, 0.5234905394259821f, 0.8386282763846814f},
    {0.8020251364688313f, 0.7413139778022148f, 0.8228051013585553f},
    {0.4366851289261117f, 0.1017373073574847f, 0.8069819263324293f},
    {0.2695257983882215f, 0.8423697799696751f, 0.7911587513063032f},
    {0.9099990872767483f, 0.396862187189984f, 0.7753355762801771f},
    {0.11763276111013551f, 0.290556840074096f, 0.7595124012540511f},
    {0.6417582361939398f, 0.9175800529878743f, 0.743689226227925f},
    {0.6792402309614624f, 0.08484980773137832f, 0.7278660512017989f},
    {0.07869671984646326f, 0.6843744241247862f, 0.7120428761756729f},
    {0.9402005429578368f, 0.647090214025087f, 0.6962197011495468f},
    {0.2700058997234361f, 0.08479680710917081f, 0.6803965261234207f},
    {0.3860970925230969f, 0.963359602567379f, 0.6645733510972947f},
    {0.8996362154774288f, 0.2285795940878894f, 0.6487501760711686f},
    {0.015725335339952018f, 0.4257074522831086f, 0.6329270010450425f},
    {0.8078061835380119f, 0.881293864085196f, 0.6171038260189166f},
    {0.5291462661200368f, 0.003596632393373771f, 0.6012806509927905f},
    {0.1393510496374482f, 0.8446529694098389f, 0.5854574759666644f},
    {0.9995765323858908f, 0.4856263969123239f, 0.5696343009405384f},
    {0.11874737637423145f, 0.1680425978468616f, 0.5538111259144123f},
    {0.5553908312382815f, 0.999999f, 0.5379879508882862f},
    {0.795817221103537f, 0.08930982751825621f, 0.5221647758621601f},
    {0.002304373942076932f, 0.5993189298060014f, 0.5063416008360341f},
    {0.9324071033020008f, 0.7591657203014243f, 0.49051842580990807f},
    {0.3546938604714358f, 0.013498681949294926f, 0.4746952507837819f},
    {0.27728432283088883f, 0.952204814176386f, 0.4588720757576559f},
    {0.9666302007610145f, 0.31375913422095164f, 0.4430489007315298f},
    {0.030312153560093848f, 0.319049313321283f, 0.42722572570540374f},
    {0.7213169957553299f, 0.9446692210862463f, 0.41140255067927767f},
    {0.6346801743102641f, 0.02173361444938413f, 0.3955793756531516f},
    {0.07898267721030106f, 0.7560387770430551f, 0.37975620062702553f},
    {0.977717749442889f, 0.591034781212807f, 0.36393302560089946f},
    {0.2103353363446693f, 0.11011683751596717f, 0.34810985057477345f},
    {0.4490972517216175f, 0.9741867649126764f, 0.3322866755486473f},
    {0.8518426362040047f, 0.18479085290962335f, 0.31646350052252126f},
    {0.032375385383010685f, 0.4910720310989847f, 0.30064032549639524f},
    {0.8320014421314672f, 0.8138368354491401f, 0.2848171504702691f},
    {0.4660710748451961f, 0.04821470887380615f, 0.268993975444143f},
    {0.2233889320753758f, 0.8456794033132112f, 0.25317080041801715f},
    {0.9267785188126647f, 0.4296160518460407f, 0.23734762539189092f},
    {0.14438458193247222f, 0.26528422534457746f, 0.22152445036576496f},
    {0.5993734890923117f, 0.8990571684129471f, 0.2057012753396389f},
    {0.6890711710086805f, 0.1451121922161752f, 0.18987810031351277f},
    {0.13116541478748575f, 0.626020505373411f, 0.17405492528738664f},
    {0.8427845915074482f, 0.6469792746149199f, 0.15823175026126063f},
    {0.35099429293689866f, 0.1699589176184838f, 0.14240857523513464f},
    {0.3904095074315973f, 0.8246890679747872f, 0.12658540020900852f},
    {0.7827922722709039f, 0.33957911322543344f, 0.1107622251828825f},
    {0.2007357181079949f, 0.42803849411179956f, 0.09493905015675644f},
    {0.6579813542933908f, 0.7331656941296032f, 0.07911587513063031f},
    {0.5357526134402553f, 0.2422184622510162f, 0.06329270010450432f},
    {0.32004681239182015f, 0.6440180911485702f, 0.04746952507837819f},
    {0.6943110620999176f, 0.5096301548760601f, 0.03164635005225213f},
    {0.39155171674093503f, 0.38865986216135995f, 0.015823175026126065f},
    {0.5011419374966639f, 0.5875478231217802f, 1e-06f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 22: fibonacci_sphere(128)", "[votess]") {

  const int k = 127;
  std::vector<std::array<float, 3>> xyzset = {
    {0.47561963165782944f, 0.5566745978211572f, 0.9963261774423666f},
    {0.5951941327957972f, 0.45050951648089155f, 0.9884834237465653f},
    {0.36492936058337355f, 0.4594830424820098f, 0.9806406700507639f},
    {0.5833084185693205f, 0.6382325318397801f, 0.9727979163549627f},
    {0.5342705603379664f, 0.31695410000045643f, 0.9649551626591614f},
    {0.3342315661663171f, 0.6188077051328434f, 0.95711240896336f},
    {0.7174232936855227f, 0.5221126912541878f, 0.9492696552675587f},
    {0.34267578180727853f, 0.32120641981858306f, 0.9414269015717573f},
    {0.49314641444321994f, 0.748213043801219f, 0.933584147875956f},
    {0.6800323363829199f, 0.30799319801191444f, 0.9257413941801548f},
    {0.22345206503841733f, 0.5167193416952371f, 0.9178986404843534f},
    {0.7224686998801305f, 0.6776430312355386f, 0.9100558867885521f},
    {0.45247989878742306f, 0.20385794259012888f, 0.9022131330927508f},
    {0.3274728026480414f, 0.7550045334705235f, 0.8943703793969494f},
    {0.807207833060834f, 0.42208122773334683f, 0.8865276257011481f},
    {0.2108534883563413f, 0.34139114350372657f, 0.8786848720053468f},
    {0.6071535121300421f, 0.8166101787510367f, 0.8708421183095455f},
    {0.6364618541809183f, 0.1823096669550977f, 0.8629993646137442f},
    {0.17557359939354206f, 0.6412860967857573f, 0.8551566109179428f},
    {0.8402171810621116f, 0.613366059644739f, 0.8473138572221415f},
    {0.3203291483612275f, 0.17601900712339016f, 0.8394711035263401f},
    {0.4101734917321863f, 0.8631009356176452f, 0.8316283498305389f},
    {0.8153737330133655f, 0.2850558266408673f, 0.8237855961347376f},
    {0.11399653913937154f, 0.4404118271978635f, 0.8159428424389362f},
    {0.746529408148548f, 0.8054899018410696f, 0.8081000887431349f},
    {0.5231526420986538f, 0.098121991574558f, 0.8002573350473335f},
    {0.20550375178264396f, 0.7806355731718201f, 0.7924145813515322f},
    {0.9104812063187941f, 0.4877809340320702f, 0.784571827655731f},
    {0.1832514800020604f, 0.2241565490464877f, 0.7767290739599296f},
    {0.5460158595337401f, 0.9183749203914774f, 0.7688863202641283f},
    {0.7497760774975379f, 0.15236735468345056f, 0.761043566568327f},
    {0.07458192384413642f, 0.5844781997758572f, 0.7532008128725256f},
    {0.8728426507645556f, 0.7233317028247226f, 0.7453580591767243f},
    {0.37290860099890377f, 0.0752326058975809f, 0.737515305480923f},
    {0.3031704543922031f, 0.8987261131618994f, 0.7296725517851217f},
    {0.9163870543973646f, 0.33341088438089694f, 0.7218297980893204f},
    {0.07508335398035182f, 0.3361322279858297f, 0.713987044393519f},
    {0.7024667786551175f, 0.907048383228856f, 0.7061442906977177f},
    {0.624829631694812f, 0.055663586499476565f, 0.6983015370019163f},
    {0.10318043221427699f, 0.7409858329344744f, 0.6904587833061151f},
    {0.9567078842210198f, 0.586879633698729f, 0.6826160296103138f},
    {0.2183313412313591f, 0.12093567518159376f, 0.6747732759145124f},
    {0.44955013863602944f, 0.9685558252666168f, 0.6669305222187111f},
    {0.8539495355539386f, 0.1826970334393852f, 0.6590877685229097f},
    {0.02030052656145182f, 0.49076457389324385f, 0.6512450148271084f},
    {0.8474555719566521f, 0.8284429482569884f, 0.6434022611313072f},
    {0.4636991348249867f, 0.016746247632161163f, 0.6355595074355058f},
    {0.19719902980940493f, 0.8784765564744649f, 0.6277167537397045f},
    {0.9791395008131385f, 0.42106652376142967f, 0.6198740000439031f},
    {0.09000625409631184f, 0.22943450884401193f, 0.6120312463481018f},
    {0.6181886765401369f, 0.9740837720177952f, 0.6041884926523005f},
    {0.7320697693110797f, 0.0650836361276912f, 0.5963457389564992f},
    {0.03188981116541574f, 0.660349667674788f, 0.5885029852606979f},
    {0.9529478099518316f, 0.6944344981960677f, 0.5806602315648965f},
    {0.2950477580102335f, 0.045461736852582035f, 0.5728174778690952f},
    {0.3419459065227408f, 0.9705886027911458f, 0.5649747241732939f},
    {0.9334916794822683f, 0.2552101677671565f, 0.5571319704774925f},
    {0.012370548919559965f, 0.3834078429021664f, 0.5492892167816913f},
    {0.779427897489948f, 0.9118966334813619f, 0.54144646308589f},
    {0.5704861635468982f, 0.002846662842371051f, 0.5336037093900886f},
    {0.11002976207260175f, 0.8152086772212765f, 0.5257609556942873f},
    {0.9990465882013716f, 0.5269424995123813f, 0.5179182019984859f},
    {0.1482537362720472f, 0.13878206940878512f, 0.5100754483026846f},
    {0.5135780940420747f, 0.999999f, 0.5022326946068834f},
    {0.8259399076538982f, 0.11806913778643457f, 0.49438994091108207f},
    {1e-06f, 0.5573657110675811f, 0.4865471872152807f},
    {0.9054421950671754f, 0.7912276955460054f, 0.47870443351947933f},
    {0.3960429504546641f, 0.007671241970916422f, 0.47086167982367805f},
    {0.2425491055337305f, 0.928753094813431f, 0.46301892612787676f},
    {0.9770732430488941f, 0.35385937532305123f, 0.4551761724320753f},
    {0.048376749931375626f, 0.2817469531275763f, 0.4473334187362741f},
    {0.6834713746140265f, 0.9611243142299062f, 0.4394906650404727f},
    {0.6740566721588249f, 0.032898010906563684f, 0.4316479113446714f},
    {0.05533414373840665f, 0.7222756920366349f, 0.4238051576488701f},
    {0.975040074424876f, 0.6320585962582753f, 0.41596240395306877f},
    {0.23785316801980735f, 0.07882710960461711f, 0.40811965025726743f},
    {0.40728437625810515f, 0.9820915713087255f, 0.40027689656146614f},
    {0.8909186825546607f, 0.20405043607745005f, 0.3924341428656648f},
    {0.011794226049221828f, 0.450260481562809f, 0.3845913891698635f},
    {0.8233340225583087f, 0.8609719596596656f, 0.3767486354740621f},
    {0.5036013449522718f, 0.013371904745229635f, 0.36890588177826084f},
    {0.16831573314999218f, 0.8507397986061999f, 0.3610631280824595f},
    {0.9774099160290424f, 0.46152630953304064f, 0.35322037438665826f},
    {0.1221097698826318f, 0.2033135801071455f, 0.34537762069085687f},
    {0.5760208438264881f, 0.9674084803823648f, 0.3375348669950555f},
    {0.7563940971333103f, 0.10220422564754353f, 0.32969211329925424f},
    {0.04322315300783589f, 0.6153409087628776f, 0.3218493596034529f},
    {0.9102664286451563f, 0.7180037057640017f, 0.3140066059076515f},
    {0.3440042954854612f, 0.06103717045081819f, 0.3061638522118503f},
    {0.31802142005227424f, 0.9219142574740625f, 0.29832109851604893f},
    {0.9142169524858814f, 0.3091871683093362f, 0.2904783448202476f},
    {0.0673539960799822f, 0.35795550785031904f, 0.2826355911244462f},
    {0.7193996327678581f, 0.8895905421762041f, 0.274792837428645f},
    {0.598694552896263f, 0.06433531492418845f, 0.2669500837328436f},
    {0.1345759985303911f, 0.7481473746979004f, 0.25910733003704234f},
    {0.9309801610761245f, 0.559184670883908f, 0.25126457634124105f},
    {0.22327441909842802f, 0.164655754042241f, 0.24342182264543968f},
    {0.47598032159422826f, 0.9254097579212761f, 0.2355790689496383f},
    {0.7997713836401421f, 0.20191465407759582f, 0.22773631525383697f},
    {0.08093105315033797f, 0.5130508323519926f, 0.21989356155803572f},
    {0.8119715336746446f, 0.7659158299940789f, 0.21205080786223443f},
    {0.44847320477364094f, 0.09462899416596067f, 0.20420805416643295f},
    {0.2657339959611989f, 0.8249248165190043f, 0.1963653004706317f},
    {0.8845356798195393f, 0.41583923117064564f, 0.18852254677483035f},
    {0.16322661941419156f, 0.30141427611574684f, 0.1806797930790291f},
    {0.6104695279921848f, 0.8635879465436014f, 0.17283703938322778f},
    {0.6594215948525015f, 0.1593670446268814f, 0.1649942856874265f},
    {0.15715308592942012f, 0.6367347513722509f, 0.15715153199162507f},
    {0.8364147604047526f, 0.6241019178153243f, 0.1493087782958238f},
    {0.33750795848615245f, 0.18407621160427795f, 0.14146602460002242f},
    {0.4067721758692846f, 0.8308217680106202f, 0.13362327090422116f},
    {0.7832289119186867f, 0.3194740936623404f, 0.1257805172084198f},
    {0.17616794400146402f, 0.439323255260697f, 0.11793776351261852f},
    {0.6903683927415726f, 0.7519688895759409f, 0.11009500981681719f},
    {0.527120359573885f, 0.19131417714143523f, 0.10225225612101592f},
    {0.2773664570503916f, 0.6982780090846574f, 0.0944095024252145f},
    {0.785371240382763f, 0.5000422831176917f, 0.08656674872941317f},
    {0.29631037643122654f, 0.3110091985663644f, 0.07872399503361195f},
    {0.5197356126441267f, 0.7605793388794674f, 0.07088124133781053f},
    {0.6515870578443651f, 0.30086741077163476f, 0.06303848764200931f},
    {0.26589977110299345f, 0.5379779020135469f, 0.05519573394620788f},
    {0.6835590704959832f, 0.617725862436681f, 0.047352980250406615f},
    {0.4466495477070829f, 0.30140371057234555f, 0.03951022655460529f},
    {0.4121073985815029f, 0.6618729021191564f, 0.03166747285880397f},
    {0.652427723681444f, 0.44307920100115633f, 0.023824719163002644f},
    {0.37022446318044255f, 0.44453270541953765f, 0.015981965467201268f},
    {0.5435101373988096f, 0.5964355184337101f, 0.0081392117714f},
    {0.517412222685281f, 0.4386762566897962f, 0.00029645807559867737f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 23: noisy_data", "[votess]") {

  const int k = 26;
  std::vector<std::array<float, 3>> xyzset = {
    {0.13576300896660726f, 0.10893307251179446f, 0.08120954762440447f},
    {0.22276701271604815f, 0.06150741266078533f, 0.6349986802058538f},
    {0.06304378882156225f, 0.15833300324415767f, 0.8901745711223129f},
    {0.0934328592351688f, 0.5913857198316887f, 0.06383438508270695f},
    {0.21845555467254507f, 0.6406588370990214f, 0.510099731619385f},
    {0.19583914191568152f, 0.6246485481251837f, 0.7609303442587159f},
    {0.2178637863060613f, 0.8083222832573527f, 0.019611232079343247f},
    {0.10183142088927351f, 0.8211606945422536f, 0.34111137861004415f},
    {0.020167096103478402f, 0.8149892690914389f, 0.7892742268671055f},
    {0.511953077841123f, 0.08549563643120031f, 0.1284434812548495f},
    {0.46252200930672005f, 0.0535175289008007f, 0.6486106166393018f},
    {0.3120617036922852f, 1e-06f, 0.8985285759780298f},
    {0.37603323864110005f, 0.5492401655198484f, 0.043216612332966246f},
    {0.3929217547588772f, 0.4292741742028543f, 0.5196095213235705f},
    {0.5454222791428416f, 0.5972375983774556f, 0.8741579688842896f},
    {0.435706809204046f, 0.7975676749260396f, 0.06696812248211712f},
    {0.5191332164700785f, 0.8747849378681553f, 0.4669516087727292f},
    {0.4877725452076432f, 0.9641269897798316f, 0.9926680131704546f},
    {0.8340730214708456f, 0.0031632362013689075f, 0.15119335863600458f},
    {0.7246975755124245f, 0.17713273423536785f, 0.611544087002112f},
    {0.999999f, 0.2196039209130523f, 0.8999185296043967f},
    {0.8527577109691521f, 0.4905504907416435f, 0.09213476489115477f},
    {0.8926637159125829f, 0.3726720498722511f, 0.4340431484170403f},
    {0.8601842032906406f, 0.5991467714672478f, 0.9762800337486934f},
    {0.999999f, 0.9855117505825352f, 0.03179134881903778f},
    {0.7494026676874698f, 0.6778347501456532f, 0.6353963008454018f},
    {0.8595985505201562f, 0.9715870672597251f, 0.8400299759176633f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 24: imbalanced_classes", "[votess]") {

  const int k = 1009;
  std::vector<std::array<float, 3>> xyzset = {
    {0.5938513642059672f, 0.15144733744995476f, 0.3262241535371907f},
    {0.21633518294363396f, 0.6040615039466639f, 0.8967436003830471f},
    {0.9961043716978675f, 0.1913902839878071f, 0.5505780078086037f},
    {0.274088008162382f, 0.4887044689620368f, 0.3188719453131218f},
    {0.6160239848238879f, 0.25202718562915905f, 0.05618907785243865f},
    {0.23443109900958148f, 0.8396888709725063f, 0.8201638277027161f},
    {0.5737953263871682f, 0.371444275743684f, 0.27237983720614267f},
    {0.705597529592703f, 0.09639434242547329f, 0.014974926835565006f},
    {0.16470645212761215f, 0.7083445794145947f, 0.7926997541531038f},
    {0.16583292017893936f, 0.29910581108600187f, 0.045510334308749734f},
    {0.6581114429909071f, 0.34282130077885176f, 0.005492959098337025f},
    {0.4214259687320192f, 0.1946007769741871f, 0.2950803575270551f},
    {0.6045670495476432f, 0.438919121576963f, 0.7934254114985562f},
    {0.7643221434040722f, 0.33004003945971716f, 0.3819853158530807f},
    {0.20833699317071042f, 0.1781578863971306f, 0.0958204172484649f},
    {0.15959645045460713f, 0.7150883977919579f, 0.9346405008926305f},
    {0.19070976823905528f, 0.180014852805377f, 0.7609809235147523f},
    {0.07551855285393394f, 0.5639950526053713f, 0.14400043467669144f},
    {0.4847044275631922f, 0.7425375230940648f, 0.6375815167864128f},
    {0.620762717707025f, 0.24103096609617547f, 0.8301784138552839f},
    {0.40607407301995746f, 0.020246639862245508f, 0.3427426161320558f},
    {0.9189403592088516f, 0.10490892530552864f, 0.8584203610751806f},
    {0.1794434430264038f, 0.8033098043233432f, 0.4494114305738851f},
    {0.18113218978244816f, 0.6722390020222304f, 0.4450509104084355f},
    {0.05867615094424572f, 0.15587748832380433f, 0.9680548300329034f},
    {0.4911230050006238f, 0.5874660966042741f, 0.025310219802024303f},
    {0.44572730736420585f, 0.15496089676263114f, 0.9806076791713f},
    {0.08846162539659452f, 0.2509480842259786f, 0.03863819303634708f},
    {0.16449866389797652f, 0.7153178777348953f, 0.590705856281186f},
    {0.6583904075494144f, 0.17375445626010033f, 0.7825876978468463f},
    {0.8199688204504346f, 0.10559290975017543f, 0.1890245378975537f},
    {0.3977440808222841f, 0.06916846248474573f, 0.44558284411209725f},
    {0.8245382276425532f, 0.6120338478604167f, 0.19778627018506034f},
    {0.3461192562392763f, 0.18685846687985408f, 0.4854062163182491f},
    {0.2952702577221218f, 0.8719164191876061f, 0.29629448365575506f},
    {0.5663152776282941f, 0.13055220693694947f, 0.33312397894355117f},
    {0.7720935675016671f, 0.9759027783427505f, 0.855428939696998f},
    {0.4897442945024778f, 0.8329205936266395f, 0.31965352061383945f},
    {0.11452096875833295f, 0.25116320961458416f, 0.7878931303237566f},
    {0.17021193076091357f, 0.326923956015885f, 0.7875278445337719f},
    {0.5801792427625067f, 0.9577320715864202f, 0.9050768444469756f},
    {0.7839927110337629f, 0.9941850201525834f, 0.6823207201730107f},
    {0.8275770256638263f, 0.40434643817129645f, 0.5391300417582275f},
    {0.1527024617014915f, 0.8046029744999771f, 0.8727545793691406f},
    {0.36097667265131184f, 0.4849747137792132f, 0.007867134993994718f},
    {0.35187588156473526f, 0.5341062559882365f, 0.1694937683606632f},
    {0.34540442058539866f, 0.7627209614340547f, 0.050054047677166036f},
    {0.8454565671454284f, 0.3331390653897154f, 0.39228389326397106f},
    {0.2943214609624384f, 0.5398881904116232f, 0.8452570867618407f},
    {0.6910852097899912f, 0.5222727668328965f, 0.11780195671006322f},
    {0.3044039324781814f, 0.3175665637040368f, 0.48273787823761416f},
    {0.3154864982991058f, 0.5667279813591176f, 0.1910222509591657f},
    {0.9243179149616728f, 0.3741716312969189f, 0.6926933953256557f},
    {0.6401698948103237f, 0.38810298737648385f, 0.27157394359164777f},
    {0.6803669837982447f, 0.984164777534728f, 0.33364715609627893f},
    {0.0040239618453551396f, 0.5552286103871772f, 0.2580031661415728f},
    {0.07070364737496604f, 0.4107508184847817f, 0.8745797197268502f},
    {0.774209823281152f, 0.24259422508225836f, 0.9190545145128995f},
    {0.2123743241063788f, 0.5122341487456464f, 0.21413131251982842f},
    {0.4681718383140342f, 0.20328586386663672f, 0.12141955470521504f},
    {0.9361977799442269f, 0.6831112403930661f, 0.09124841613005541f},
    {0.11958161398359224f, 0.6088196274463263f, 0.41439321027939136f},
    {0.20575145668099248f, 0.5831065652137503f, 0.7754653433138449f},
    {0.2734030896574716f, 0.5691927490532397f, 0.7489123131401665f},
    {0.5472036716629409f, 0.47896805208299553f, 0.7634704050003346f},
    {0.8265647121462223f, 0.07704576375435246f, 0.040509165522542134f},
    {0.5780272419515091f, 0.6690811000257356f, 0.14659927811898676f},
    {0.44190570604346846f, 0.46085432606448584f, 0.5974548190083809f},
    {0.2487377977129005f, 0.6532047743539471f, 0.26690728776179273f},
    {0.9309428913160503f, 0.6371224997169205f, 0.9764004973512508f},
    {0.6962981801222254f, 0.26927299125514603f, 0.8600270590133688f},
    {0.47322474265866266f, 0.21369529253147668f, 0.020783981405684826f},
    {0.8493917773934069f, 0.06688017470866847f, 0.5851685619615736f},
    {0.5982778499224239f, 0.46922794007012014f, 0.38212237418624984f},
    {0.12307957514093737f, 0.6058163538261403f, 0.5656827970556325f},
    {0.48034824432573753f, 0.49742171873092345f, 0.2097038430466115f},
    {0.7224994730796483f, 0.32518213643324634f, 0.23449534220134927f},
    {0.7222460803743687f, 0.9255983078868616f, 0.34310434974313897f},
    {0.0020992470161127486f, 0.0647243009613292f, 0.00958266781208228f},
    {0.8373902550508501f, 0.6028458595745808f, 0.13898290046635675f},
    {0.4321792118501828f, 0.6011962132415575f, 0.3530724696930799f},
    {0.3329468515936209f, 0.47183658667810824f, 0.5596312086708458f},
    {0.30226884681425614f, 0.7948295299124192f, 0.7511299785697f},
    {0.4128974456456743f, 0.09030197770186366f, 0.36670507796424867f},
    {0.01155076754150175f, 0.21864815294346085f, 0.11773786396063513f},
    {0.0026166926430515325f, 0.4476453428977417f, 0.9466536219124169f},
    {0.6630032722598792f, 0.6693041528774432f, 0.30535608134681935f},
    {0.4548231998171929f, 0.11331532866786864f, 0.8238637711869407f},
    {0.9062722465163617f, 0.9104545354175264f, 0.40623544784356413f},
    {0.1662502982310693f, 0.9399143269199004f, 0.06202136127976132f},
    {0.6401120596492771f, 0.3245425557077166f, 0.660612259209939f},
    {0.1046193218485415f, 0.4980976701063753f, 0.6568305470416054f},
    {0.2696737943863372f, 0.42148200813050163f, 0.5742334818791384f},
    {0.7191569013605735f, 0.933853788860855f, 0.0008313489542748354f},
    {0.3314531711673522f, 0.6396707074452842f, 0.45018460249470615f},
    {0.8414206095287675f, 0.6487232507371266f, 0.7237350910685172f},
    {0.09003785193094005f, 0.06811931559076279f, 0.26079057980005016f},
    {0.3018766065306909f, 0.17546686160471836f, 0.8463727990662322f},
    {0.4304870428361598f, 0.5792513497350236f, 0.07605211334832285f},
    {0.8695356671552217f, 0.4534412878614883f, 0.28277106302852895f},
    {0.8092127036504312f, 0.16863266567775137f, 0.16384033505298345f},
    {0.6015759746960704f, 0.9838331093482172f, 0.7976549599107496f},
    {0.6971905525440238f, 0.6015696205897152f, 0.7695268669675605f},
    {0.5222516154032025f, 0.09924437706948386f, 0.5173208513145803f},
    {0.7648572016766032f, 0.9448887823131833f, 0.6352216047094044f},
    {0.504251538069266f, 0.05828708178202513f, 0.283095991011847f},
    {0.6981380975480383f, 0.10293012144460623f, 0.1815462465503923f},
    {0.7490958165935888f, 0.18593575367149828f, 0.39573638502580044f},
    {0.6952215704844078f, 0.7636536124085949f, 0.8999250871500317f},
    {0.7416806718451389f, 0.16300736635517488f, 0.12633334145068842f},
    {0.02128033895005066f, 0.29386916198213353f, 0.08803830725027129f},
    {0.8757563806546929f, 0.8976230713000075f, 0.5758273461401178f},
    {0.5455628183403395f, 0.6735790200019369f, 0.19755728927746696f},
    {0.004672732711753724f, 0.13318042642146f, 0.697260635549027f},
    {0.8782091549482566f, 0.8905994420391793f, 0.024032356791334974f},
    {0.6920232337677138f, 0.4945724444482128f, 0.5253212291364969f},
    {0.14722163147478506f, 0.14382830537494318f, 0.0032098131615695413f},
    {0.22897673662603302f, 0.9094744782367234f, 0.2627829525754303f},
    {0.5618278692421571f, 0.05618285271902279f, 0.9474037455297877f},
    {0.6255477609375836f, 0.6070573715716939f, 0.706532895314436f},
    {0.9083976114816079f, 0.1854843108722799f, 0.6407383922183386f},
    {0.7300851365500776f, 0.41845433962596057f, 0.35823927077311424f},
    {0.2916133907984283f, 0.23175848653322706f, 0.44729457635273706f},
    {0.06638429573565086f, 0.25745787733821357f, 0.6965293912340884f},
    {0.24756032656952442f, 0.5747282532574063f, 0.8873605616423326f},
    {0.679924312541715f, 0.0994483893468161f, 0.24356549928000293f},
    {0.40455908215277747f, 0.7773281867995995f, 0.01705778329235219f},
    {0.7941355518650299f, 0.35735046539622706f, 0.6029945366224664f},
    {0.8896123533466407f, 0.8976882346287636f, 0.6310984206937642f},
    {0.09951712845161953f, 0.99010826359423f, 0.5141812148556697f},
    {0.15225074409400963f, 0.645867745190077f, 0.7630700162847229f},
    {0.6044917385158888f, 0.9319207818879227f, 0.30116444184775115f},
    {0.8289327518679741f, 0.6881580770172576f, 0.5866750487311374f},
    {0.08664662170323523f, 0.9338056468881538f, 0.04461985675661362f},
    {0.647846420720857f, 0.5206695374491015f, 0.048082622119515195f},
    {0.7166185672236627f, 0.58676212126333f, 0.9575394116727244f},
    {0.952055276539285f, 0.90515175284009f, 0.6309854115065864f},
    {0.1810702368253645f, 0.17148709026684938f, 0.8388836475519165f},
    {0.14566519605412231f, 0.9482120558223558f, 0.03455690474568318f},
    {0.6849913332167151f, 0.6474291198928231f, 0.910353422271937f},
    {0.20076046069740483f, 0.04304480924123488f, 0.3134267916399628f},
    {0.21869932724330066f, 0.8553932838894588f, 0.5305849061823218f},
    {0.34772196710552394f, 0.9185510001568593f, 0.9992681760386658f},
    {0.5652048239482174f, 0.4295236865747889f, 0.4165312858624646f},
    {0.23732595060146766f, 0.47441453585402404f, 0.5270321499095961f},
    {0.7570709133920537f, 0.481798412032411f, 0.3297826365386467f},
    {0.6947984225474069f, 0.6696325780870842f, 0.08070512802869068f},
    {0.1219963645603569f, 0.31458005675032363f, 0.7855809142059693f},
    {0.264380904360605f, 0.5602927548280009f, 0.34457213740240245f},
    {0.9738054525980694f, 0.6853518776227766f, 0.0682928582366431f},
    {0.7836373109679047f, 0.21389710973208942f, 0.9221224899785722f},
    {0.1465316754580288f, 0.34233491912298497f, 0.8212062301029041f},
    {0.6549763541910679f, 0.805528061874191f, 0.4058929595283032f},
    {0.1488002766405273f, 0.8487542553904056f, 0.5378456726376392f},
    {0.4555128686212103f, 0.8353194154746546f, 0.7129417912244351f},
    {0.48962716831609776f, 0.7586799798279463f, 0.035986266849237f},
    {0.9559657607849951f, 0.038651401308680056f, 0.7515086600046516f},
    {0.7460019055618003f, 0.1280605306478677f, 0.8415874765827395f},
    {0.896055357304658f, 0.3743819810210808f, 0.9120865624550061f},
    {0.7131935936915883f, 0.05377198075432754f, 0.48783710157034543f},
    {0.6120680870280316f, 0.7985428796082777f, 0.46937765079100424f},
    {0.6784746046137562f, 0.7115531213454779f, 0.1273247857927945f},
    {0.10657883650135958f, 0.716555346797978f, 0.025531239782017767f},
    {0.2092288194243831f, 0.85356874858512f, 0.613529901246259f},
    {0.6700790972702481f, 0.03427844994638474f, 0.25771050911732085f},
    {0.5408508245405624f, 0.5538919960041386f, 0.1274587007386654f},
    {0.43134727999330336f, 0.9577852967038369f, 0.5629761040847078f},
    {0.21017877034213173f, 0.04881856354050884f, 0.804082598160192f},
    {0.25279180116213895f, 0.5617580726930628f, 0.911274777617239f},
    {0.08062495279515347f, 0.10387583821057988f, 0.14867406793879434f},
    {0.2393302842344044f, 0.5257851524563352f, 0.3287198452124288f},
    {0.5610323006805834f, 0.12000089246574819f, 0.503229852272624f},
    {0.6048617738937939f, 0.1964617352402971f, 0.2629296446614823f},
    {0.7078267742251081f, 0.9965613261599356f, 0.8493674676253208f},
    {0.08319663507058361f, 0.7166812131400744f, 0.5962603537957972f},
    {0.7762905169351345f, 0.6610186004888831f, 0.05062512876964986f},
    {0.5348541073003342f, 0.3627446657290698f, 0.4026126286282964f},
    {0.39589269930349935f, 0.42556008062671535f, 0.7310315046833669f},
    {0.2546443177188893f, 0.37439955374954625f, 0.5123765597963089f},
    {0.20586521184501827f, 0.9704406789518709f, 0.2645741467108803f},
    {0.6886870100916781f, 0.9497995505368846f, 0.33516482527407376f},
    {0.49282211467412107f, 0.5765664901528085f, 0.10414949279288199f},
    {0.03876855090888054f, 0.050123929575223936f, 0.33295163073101797f},
    {0.3834132690197246f, 0.7218537889644462f, 0.43802537670443475f},
    {0.559602873174847f, 0.48466995001503366f, 0.3584653584881662f},
    {0.9467108295623936f, 0.17110508869655194f, 0.8069658052160043f},
    {0.2683694429495772f, 0.08238602505192605f, 0.422601405641452f},
    {0.5977464180756559f, 0.4387659325597998f, 0.704841772802366f},
    {0.14751007785531967f, 0.5134165090714681f, 0.7462791215862835f},
    {0.1556990597173299f, 0.1306722334789744f, 0.705929938064901f},
    {0.2718164331489521f, 0.5390517396957635f, 0.7635780432797534f},
    {0.7627784555208953f, 0.3374368796722633f, 0.7994303258921428f},
    {0.3978776796343011f, 0.0005223886301903846f, 0.7636524681567967f},
    {0.8419795778847154f, 0.7885532534841241f, 0.2948050831812613f},
    {0.8725604219786984f, 0.701146927513732f, 0.48733602818831967f},
    {0.7533675883643967f, 0.27638927243256317f, 0.9923334071562967f},
    {0.7587532568781724f, 0.974345982451102f, 0.5344022738160337f},
    {0.2711835957609027f, 0.011825962467310491f, 0.10416867825116194f},
    {0.8003469615684087f, 0.9146961887020668f, 0.5260639218011152f},
    {0.7740698320088232f, 0.6932103867720414f, 0.8291046402625876f},
    {0.8869563264461465f, 0.2897263846651844f, 0.753134667117504f},
    {0.16344459506025144f, 0.009043382233145936f, 0.7212377633825352f},
    {0.797847638300449f, 0.9400765589266084f, 0.3857047256985606f},
    {0.5420391790073558f, 0.5695278179761629f, 0.6114048750020817f},
    {0.5028650735724253f, 0.3272056276645622f, 0.08474939884967192f},
    {0.803581414536145f, 0.5317998047900158f, 0.5554185910704695f},
    {0.7716256765333156f, 0.039792910517599034f, 0.12085270426832229f},
    {0.9507368580734343f, 0.485616535931645f, 0.5425430472876664f},
    {0.05588210380523562f, 0.185153776966128f, 0.8532622986782297f},
    {0.7310220337577672f, 0.5580626650114205f, 0.32778350934789646f},
    {0.861568435505268f, 0.8092075937094926f, 0.3246707713854249f},
    {0.7062971703236968f, 0.4846428106130588f, 0.0906558644691805f},
    {0.1183095981320389f, 0.8389414114305022f, 0.3086339951358944f},
    {0.08428178084425775f, 0.35692580844304556f, 0.6900891188342994f},
    {0.28008318011913125f, 0.9808799726493567f, 0.48507542065911957f},
    {0.6444081431104969f, 0.4893205737185967f, 0.924452535408386f},
    {0.38940421931156277f, 0.2326201807813838f, 0.46493763590741155f},
    {0.8460852346077935f, 0.1090774140269698f, 0.5801894097549215f},
    {0.5798597172144515f, 0.9439222105018563f, 0.5109732704698926f},
    {0.9184598467559623f, 0.29836697588520833f, 0.7204432731440117f},
    {0.7805835351603752f, 0.17262823406517736f, 0.8735332198634373f},
    {0.3331919592696312f, 0.12925438483257223f, 0.37908241344925575f},
    {0.7377806714027596f, 0.5408708011861685f, 0.6798404608795183f},
    {0.08538466732539551f, 0.06392473654769659f, 0.36397154936827325f},
    {0.6069045493919532f, 0.527391716859311f, 0.19127126113012238f},
    {0.6427780608047303f, 0.17711559160055335f, 0.3615141531644792f},
    {0.5533291387198509f, 0.9072497466458719f, 0.1101493961941955f},
    {0.30032148967847827f, 0.355617523442219f, 0.10117644952175442f},
    {0.7962827014380145f, 0.9926195153508055f, 0.8326039551791727f},
    {0.9384030401666513f, 0.4668108148405451f, 0.2709990833027127f},
    {0.5479015058571242f, 0.35510388083581856f, 0.1564756118505759f},
    {0.47599076085063163f, 0.21469951360334183f, 0.9210840660532487f},
    {0.7927564066830165f, 0.049986897480613246f, 0.9201011212218598f},
    {0.17707171127527976f, 0.13125312589287486f, 0.9746992669664037f},
    {0.561766797262975f, 0.8024834256336741f, 0.11339187238472881f},
    {0.5056859900133417f, 0.6740275028966101f, 0.919949766865238f},
    {0.5728008848384368f, 0.5052150700080041f, 0.9219569546646011f},
    {0.026758639519354976f, 0.0232042208861033f, 0.8232228198102974f},
    {0.3038156175728103f, 0.5406602335883297f, 0.07446159948723863f},
    {0.41217929450395163f, 0.7766679338761147f, 0.48844285568032386f},
    {0.3077003192961847f, 0.2765886129076963f, 0.6974893153881153f},
    {0.38630371579555467f, 0.727691446331954f, 0.7452547417133878f},
    {0.5357781482418044f, 0.5766466045343435f, 0.8272888942725879f},
    {0.31685253876007213f, 0.15445840070951677f, 0.8221347266704074f},
    {0.7264881018833755f, 0.7024628827621573f, 0.9032722578237106f},
    {0.17166305819178396f, 0.7201967014075079f, 0.9165049449564218f},
    {0.44515575963293463f, 0.6441462525898561f, 0.37634655833614306f},
    {0.9251715009326547f, 0.9116743190876434f, 0.1682846844813124f},
    {0.9646276739960994f, 0.8387753071574219f, 0.4545585857752644f},
    {0.8098074289908812f, 0.9418229801257387f, 0.24652511365762686f},
    {0.37190407673195724f, 0.8454062339608197f, 0.5216228571343717f},
    {0.19887113635673148f, 0.8557669273062303f, 0.3298937522984283f},
    {0.4428104709511692f, 0.7186173281157546f, 0.8073331167414212f},
    {0.8499366879917837f, 0.5123980570465139f, 0.798041162211467f},
    {0.24554462436144597f, 0.28298129441264064f, 0.3338567303132568f},
    {0.7311278843737585f, 0.16492184927108955f, 0.36708492811441673f},
    {0.44689922118708814f, 0.038940104810019416f, 0.8834041511260627f},
    {0.04072694495418405f, 0.6598575186263206f, 0.646944006902956f},
    {0.47005369044374556f, 0.3874380168464172f, 0.1886666212460859f},
    {0.3487097934159742f, 0.3387110803313632f, 0.23415474149240512f},
    {0.5216264702437436f, 0.05542975025356178f, 0.6102015960985009f},
    {0.885395396045543f, 0.22052899298735018f, 0.6299974841202097f},
    {0.4660422855325329f, 0.3102948348648754f, 0.5232774854219312f},
    {0.5628326410925524f, 0.6085565965703645f, 0.38187482491974833f},
    {0.10126534909610185f, 0.7508383965901375f, 0.7837093426610272f},
    {0.09508520089464123f, 0.4404823757281384f, 0.27744344345269456f},
    {0.9914655068333098f, 0.25843789472903145f, 0.24126906052471664f},
    {0.21280106490100936f, 0.6826280482720152f, 0.5264369724416181f},
    {0.7737124987756875f, 0.9555505132913754f, 0.8641097761099826f},
    {0.2022192824370309f, 0.5848245102185204f, 0.49356677199308996f},
    {0.8667811763262862f, 0.6777737350903932f, 0.5942893291660093f},
    {0.23772826650016055f, 0.6567069789663502f, 0.13701895891600435f},
    {0.8252156462778468f, 0.21317862773308727f, 0.28589994823746656f},
    {0.5724676279813128f, 0.14206915292727673f, 0.9471313543642083f},
    {0.07961332839740909f, 0.8599130122124821f, 0.1262505509163182f},
    {0.7431084980624073f, 0.6673675848310432f, 0.3603962206733582f},
    {0.8912732389091914f, 0.004002438852806489f, 0.7392688931325929f},
    {0.47642715776969824f, 0.615178397663974f, 0.5145773100252522f},
    {0.10136994959550294f, 0.6975147623326132f, 0.5472719215563726f},
    {0.030181894764037098f, 0.9097721107883049f, 0.9902404380608135f},
    {0.983730542931475f, 0.8860891593948382f, 0.5315205844137361f},
    {0.10152659777171946f, 0.24980770548830744f, 0.7750713429062391f},
    {0.044585978499718903f, 0.29085963921016633f, 0.11787206639857861f},
    {0.09010016112488528f, 0.18736097914936978f, 0.1963077203138759f},
    {0.9726604219545215f, 0.12708493463433923f, 0.8256989063543381f},
    {0.08876814157740609f, 0.6988313894831545f, 0.5007408442372298f},
    {0.04395196236936927f, 0.042702136935980795f, 0.7749172850870686f},
    {0.21256288924827105f, 0.004888964157512721f, 0.18959546467337318f},
    {0.9330588013146494f, 0.3658847448357636f, 0.13417746286040932f},
    {0.7197730456358358f, 0.28952247402710984f, 0.05783591151461254f},
    {0.1958228518175854f, 0.8642617521938198f, 0.6190759739722991f},
    {0.7443111264825739f, 0.46857931473467784f, 0.34514360625043794f},
    {0.8740024013324597f, 0.9566323518521359f, 0.5167200397394789f},
    {0.4999478747993621f, 0.27174042796988307f, 0.9280665457872515f},
    {0.41028496338104314f, 0.43145564446270823f, 0.8800877506728848f},
    {0.8992710441147802f, 0.7868440701816305f, 0.3228633189749055f},
    {0.4971000092091096f, 0.3478770577777518f, 0.29953549598654705f},
    {0.033047923030121495f, 0.42088530073938524f, 0.6158292412944781f},
    {0.9848607716903628f, 0.8532777665208411f, 0.9570082833339381f},
    {0.3646136600177343f, 0.5695392757236615f, 0.16494974175519383f},
    {0.1282977968053769f, 0.760081906349447f, 0.5653257120245496f},
    {0.7571682868587125f, 0.09544631931558012f, 0.8904299827211508f},
    {0.40848793373465775f, 0.4416937920490642f, 0.7756569329599812f},
    {0.1116893830154897f, 0.15801373627921456f, 0.7367029702117958f},
    {0.8155409466048773f, 0.07346922161724423f, 0.49273495317054716f},
    {0.7509579322585028f, 0.8494366341540822f, 0.5757222213132681f},
    {0.2737378795336606f, 0.49179240435229254f, 0.9658512606651777f},
    {0.04820110889521412f, 0.30634516409029555f, 0.057943103948108865f},
    {0.9682797859328599f, 0.7008962178099514f, 0.7821934550521862f},
    {0.48430427436165135f, 0.6459828879567036f, 0.2656606348743641f},
    {0.3256644643349853f, 0.2172707567902512f, 0.9714080317492111f},
    {0.4892686907876608f, 0.916695777110098f, 0.09905426693032882f},
    {0.05893614374541534f, 0.6848563896317027f, 0.8605833516900808f},
    {0.6321936283759549f, 0.03380417022163584f, 0.010487361911193371f},
    {0.21120370701179114f, 0.8383015374989804f, 0.16139931055371182f},
    {0.7241207405639241f, 0.6224532526783595f, 0.7416665572875144f},
    {0.27688461023126565f, 0.4742564801659367f, 0.4992282163611055f},
    {0.9410490075155425f, 0.5055282534520188f, 0.08337930513862801f},
    {0.4179954142048641f, 0.03401399287116669f, 0.15581992098463016f},
    {0.596337434796946f, 0.668018143607503f, 0.4498466097582141f},
    {0.905904823583452f, 0.5215571638712119f, 0.9695509049977741f},
    {0.2005908052080252f, 0.45966030747540154f, 0.8524675663860017f},
    {0.6182294756605194f, 0.2853976733047805f, 0.18559107833526567f},
    {0.1801350941735168f, 0.1315441460292356f, 0.9649518619096407f},
    {0.5886133280193918f, 0.9667452780863368f, 0.2724633573266789f},
    {0.7014089497843013f, 0.02019437237436461f, 0.42768793885129064f},
    {0.5111370858010079f, 0.831978339480195f, 0.7029443531150465f},
    {0.4365027332569501f, 0.6048663160486041f, 0.008513995091053994f},
    {0.9824011495092373f, 0.8257440139939476f, 0.3251407980658594f},
    {0.5661963044232152f, 0.922986857610644f, 0.6378286895342693f},
    {0.4175000583290045f, 0.740541826902225f, 0.4642399152169281f},
    {0.0752283103730711f, 0.7446600483339005f, 0.8448186006398857f},
    {0.01977024408911776f, 0.6818557206025614f, 0.09449584526383026f},
    {0.6941102234377289f, 0.7967417165931832f, 0.39106259057785697f},
    {0.5739627863276037f, 0.24997081857356107f, 0.07207936852771812f},
    {0.26611114415060644f, 0.7860646011453404f, 0.006109060569828406f},
    {0.2267168121936478f, 0.7247443648658682f, 0.8926914147040562f},
    {0.5367294673049301f, 0.16299352823477198f, 0.8305568357783907f},
    {0.6464913408250841f, 0.5272397530426993f, 0.3857275396826726f},
    {0.33455239037678686f, 0.5733894737601924f, 0.4072476011248145f},
    {0.6294813975287268f, 0.5328244907689798f, 0.9580520120988874f},
    {0.5348842471194498f, 0.8252290125921735f, 0.1862771053163781f},
    {0.8752129924905788f, 0.040123591226550626f, 0.5331046235458948f},
    {0.15211919390079354f, 0.9249055279899603f, 0.2574968471377982f},
    {0.7651815256822395f, 0.21803242234131415f, 0.4770824682788717f},
    {0.11262164515590278f, 0.7055974527375035f, 0.05203237638263358f},
    {0.6820335926669685f, 0.2639746247997854f, 0.7973758800479238f},
    {0.7024476635311304f, 0.4089556391751795f, 0.5253846524972543f},
    {0.4234761714478753f, 0.23720342898836944f, 0.04662932340662729f},
    {0.3512262941736992f, 0.6578167109898987f, 0.6667892082862577f},
    {0.00886783153513071f, 0.5998816359887513f, 0.6524745258118645f},
    {0.9849142539022686f, 0.37494823579108916f, 0.060238033041504324f},
    {0.7542832292580521f, 0.4288174735962157f, 0.43483339981940095f},
    {0.7694792730446676f, 0.7014191902625374f, 0.2538524546840112f},
    {0.3839665813028984f, 0.8844044025402368f, 0.20457176008936462f},
    {0.7915782141310045f, 0.3286083081824006f, 0.7105639638467173f},
    {0.014054236225980565f, 0.7613501709352241f, 0.08191984509832417f},
    {0.13996487195831175f, 0.742046317747684f, 0.8120692316491303f},
    {0.7843636787062419f, 0.4493183238652302f, 0.8489406110813559f},
    {0.8819209676537567f, 0.36456348014463136f, 0.5613425757799917f},
    {0.964490006790787f, 0.609541314430625f, 0.9314552448193806f},
    {0.44976871484880854f, 0.5229119179001509f, 0.0758919580207269f},
    {0.5571362225556843f, 0.846297225145602f, 0.8813199974845634f},
    {0.9655247846834559f, 0.25511237731269687f, 0.6662398611062766f},
    {0.08248155037419092f, 0.021370888900969498f, 0.8108439049371259f},
    {0.8537353816622115f, 0.6263576206050241f, 0.22370217866553932f},
    {0.8449645197812896f, 0.1847078703341729f, 0.7707189556446259f},
    {0.5125195337637304f, 0.26981312592023876f, 0.1640569404850002f},
    {0.14760190776202053f, 0.8788338288358061f, 0.8153572385483381f},
    {0.5856502984671431f, 0.3487343950747558f, 0.7280798469349407f},
    {0.9088975559314698f, 0.6544096596685356f, 0.9847930756270782f},
    {0.034323316003837534f, 0.24945747901842652f, 0.6924453622160532f},
    {0.05976738478277521f, 0.7054820115409142f, 0.6377441905158973f},
    {0.9257582278357954f, 0.8586680054506842f, 0.0962685241733654f},
    {0.653567220999342f, 0.8110956960183585f, 0.9544932077029263f},
    {0.06354122260278872f, 0.741982823215664f, 0.37632339822531014f},
    {0.911649720650479f, 0.3720513889523783f, 0.07901426351213192f},
    {0.3915793439353207f, 0.5627028438854785f, 0.7843852126533306f},
    {0.6056956674342434f, 0.3177867497060879f, 0.14662591562605565f},
    {0.6615099829202494f, 0.580614822405744f, 0.7150017893403905f},
    {0.42774434625359636f, 0.8536836230430085f, 0.047805314112989605f},
    {0.023195738702943003f, 0.8960664819064713f, 0.15620003458682608f},
    {0.6199561980500476f, 0.09554043264209178f, 0.2530674327406719f},
    {0.8100191813476963f, 0.3965795859329381f, 0.23386839018364602f},
    {0.7230917990863238f, 0.18316027330711604f, 0.033218954797553546f},
    {0.9425365905221776f, 0.7636569095623135f, 0.30432818962959407f},
    {0.4238301241397926f, 0.06391950334995655f, 0.924203967830131f},
    {0.01578979370048006f, 0.5429604303184825f, 0.46860640819586385f},
    {0.4810424713401744f, 0.41084764960908593f, 0.7587939522194226f},
    {0.8097300412795981f, 0.12150046177087692f, 0.6404866884017699f},
    {0.7837222892133447f, 0.254038474248069f, 0.38769256293394205f},
    {0.6288468924975261f, 0.23299673527026488f, 0.1706885862713735f},
    {0.5841090925768082f, 0.3142203909607467f, 0.24481363267749012f},
    {0.48018705510011794f, 0.9141720027842707f, 0.9128064855943476f},
    {0.6248484007238042f, 0.7846766948790161f, 0.10024723498980781f},
    {0.14818938409276483f, 0.7646472955001726f, 0.4002506859771401f},
    {0.009295680843450227f, 0.07008036249269212f, 0.5216468862984305f},
    {0.6522835789888016f, 0.41666916882950167f, 0.9500720015267367f},
    {0.7482715268429742f, 0.9587698403077762f, 0.42801062091209374f},
    {0.4600750761935535f, 0.8113634860317833f, 0.09772792442802514f},
    {0.17874785301818885f, 0.24150093276355133f, 0.9570425558920603f},
    {0.02841980075060968f, 0.19211866790959953f, 0.17549154658813404f},
    {0.20619162415084258f, 0.6367987917924456f, 0.5308487125408367f},
    {0.009782846913923948f, 0.5911963686271547f, 0.27165555673400876f},
    {0.8527336878431173f, 0.15560961703623877f, 0.26643548058563826f},
    {0.9486974671017866f, 0.34194944173906217f, 0.48600963382117135f},
    {0.4761689173540149f, 0.6047108774124816f, 0.7153898484464601f},
    {0.7245529110569285f, 0.46425947107440946f, 0.3502968056914011f},
    {0.016358735604656505f, 0.8844430688884773f, 0.8774695665392092f},
    {0.3316200807725799f, 0.5999349150355864f, 0.34857543821237214f},
    {0.3255794224015034f, 0.5661405651421705f, 0.07608214735644814f},
    {0.1810662835875122f, 0.9776140978738921f, 0.3773371172666855f},
    {0.26050731775055036f, 0.3185022165805914f, 0.7522147324741486f},
    {0.3078799890015854f, 0.9884897567293965f, 0.8612284335036935f},
    {0.6123676060982283f, 0.47666951162599946f, 0.45533343217149647f},
    {0.32030219672166316f, 0.011587936260687215f, 0.8380431480166447f},
    {0.7341723023788497f, 0.9843432335795372f, 0.8475527153396296f},
    {0.2962506949266879f, 0.1598081115115343f, 0.1023207931262422f},
    {0.19754087864206848f, 0.6033389585444529f, 0.04721684078549382f},
    {0.24736065889791736f, 0.5443105485374851f, 0.6010261594986852f},
    {0.2419294603715202f, 0.18886135716200447f, 0.6344060291164476f},
    {0.8075157325229402f, 0.2338924317519463f, 0.8740224599408685f},
    {0.4658651826465413f, 0.10057190572655805f, 0.03461615965610643f},
    {0.38762734921950004f, 0.4589892706771367f, 0.54090467087041f},
    {0.16465215554269663f, 0.8966425424062638f, 0.6852312524330956f},
    {0.557680323595829f, 0.6455635045234759f, 0.7967822654824985f},
    {0.9077567486257669f, 0.005076402919169332f, 0.2501282779823186f},
    {0.16926794151411217f, 0.9877253757926227f, 0.731459727255223f},
    {0.49791318499517245f, 0.25740455546455876f, 0.4732776077141079f},
    {0.8755462923853563f, 0.06955827108617696f, 0.49337582978997363f},
    {0.05366648210176084f, 0.6339552796687776f, 0.9937928250587106f},
    {0.20599645224419172f, 0.09710220255431135f, 0.5426098060866702f},
    {0.9251496814236113f, 0.5743576760961047f, 0.32832153658661445f},
    {0.755668475426624f, 0.09075866980493541f, 0.6414783630567213f},
    {0.8658220611229717f, 0.7244267338610831f, 0.7614579841204273f},
    {0.33952314955528484f, 0.9324840791338354f, 0.39654901203532467f},
    {0.15481990796974143f, 0.48022941386421214f, 0.9656507333433458f},
    {0.597419107130641f, 0.6233033553958062f, 0.08720507781120779f},
    {0.911361055399168f, 0.918430646631458f, 0.14256507785901562f},
    {0.4812011280944001f, 0.8519272531678217f, 0.5170657885468046f},
    {0.052886577056304285f, 0.32641968376485775f, 0.14811201261824924f},
    {0.6853990881881008f, 0.529351459649167f, 0.9016757228427582f},
    {0.7886747710737998f, 0.6881571604764403f, 0.6782918836830083f},
    {0.6072823964046125f, 0.845935093973088f, 0.34754112401543624f},
    {0.10748705632735034f, 0.17947690242279168f, 0.34332607499223666f},
    {0.8865577914410872f, 0.43608761034362964f, 0.7800518630561707f},
    {0.09186752612902416f, 0.8937570130280753f, 0.09597552302397794f},
    {0.8764684808027217f, 0.8797588847889496f, 0.935247269344714f},
    {0.4747075262858037f, 0.5647596397452195f, 0.9689568184391246f},
    {0.05329005096265804f, 0.44456577903516914f, 0.32799523036656697f},
    {0.4898045794935615f, 0.789126415045716f, 0.8213619372291737f},
    {0.5697665902078302f, 0.9204762053894058f, 0.24260042320608322f},
    {0.9482356481168314f, 0.8748978179397128f, 0.8891735622359831f},
    {0.5287852893666555f, 0.5202092043738566f, 0.3394209948486929f},
    {0.8375654174859105f, 0.1882761382636301f, 0.2246301504571313f},
    {0.041040086143480536f, 0.6672087696788591f, 0.6667888931801017f},
    {0.3493472067045773f, 0.2807474385890838f, 0.7868373869189924f},
    {0.5087716533346008f, 0.5118499964802073f, 0.47094910808081725f},
    {0.6194267340906077f, 0.7948057684801034f, 0.34361791637807004f},
    {0.24893293596529864f, 0.925285721828234f, 0.633057180554752f},
    {0.35583535887722917f, 0.05434094629064401f, 0.26970234084387223f},
    {0.9466817043810329f, 0.9333241600667284f, 0.0654549223814207f},
    {0.03194572911717031f, 0.553643805063726f, 0.9057565254748794f},
    {0.10653716155229664f, 0.5031844710938611f, 0.37901988772535344f},
    {0.03439637421849828f, 0.6360238533623528f, 0.7508651433101986f},
    {0.9662705273178882f, 0.28090789947718897f, 0.2638383585772779f},
    {0.8812263353425334f, 0.9567411785398064f, 0.009638950949306002f},
    {0.6491767280571653f, 0.9578129725512587f, 0.7026930903007695f},
    {0.813315174382612f, 0.4263549863932793f, 0.38881038673261525f},
    {0.8218629886720568f, 0.35390699121815294f, 0.5120459688872948f},
    {0.6059687895869129f, 0.5351800685614699f, 0.6043312227448693f},
    {0.022821144294309148f, 0.7164019647976789f, 0.39225123898700986f},
    {0.06572622886500634f, 0.41643667891359404f, 0.4062543598034333f},
    {0.8205356812742289f, 0.15624831459460464f, 0.7168329585077499f},
    {0.846902558596473f, 0.06343802230447493f, 0.021777793057324413f},
    {0.943304927736507f, 0.10842564370747265f, 0.6453597495491205f},
    {0.8835834038988923f, 0.9164719691750267f, 0.14057004506196102f},
    {0.3486169942727001f, 0.9779204544598076f, 0.897590841954928f},
    {0.6522768077185009f, 0.4929445293124394f, 0.3396113355616638f},
    {0.1367859733972412f, 0.1240892807003856f, 0.732072574905076f},
    {0.16147451766314969f, 0.19424354079464334f, 0.7712905152659923f},
    {0.9873528473993792f, 0.9140558485539887f, 0.8319585476496896f},
    {0.9016800550798432f, 0.32221625882129923f, 0.05527360296738015f},
    {0.6250286924302557f, 0.28567319048458595f, 0.5589395655756594f},
    {0.8981285336356076f, 0.2302175343472579f, 0.004185917507450676f},
    {0.44972447677286875f, 0.30838626761919885f, 0.8018359984828203f},
    {0.10908369478925961f, 0.5706624449844895f, 0.37766003953895655f},
    {0.7600028381292439f, 0.026071989009645247f, 0.6495493591430803f},
    {0.7427118545815604f, 0.5921097370576492f, 0.5041454154225831f},
    {0.19630564628538671f, 0.8278456776548451f, 0.01068154622199391f},
    {0.9087604650644274f, 0.7912579403491391f, 0.7782634918859674f},
    {0.613584809929289f, 0.7063101727747527f, 0.5146089876502524f},
    {0.014997848166306227f, 0.131935512626978f, 0.4208094761745944f},
    {0.5613325759044855f, 0.4690018868466561f, 0.8388099053325893f},
    {0.8315929951897263f, 0.4433796017283014f, 0.18220475526650715f},
    {0.2815099404246366f, 0.9782425096168853f, 0.9988113812805042f},
    {0.13858897365954093f, 0.8421208143126552f, 0.940700944330359f},
    {0.037144408953788455f, 0.6243589775929942f, 0.2858117621418136f},
    {0.8248692507299901f, 0.7219517949811884f, 0.5540954320479508f},
    {0.5023084513545294f, 0.7530697124944637f, 0.9102465775372064f},
    {0.35125452178116945f, 0.01995973843262422f, 0.09092700911556961f},
    {0.11798078296658154f, 0.43236752375389f, 0.6389114693671822f},
    {0.21029461069646727f, 0.3106718618027148f, 0.5843195191939153f},
    {0.12343601244332258f, 0.20742519035145546f, 0.22855917930416014f},
    {0.8729666937438969f, 0.2833435340430652f, 0.38281322330360756f},
    {0.5779367396496043f, 0.4641534882452152f, 0.3391636650331058f},
    {0.34940116867505133f, 0.10632378588386082f, 0.01344151469402688f},
    {0.16432460849067798f, 0.7479117308670469f, 0.9693536964267473f},
    {0.7846368162595476f, 0.39171803864496424f, 0.1163846687752198f},
    {0.0159245445481766f, 0.9321197461234206f, 0.39173906200547826f},
    {0.4496782767704479f, 0.7455353767661702f, 0.31904384793909435f},
    {0.9653227749326971f, 0.4597938281088665f, 0.8460488785958672f},
    {0.1901577855906048f, 0.4523002922719609f, 0.06000413674815652f},
    {0.41647430365957017f, 0.5129641973319296f, 0.8078276405282172f},
    {0.9234469967183694f, 0.6543049157930334f, 0.961879677945899f},
    {0.6289299705195289f, 0.4865535697698392f, 0.2520169846279068f},
    {0.9940718299619569f, 0.41243372428289016f, 0.04999153647180565f},
    {0.31394802806423283f, 0.750327569479789f, 0.13225671159632657f},
    {0.45294527296950016f, 0.5945631079622303f, 0.7451313453482006f},
    {0.8732926539011658f, 0.9508089402550314f, 0.8505997277795196f},
    {0.6153431677095748f, 0.16886128182307392f, 0.640754071711741f},
    {0.39390043058071544f, 0.7000038930072308f, 0.6217204996689123f},
    {0.29779101806813957f, 0.5725815062406067f, 0.05977092394249006f},
    {0.7413732960388666f, 0.12563894734102554f, 0.31823496794763717f},
    {0.1333281776633114f, 0.7515764496595561f, 0.9714569284209298f},
    {0.43592219056461956f, 0.1254189261299179f, 0.9376536427865364f},
    {0.98202027769481f, 0.8152946267987531f, 0.06835755778438157f},
    {0.1309491428447972f, 0.19576286363034967f, 0.6515780706771749f},
    {0.7303612364771919f, 0.9283051339175112f, 0.6619541486886852f},
    {0.2747463701988644f, 0.07815683813745788f, 0.5449098589548645f},
    {0.339762450884042f, 0.07490060174871127f, 0.315595023155426f},
    {0.4606043137166239f, 0.6719160383692988f, 0.22079607897230158f},
    {0.38966745435295447f, 0.3842357287495132f, 0.09042818440483946f},
    {0.4886620579186822f, 0.8753028970572275f, 0.5331796311200628f},
    {0.3913364745975817f, 0.9736091416828142f, 0.5735977767240075f},
    {0.6174583404831554f, 0.20339248965437318f, 0.03274121219745596f},
    {0.19025361159610477f, 0.2919298351593451f, 0.4423259631140155f},
    {0.37396363218180007f, 0.6642017983942676f, 0.31809317213529875f},
    {0.4809981103248431f, 0.30418042099016396f, 0.401326345755755f},
    {0.3873345242674011f, 0.48324796350844945f, 0.8062629538294502f},
    {0.911612252193313f, 0.3556859446149202f, 0.9709719492790209f},
    {0.14502131026044185f, 0.8763149873151409f, 0.5765321177870423f},
    {0.5131670988313878f, 0.14205266963817176f, 0.057277448525068664f},
    {0.8363543296327747f, 0.29094788976853814f, 0.6223889485115341f},
    {0.9543316462922402f, 0.7175322508249367f, 0.47005417288713747f},
    {0.9146951329271402f, 0.10571069351080309f, 0.2430607909110768f},
    {0.25124615703046604f, 0.773814037659714f, 0.300033698727184f},
    {0.8499785417935372f, 0.643927107968001f, 0.2250824624287192f},
    {0.7639069129218129f, 0.14465215291523448f, 0.3961837298990373f},
    {0.6337867631162644f, 0.4593598227588245f, 0.1435980376157433f},
    {0.47569414115409603f, 0.5749813200369832f, 0.08708227737218088f},
    {0.49312856460296983f, 0.46173818706563363f, 0.33098671907998667f},
    {0.37645986167641043f, 0.4265393670497294f, 0.3488962761532616f},
    {0.12737405748093522f, 0.8204062311830972f, 0.0034332886491781345f},
    {0.18006779930027517f, 0.791997204840692f, 0.2852716714401696f},
    {0.09857694468287537f, 0.7290530725253075f, 0.9559193913148634f},
    {0.047129809466582406f, 0.347776007641603f, 0.6960495227409857f},
    {0.6918594219736806f, 0.48814634910523225f, 0.7285326335066395f},
    {0.1657138053884264f, 0.6865190543749976f, 0.8953894563909004f},
    {0.16716095383503649f, 0.3031069658307828f, 0.9177418173933551f},
    {0.2027701574774321f, 0.08308425225095206f, 0.2573525536425383f},
    {0.17647526181295148f, 0.09311212937242952f, 0.4221428388407429f},
    {0.0865872987044064f, 0.06534867408429945f, 0.8195218408747464f},
    {0.523455127312878f, 0.5967397122772774f, 0.28880890732052567f},
    {0.6105755734809297f, 0.2164530299698938f, 0.29151829914855765f},
    {0.2166666044831076f, 0.7989127628483882f, 0.8111092750436738f},
    {0.8611955642676957f, 0.7512597112987047f, 0.2336150735982383f},
    {0.3900223827075078f, 0.08876932771347112f, 0.6233883471730935f},
    {0.24212882017613435f, 0.3111114532096717f, 0.08668304969627794f},
    {0.6103290006577595f, 0.7320718430276847f, 0.6726127472981126f},
    {0.17709584965702763f, 0.6348812503968493f, 0.750287006061594f},
    {0.07418275562812437f, 0.3865521988810683f, 0.6611791668254913f},
    {0.513624002491987f, 0.7582252638393919f, 0.5785479070271463f},
    {0.8507920077050004f, 0.6343034395319501f, 0.36653379418490695f},
    {0.2286060696331701f, 0.9551404161065332f, 0.1492261677770158f},
    {0.9611736385750957f, 0.37750970249397764f, 0.926676985811301f},
    {0.5580889669175892f, 0.5940248249941303f, 0.5693979556215054f},
    {0.7542456319848907f, 0.4933565177149135f, 0.8608148732487929f},
    {0.9334875855666014f, 0.7415795740579847f, 0.6005666235935037f},
    {0.596056286396349f, 0.06366455151083239f, 0.8480762270253178f},
    {0.7361768099453064f, 0.07984566277894878f, 0.1447679324870963f},
    {0.08238857574801628f, 0.7591365187063672f, 0.7620123954048281f},
    {0.8007210425642463f, 0.1495403055608442f, 0.9556365197475941f},
    {0.4418787324505412f, 0.5913449016033125f, 0.2954846028956747f},
    {0.4400758963178305f, 0.6264424398114588f, 0.7075522444027578f},
    {0.7435708384947131f, 0.5427619901436016f, 0.22289906439007412f},
    {0.9644229775973104f, 0.9534626049956615f, 0.7277838815744438f},
    {0.558836449674955f, 0.7630982350153033f, 0.585779535694391f},
    {0.8286941357965341f, 0.18912954417804506f, 0.6396632920134152f},
    {0.858179298757441f, 0.9070881173963807f, 0.16460361571276005f},
    {0.06847303346870348f, 0.0542079826785451f, 0.5884339725720368f},
    {0.1683172098309711f, 0.5488693727065447f, 0.9509704170188896f},
    {0.8856676028857953f, 0.029178491337833345f, 0.884831314810531f},
    {0.2319531024300826f, 0.09473858357251119f, 0.5655717167785503f},
    {0.3503979730545864f, 0.9596794627270746f, 0.5894733883837923f},
    {0.7196716583026513f, 0.5045831349908235f, 0.3189620672291439f},
    {0.945790453321936f, 0.8345705561820744f, 0.644432497954844f},
    {0.057311296122009914f, 0.9482835544242082f, 0.5550912443318242f},
    {0.5500344568734823f, 0.5636131172145773f, 0.8065291165753806f},
    {0.6804059604763357f, 0.5629982235302373f, 0.36371776888271745f},
    {0.2682699607220769f, 0.0653967391398107f, 0.6725397024899322f},
    {0.612671544563566f, 0.5877903349949399f, 0.21126986960557093f},
    {0.18470685575344847f, 0.3334478279270854f, 0.6075892447616358f},
    {0.24416563393341228f, 0.39934582798339124f, 0.5284221462873699f},
    {0.5371399202765412f, 0.9700241016688622f, 0.036056864193523164f},
    {0.7058693166615387f, 0.9003801131375495f, 0.33108962171440215f},
    {0.7989265900156924f, 0.4938326311064134f, 0.926453530886393f},
    {0.12835536520377777f, 0.5658839259138924f, 0.9337584111282474f},
    {0.036019390351983316f, 0.3022564638800129f, 0.4109503059279581f},
    {0.7593872509903976f, 0.07399096913628389f, 0.6459110974246784f},
    {0.2964757963044955f, 0.006127889250876484f, 0.7099902203243131f},
    {0.4853574501998703f, 0.3793287509972937f, 0.09586854997215499f},
    {0.39087259593435253f, 0.31297069861402615f, 0.23260090934550737f},
    {0.3925117682453688f, 0.25729803598262446f, 0.8115211788933341f},
    {0.4315726387818718f, 0.8607412693705828f, 0.16999105751483157f},
    {0.3517425422639373f, 0.11329743949444693f, 0.6225495485176818f},
    {0.5522061594976231f, 0.2475677384032947f, 0.8715655065080148f},
    {0.0381251371341238f, 0.09215414065806404f, 0.8202429954438595f},
    {0.8822912784823066f, 0.14148616820197057f, 0.8161212894432309f},
    {0.5736084581571822f, 0.16962133741688723f, 0.8374198974213817f},
    {0.20250102515084079f, 0.8110128684686262f, 0.9408906933591533f},
    {0.8713470224924386f, 0.5985688636400543f, 0.28636424511966796f},
    {0.24257286998597083f, 0.4512632874869147f, 0.099434204003782f},
    {0.011093270812982947f, 0.6359153802045745f, 0.1235913525212099f},
    {0.949583058404423f, 0.7657584924191685f, 0.5052380028630257f},
    {0.5491086451013389f, 0.8602946062036247f, 0.15807807200869295f},
    {0.5863485809250987f, 0.8408269512280568f, 0.44917241278199505f},
    {0.8687649400376939f, 0.9991350850117009f, 0.06845443663449946f},
    {0.048049333748852785f, 0.2412879871208311f, 0.8727568853564516f},
    {0.7098495231119758f, 0.6804777834129813f, 0.38034106866937323f},
    {0.07058951500679844f, 0.19668430913486257f, 0.6093958467186831f},
    {0.9700921227410305f, 0.0007968620397116322f, 0.9530981474489547f},
    {0.3887748758452332f, 0.4968904235364663f, 0.11446901268467624f},
    {0.8473606347085039f, 0.5785248973968289f, 0.9715264659571715f},
    {0.6804241593071441f, 0.9568008796000789f, 0.68404378380452f},
    {0.4451534965071924f, 0.9529285272844915f, 0.5415726054290085f},
    {0.11996097263179661f, 0.6530844163573578f, 0.057952925355620355f},
    {0.5029280447843131f, 0.6181992151542914f, 0.17769359084666947f},
    {0.7331885280947068f, 0.3247040809900792f, 0.9826300953259227f},
    {0.23840956861175477f, 0.8468569152112139f, 0.776493446311894f},
    {0.3390294871471303f, 0.2058261447186942f, 0.13661903679483678f},
    {0.3923537433811922f, 0.19199466102753293f, 0.5966451932196264f},
    {0.7804534014939851f, 0.25436867404414376f, 0.8422286580007582f},
    {0.29087863397195013f, 0.6114118777609445f, 0.6598287614264597f},
    {0.3150612619634151f, 0.5900210656552809f, 0.7968418106069063f},
    {0.42650689779232787f, 0.14804330994191073f, 0.8702346513828855f},
    {0.4741733402238687f, 0.7250265336332044f, 0.1255884721930035f},
    {0.1577286182271862f, 0.5368578830416352f, 0.4255080555017179f},
    {0.435733454835341f, 0.3079247253680587f, 0.17369669162375045f},
    {0.7239772713389603f, 0.10113091895580706f, 0.17699977571708947f},
    {0.32174912599448535f, 0.8040159220681432f, 0.26870202125759934f},
    {0.8779800437909222f, 0.8015553112966499f, 0.7976981730904994f},
    {0.4574541967347442f, 0.38965098772237416f, 0.08986296823563655f},
    {0.7008800612032807f, 0.1809526530568023f, 0.5102750081915246f},
    {0.17189853066121086f, 0.6397943369307572f, 0.7379139289502149f},
    {0.2969511314278469f, 0.5295416184290594f, 0.7281771376079602f},
    {0.8620139260677221f, 0.28725245069768635f, 0.3522945975969578f},
    {0.7754482311332228f, 0.16028782991794444f, 0.9607732686574528f},
    {0.6131812293565073f, 0.8901514063456739f, 0.8923699511862481f},
    {0.16463633477215855f, 0.22493236448702636f, 0.4879101351357883f},
    {0.7161334817978667f, 0.800976627886707f, 0.1378448377810355f},
    {0.017323370704340535f, 0.6532334650994163f, 0.4943992374341032f},
    {0.24830987952087746f, 0.21331653316995136f, 0.6216894067845963f},
    {0.6229550043132789f, 0.2658259661046388f, 0.3470084116160712f},
    {0.2628187263967805f, 0.6882267311505388f, 0.9023632372711586f},
    {0.07765878850692365f, 0.07827268025733647f, 0.41198438176780383f},
    {0.8496958865817248f, 0.7342233280838837f, 0.802851181921001f},
    {0.9634754415146279f, 0.12667335994446072f, 0.6990364575281951f},
    {0.6889283229048341f, 0.015264890128083963f, 0.23277539124248492f},
    {0.946406509383085f, 0.4680147467235569f, 0.1909464069032869f},
    {0.9704876781749548f, 0.9333161519283792f, 0.1605537376491788f},
    {0.5940079993315984f, 0.5217867384107573f, 0.3452557049876658f},
    {0.5318601199050139f, 0.060101410403873956f, 0.36797757649823615f},
    {0.14078410342303915f, 0.09552972606351673f, 0.4558092176332532f},
    {0.5028688951425849f, 0.2948981734289352f, 0.7746476177582252f},
    {0.563456106078919f, 0.5485617844139656f, 0.33910785389051146f},
    {0.8434848633240709f, 0.8198972713550328f, 0.3110214838983347f},
    {0.19032648539998231f, 0.8807670719407572f, 0.6030530998500764f},
    {0.26748600793975386f, 0.34351066668769703f, 0.0819027596062275f},
    {0.28600767713251407f, 0.539567259859707f, 0.024854874709794972f},
    {0.5726481423988021f, 0.1371361965977479f, 0.5267027012243606f},
    {0.10487780074954489f, 0.25525728636689315f, 0.34914322621660177f},
    {0.33732654631136016f, 0.7630810982435784f, 0.9998186287021334f},
    {0.8210562553849234f, 0.4266877972599308f, 0.8038613260538021f},
    {0.4000895613551292f, 0.036800686094559665f, 0.8130890842881037f},
    {0.1959520847742121f, 0.9551744313708586f, 0.883477983591429f},
    {0.758529977306166f, 0.9814047436245087f, 0.608830413122044f},
    {0.18431739915815237f, 0.19114855992721913f, 0.42815989665254295f},
    {0.3660384619292235f, 0.5358130044225105f, 0.9179000876049774f},
    {0.33011087408898065f, 0.29538244536277924f, 0.6641008363054604f},
    {0.10053783451717802f, 0.7547142183557332f, 0.03835661970854276f},
    {0.7117593164435074f, 0.8124659903781685f, 0.6587116843284625f},
    {0.9792713214215611f, 0.5113700770525704f, 0.5413581052370868f},
    {0.28818403338583776f, 0.030697672252442354f, 0.20929082029995427f},
    {0.6706272836091889f, 0.3659625420421835f, 0.2187083802424954f},
    {0.8659566904512634f, 0.23926817901580888f, 0.8296418104708908f},
    {0.9690465128461715f, 0.7176639316100207f, 0.0508751664795426f},
    {0.9360146280927494f, 0.8737572963783677f, 0.0332066540932523f},
    {0.7584297257665319f, 0.8980660664089263f, 0.6802675170859503f},
    {0.045552886669991466f, 0.12578496959804286f, 0.7078710284503507f},
    {0.05293587163790692f, 0.8352030762541642f, 0.011917251718371213f},
    {0.8211620820415302f, 0.24411831011894503f, 0.9996213178326097f},
    {0.1933184443589011f, 0.28166384451981563f, 0.8773062678348951f},
    {0.2744594307913544f, 0.6322534392857452f, 0.15235521398541485f},
    {0.5837890619532868f, 0.7343146891468771f, 0.018848621254180298f},
    {0.8165692758742739f, 0.6483930307851308f, 0.02682675268564716f},
    {0.6528968008897802f, 0.986367890753865f, 0.37902109027204867f},
    {0.3452445058364706f, 0.7149784925428471f, 0.8183649260593303f},
    {0.6195391130218187f, 0.2203084128746141f, 0.3930083997355275f},
    {0.22501970261287463f, 0.8551955013348508f, 0.38913475651746f},
    {0.23686662572077333f, 0.4202454767121441f, 0.12273989028326127f},
    {0.46117571921338085f, 0.5219981983412726f, 0.8499377959537937f},
    {0.5140551582309366f, 0.12256396378866752f, 0.6201439942264799f},
    {0.7468323295158824f, 0.5064760253672134f, 0.6920544328854987f},
    {0.0677348057716689f, 0.615270492187379f, 0.4121082277607321f},
    {0.4655071393443754f, 0.7853959103687814f, 0.8940646527437328f},
    {0.3966850623938236f, 0.35454405791303145f, 0.982011651009951f},
    {0.7571167140918108f, 0.6918016151545789f, 0.33980894516549454f},
    {0.17327286647433204f, 0.1273205571037882f, 0.624682604189421f},
    {0.6156380561707043f, 0.06866850028739357f, 0.4475411529116269f},
    {0.15839799953223932f, 0.6480501546922379f, 0.7634271307979987f},
    {0.6000465602261404f, 0.5814593216010927f, 0.22405846603054713f},
    {0.7331459045219939f, 0.1341316657738606f, 0.46843808390185027f},
    {0.36022685823261946f, 0.9032193926323714f, 0.6234901042540532f},
    {0.6459239243898303f, 0.817066591377019f, 0.33154316550597984f},
    {0.8245399572286148f, 0.12662748808615232f, 0.41499262908053325f},
    {0.43539828078354925f, 0.11488469601946227f, 0.44547920233475025f},
    {0.09787499008145362f, 0.8986409749459043f, 0.6357323774203544f},
    {0.36138435238211775f, 0.35608086493395363f, 0.4761770949387182f},
    {0.353133665891451f, 0.44582156815388163f, 0.08823085365422156f},
    {0.9444274662442814f, 0.7167129480242234f, 0.3986367635759337f},
    {0.3834131031477145f, 0.27483804798018785f, 0.6707618011396058f},
    {0.6646666482621699f, 0.35542950036217447f, 0.79120485087121f},
    {0.7618391485207358f, 0.04473525071367934f, 0.3027948655168071f},
    {0.2726709085845257f, 0.13943963903575118f, 0.7253810350097328f},
    {0.7025591528910313f, 0.7439143813325427f, 0.6319499423593752f},
    {0.20719448045216016f, 0.31864137462014575f, 0.5285545308848623f},
    {0.08725967577622551f, 0.898041157510929f, 0.9877264457606761f},
    {0.4264147200667242f, 0.35898644634152077f, 0.057171953970007294f},
    {0.510092148981757f, 0.6086425561324782f, 0.7679243719466773f},
    {0.40920331402650556f, 0.18953260271171335f, 0.9864334585271037f},
    {0.8614875420365158f, 0.7780264048715793f, 0.29780396330932113f},
    {0.9607903785180445f, 0.09619712122399526f, 0.6396924230784579f},
    {0.8240040856829538f, 0.41171357348056414f, 0.2027129604821324f},
    {0.09850046559224379f, 0.5214239845823052f, 0.2755564208328283f},
    {0.5160854096708418f, 0.3728779681442753f, 0.43652614480813123f},
    {0.16799277063921192f, 0.8407766106089916f, 0.12173219718502093f},
    {0.6684494239789728f, 0.7617008623197421f, 0.11943825063568314f},
    {0.4667639523727777f, 0.2756491746140076f, 0.8968139411590357f},
    {0.717225034238845f, 0.28089620173819674f, 0.513125666127766f},
    {0.9490651566887673f, 0.6500195779826032f, 0.7901823724079837f},
    {0.18838899415409172f, 0.16989437942253371f, 0.9642756272220933f},
    {0.06297556235136592f, 0.4948433304887454f, 0.1271614999681444f},
    {0.8107236921217745f, 0.3961228352177012f, 0.6055977562702763f},
    {0.11576307158227461f, 0.062054584875020025f, 0.5462065589545315f},
    {0.9508827948830099f, 0.5564614827218022f, 0.5406838949650894f},
    {0.33406687758238507f, 0.012715349348138227f, 0.13306258137109184f},
    {0.8514940622808298f, 0.09646299325555563f, 0.8749427290766368f},
    {0.4947910267717247f, 0.9212495170058994f, 0.49209102115799286f},
    {0.504754786377716f, 0.46725941745532273f, 0.873688292627776f},
    {0.9792800182125087f, 0.7860118206245511f, 0.8988679207658842f},
    {0.8790138199615792f, 0.04473096362412454f, 0.6003403603981478f},
    {0.024416383772377093f, 0.2593087506778572f, 0.4688741268629806f},
    {0.05626431592100678f, 0.2133166781375022f, 0.8351210386342374f},
    {0.8763721433608097f, 0.4026134876551112f, 0.2609919681276728f},
    {0.051279310458674954f, 0.03155515393365793f, 0.4516118837972678f},
    {0.056631765476506724f, 0.5082782921678906f, 0.3461895624399778f},
    {0.5699236016623922f, 0.6751067268364503f, 0.7661124005155397f},
    {0.2445728220692872f, 0.2788154748932429f, 0.432544233604541f},
    {0.23209382085101316f, 0.5675889994679646f, 0.37919449690762463f},
    {0.7180356407535426f, 0.3362136050639638f, 0.7231915638859754f},
    {0.5090625066210511f, 0.6909398206600694f, 0.1604569678187685f},
    {0.39719714433575004f, 0.6105258701235854f, 0.9352182710497617f},
    {0.6179069277133765f, 0.9923805845777179f, 0.9235864496818298f},
    {0.670197345717605f, 0.5270201950522283f, 0.32625045526411245f},
    {0.6434323746208751f, 0.9331795161816244f, 0.6643426416805379f},
    {0.2106317250381179f, 0.19682581227036555f, 0.5236937885865198f},
    {0.8515847014760474f, 0.21634312765155916f, 0.5846281301365294f},
    {0.056159318950544046f, 0.07515172980755835f, 0.8704435492412682f},
    {0.7874799554432692f, 0.14009647542003367f, 0.9579583048226674f},
    {0.5394478216841768f, 0.4253833131899636f, 0.8765464412505819f},
    {0.27011934130568593f, 0.5532669666140566f, 0.9140740891898714f},
    {0.8325439972909728f, 0.7271247434999333f, 0.8955354044315093f},
    {0.47233114909018226f, 0.29598711695933866f, 0.6285624128880167f},
    {0.18930690712805132f, 0.7621817920650604f, 0.9232957793063112f},
    {0.3374917493732079f, 0.12633198218503028f, 0.03559944439493368f},
    {0.15069053151871492f, 0.4008294576510184f, 0.5778068363310318f},
    {0.4389819116954323f, 0.6170917105993245f, 0.6539995143418315f},
    {0.17634422356639923f, 0.5201440579588404f, 0.6249372852604935f},
    {0.2836142679752536f, 0.7258596049263373f, 0.08338953006454453f},
    {0.7545639934714942f, 0.7436850077452649f, 0.1715775197089403f},
    {0.28537028451398094f, 0.5428741945123264f, 0.8832050944278376f},
    {0.537038811330651f, 0.8306861256258877f, 0.38152577448421554f},
    {0.1871008564776494f, 0.8159809288684675f, 0.11151540740196064f},
    {0.5844827903603695f, 0.3635730380151446f, 0.3321108861952662f},
    {0.499253564501248f, 0.44166083958048963f, 0.7490946359436549f},
    {0.8813246203233779f, 0.8919758128002713f, 0.6935931064263089f},
    {0.28266707536130464f, 0.2491246534619712f, 0.1401110545453138f},
    {0.07692807295080184f, 0.17422074304322122f, 0.34128049983725706f},
    {0.1922521897298567f, 0.795908945881622f, 0.5680969768213049f},
    {0.7463651272297653f, 0.8325155202803802f, 0.9474525809010719f},
    {0.6145192667382976f, 0.7448860593095973f, 0.6252108445322981f},
    {0.6745808264274874f, 0.8602824113543938f, 0.7259778293944266f},
    {0.10001195438005206f, 0.5868923931344149f, 0.4867010412451199f},
    {0.7039817532292971f, 0.2341845560140947f, 0.3997084099330367f},
    {0.0667067552886419f, 0.19718619598914522f, 0.906996248499185f},
    {0.7321520356338986f, 0.2774109242179029f, 0.33825353535552993f},
    {0.02135030060981824f, 0.13497275919849006f, 0.9431231606707192f},
    {0.6596130044081415f, 0.596069395100082f, 0.11361750778130086f},
    {0.3214925459382333f, 0.46053737442207f, 0.7202582218229711f},
    {0.6542749230837008f, 0.19006079457025504f, 0.4058872483464644f},
    {0.11098061450836116f, 0.24788153583182526f, 0.3479755284938423f},
    {0.2627483998863096f, 0.35634557040480486f, 0.6833684300684568f},
    {0.9239852892145132f, 0.8950678477738191f, 0.5959355798348956f},
    {0.6618921958027977f, 0.08015838039989043f, 0.13974349198269986f},
    {0.5993633210722522f, 0.23123470870444418f, 0.17828345244481936f},
    {0.7991401970935542f, 0.6053995575960563f, 0.9194555326652512f},
    {0.19442920718232948f, 0.7619635060499509f, 0.5144990723020241f},
    {0.8037645252343245f, 0.34767495065448906f, 0.779857220961368f},
    {0.8656748404140318f, 0.01711306916302957f, 0.7060340427439471f},
    {0.7980764920618295f, 0.4692725786633175f, 0.7273421214467467f},
    {0.15551301040174637f, 0.13859213244231594f, 0.15147664485083034f},
    {0.5563752550378401f, 0.5458812390269342f, 0.051262359718938444f},
    {0.5750737918433125f, 0.8355167400186305f, 0.5799052327624348f},
    {0.11647819419482164f, 0.3071719326607416f, 0.1240361868080152f},
    {0.33219266476288567f, 0.9165635401064733f, 0.5791633289066774f},
    {0.38364876217569654f, 0.28432950444351135f, 0.162637443727488f},
    {0.7597059959969259f, 0.49874079653491266f, 0.6023185779724278f},
    {0.8401003262055912f, 0.6094364404351965f, 0.49172018779287885f},
    {0.641691186038837f, 0.5376853926034059f, 0.8450205818431495f},
    {0.4749221629915168f, 0.346159623603413f, 0.23276049101328133f},
    {0.9332904760212198f, 0.972289050519214f, 0.823549510738689f},
    {0.31462396206466503f, 0.261031581303787f, 0.38437129345006205f},
    {0.14965106647513093f, 0.17209224264410894f, 0.7585798550641082f},
    {0.12287821426952739f, 0.4205977047932814f, 0.42484894997934475f},
    {0.34839796095779907f, 0.9694710901391748f, 0.20465925227687387f},
    {0.3662853582413367f, 0.13523064109177252f, 0.07744341613741079f},
    {0.15424044848855756f, 0.19101523119641872f, 0.5432932311885527f},
    {0.4244994843044838f, 0.8024142486516354f, 0.7545624893354677f},
    {0.7491383752844567f, 0.8097224695668993f, 0.31902628589605864f},
    {0.39603291845516353f, 0.8488247748368866f, 0.5524852422000159f},
    {0.5608002700408761f, 0.9963931462393308f, 0.4348021088291153f},
    {0.9401387887923656f, 0.7182213568919025f, 0.7403321161150658f},
    {0.0033094952492197516f, 0.5257692816987256f, 0.8419814868234987f},
    {0.8746405857182897f, 0.6352696998206188f, 0.5150463353495031f},
    {0.9774949337824027f, 0.7890260683085613f, 0.6374119596955893f},
    {0.45742779415532164f, 0.9945049348115086f, 0.44492051363508067f},
    {0.35380547441077626f, 0.9696734143605964f, 0.6959911586123283f},
    {0.3330807879745703f, 0.9924999592275624f, 0.8724854797901014f},
    {0.8715374611657847f, 0.7627383592932699f, 0.35534809413294777f},
    {0.7914163233838964f, 0.4281762086094165f, 0.07614932849824707f},
    {0.38614466343154163f, 0.18415628962292685f, 0.07737745989926814f},
    {0.7846404877623062f, 0.5966983740260005f, 0.5171221188873202f},
    {0.9961415692163459f, 0.48383960611555665f, 0.9586265516672905f},
    {0.09753318355001339f, 0.312247917670995f, 0.58543637872801f},
    {0.30635412775608806f, 0.3302367593575024f, 0.7374615230713769f},
    {0.7551697476080748f, 0.3876565814848587f, 0.7335061562066927f},
    {0.7843329919958489f, 0.8864461908614819f, 0.8089261418857328f},
    {0.8521295142362201f, 0.187292068473495f, 0.3312834695399498f},
    {0.5342836945238374f, 0.1484589684498805f, 0.7850409061842674f},
    {0.8853281910558589f, 0.6678363874256141f, 0.5465563268106115f},
    {0.543732885165512f, 0.04001744433850574f, 0.3795556364976682f},
    {0.8418481964665355f, 0.33278870587706044f, 0.6742570600436816f},
    {0.17913153773457147f, 0.1768306859933364f, 0.7141792349433174f},
    {0.36712400738426654f, 0.774070806578198f, 0.3719233098767667f},
    {0.6246492691621303f, 0.4429976396921973f, 0.18822020016303165f},
    {0.6549230898876006f, 0.23759112777297664f, 0.5786873959790567f},
    {0.3677320888926464f, 0.9057862747919467f, 0.23602933719659036f},
    {0.6191209867858055f, 0.19040417037864776f, 0.9195356074883583f},
    {0.4298412916582933f, 0.1890552982403756f, 0.9427603445297369f},
    {0.8241517744303783f, 0.37518611393514534f, 0.8003389810559605f},
    {0.4093513080453173f, 0.9069490130574064f, 0.655700266211538f},
    {0.9571567928998418f, 0.4031708565005099f, 0.025914969163608692f},
    {0.34521511747812383f, 0.05998180121655139f, 0.8327980578128197f},
    {0.395270990518256f, 0.5352053740456706f, 0.6005112381007975f},
    {0.9999326411624264f, 0.3436882756195526f, 0.26199426158712324f},
    {0.48163235799791615f, 0.9651157533452893f, 0.8319903314281656f},
    {0.6985154809333926f, 0.9587928243568397f, 0.48888138545260384f},
    {0.25042694483317407f, 0.27435482870383254f, 0.01771669521603836f},
    {0.549395818463662f, 0.05649584565506849f, 0.15068768866503335f},
    {0.6111798062504782f, 0.8047913672171244f, 0.8505020337448106f},
    {0.8874676261727037f, 0.7620752864204059f, 0.6980908607348862f},
    {0.42861139696453066f, 0.7979378453706552f, 0.47728779832542456f},
    {0.5467166296691494f, 0.8436498177648153f, 0.33218633518212504f},
    {0.47102020244789455f, 0.8400797253917576f, 0.5170162003215683f},
    {0.7189526664475078f, 0.05775259608855343f, 0.08045973746329771f},
    {0.4450077679340373f, 0.9744626949018734f, 0.2039049717976925f},
    {0.680546600388695f, 0.25949157303888115f, 0.9944662487763036f},
    {0.3933706068671551f, 0.31368167296518423f, 0.27328047142069445f},
    {0.22398319950733359f, 0.07162863827363852f, 0.45911763474950984f},
    {0.22213148705624686f, 0.06916295364140235f, 0.7975120125159638f},
    {0.49077135936912375f, 0.9475431375055914f, 0.03174351240234363f},
    {0.9305237905684101f, 0.7311376474186821f, 0.12122174954767939f},
    {0.8996204311770367f, 0.931042103430472f, 0.7533806635131923f},
    {0.8495194345924546f, 0.11023735255630751f, 0.5272642411991824f},
    {0.9003055911796793f, 0.6639650368665683f, 0.17726453712730372f},
    {0.5755470699420164f, 0.5282510066388145f, 0.6111147940357451f},
    {0.248726750416411f, 0.8920316338093399f, 0.7797544671267441f},
    {0.01339728380652394f, 0.3171157483143119f, 0.20135181207628816f},
    {0.64064149833787f, 0.43484222166315023f, 0.29902998702163963f},
    {0.5213158577706415f, 0.8910814284342724f, 0.77392893026685f},
    {0.30336306855701334f, 0.31069018381971025f, 0.34706905548456934f},
    {0.3497803035647553f, 0.7550733183777648f, 0.8359157407131244f},
    {0.7284082540812681f, 0.46003668970832023f, 0.7784477155532021f},
    {0.6387895835511737f, 0.7838888089296248f, 0.13992052635492813f},
    {0.6926469923607372f, 0.9789049038091554f, 0.9415638766630167f},
    {0.5961950258383534f, 0.2350179587541994f, 0.3993797150417415f},
    {0.8292154506770933f, 0.3886955288063535f, 0.10338105319085378f},
    {0.9563741679106463f, 0.6886297149593317f, 0.0613696487498131f},
    {0.6514459789061762f, 0.16987566283229272f, 0.4282489223520687f},
    {0.5552742203920764f, 0.9606061234885876f, 0.39019734994192734f},
    {0.7371573889770843f, 0.18888068839474959f, 0.9250300455947945f},
    {0.8749092383047683f, 0.8430768860896395f, 0.07079153706895258f},
    {0.578425848054748f, 0.701318523475487f, 0.8119091892812222f},
    {0.591991037884033f, 0.38029947504994166f, 0.41317011386154456f},
    {0.6534923609428209f, 0.6455657152371417f, 0.0614196239740038f},
    {0.3451567047951023f, 0.6218433569785623f, 0.8634182074267127f},
    {0.6078201568094201f, 0.9592173820107469f, 0.5726454408428012f},
    {0.15383464840319971f, 0.38800728764974124f, 0.6354466895531159f},
    {0.004224707236678893f, 0.6426300318044014f, 0.891966376819072f},
    {0.33465162806093274f, 0.6783101235391757f, 0.5204927337804748f},
    {0.1466510550316653f, 0.9007101111346817f, 0.06920887005391752f},
    {0.13058139973788951f, 0.8905846552544859f, 0.34873072330858124f},
    {0.32782876085364787f, 0.9800986953297726f, 0.25080507493172166f},
    {0.9702095156295429f, 0.7744096178933091f, 0.6509099400603109f},
    {0.6995303125452893f, 0.011939930118684217f, 0.9307544979570004f},
    {0.21428671841128966f, 0.15330525208211687f, 0.06686002378347355f},
    {0.7810704052481979f, 0.655588585056865f, 0.3256743516225995f},
    {0.34988768084008603f, 0.14847612929339737f, 0.40788184649978587f},
    {0.050088654849334224f, 0.6661748292616386f, 0.2528134983069227f},
    {0.8877198355406147f, 0.06697746149045136f, 0.8653446361613806f},
    {0.38110992844875036f, 0.5805528998159487f, 0.7797978110399897f},
    {0.36933749058119125f, 0.42384641118832345f, 0.7734273752319573f},
    {0.7566884468464965f, 0.11540721847068325f, 0.7190881356838752f},
    {0.897036703935267f, 0.971240136430805f, 0.053454591901462734f},
    {0.8525785726895604f, 0.2896970180236441f, 0.1948397541968463f},
    {0.92913457037622f, 0.6422422897539087f, 0.3340356209363955f},
    {0.33766618757314726f, 0.5624106608366646f, 0.12276261264230093f},
    {0.07298858869975955f, 0.36683491462724993f, 0.5140365722230854f},
    {0.8200851610586948f, 0.517233129550697f, 0.8008050993052976f},
    {0.4968401952308147f, 0.13678758850008255f, 0.9603138808498952f},
    {0.7129343165961775f, 0.02056614499002085f, 0.9005879508120279f},
    {0.9694742523806401f, 0.9702447952713502f, 0.024934500460719766f},
    {0.2267030308146578f, 0.6093483976680251f, 0.52173297320995f},
    {0.8481810775150166f, 0.3842670238996042f, 0.03183212099554544f},
    {0.621599068517245f, 0.9124507786937237f, 0.6889872601853818f},
    {0.8607473335618021f, 0.07357948700118311f, 0.6995979645884909f},
    {0.7984388312777491f, 0.6877597469972749f, 0.7802626799523236f},
    {0.9552236394148551f, 0.890600200046312f, 0.5131260628749377f},
    {0.5298260085887335f, 0.6908072107089124f, 0.16536621533809603f},
    {0.7772774357746055f, 0.9662017070453428f, 0.8718375589009187f},
    {0.7192312456444377f, 0.8927505643933604f, 0.012196139208832446f},
    {0.6080106420890877f, 0.6231559047114246f, 0.10665968072582266f},
    {0.004218225823073851f, 0.9222130862284169f, 0.1208884389573941f},
    {0.00274326243378753f, 0.852410637475715f, 0.029818694958526182f},
    {0.7283060387685314f, 0.8067960374400429f, 0.24324980725866607f},
    {0.1115204054177944f, 0.22039827357609376f, 0.33270143377502426f},
    {0.09972079084553209f, 0.08094743083893996f, 0.09881999897813498f},
    {0.05171864580931862f, 0.8018257048021407f, 0.7126973534425668f},
    {0.428959085578393f, 0.6241707265440597f, 0.9110640994944025f},
    {0.312790544028539f, 0.05710468719411199f, 0.40793622599580326f},
    {0.6943803125831154f, 0.12114846837717386f, 0.7391287845049219f},
    {0.8563271927101184f, 0.6680479280105364f, 0.0891332487216262f},
    {0.9291371089848626f, 0.6338966092902273f, 0.05488187994568561f},
    {0.7898992764380711f, 0.01909549645409514f, 0.7230931607568886f},
    {0.15693953709837571f, 0.1834331848591354f, 0.5962946820638685f},
    {0.09805656463696866f, 0.7745837540752002f, 0.32012323881597216f},
    {0.2545286250378097f, 0.9055998045781425f, 0.1680596712235618f},
    {0.2946454423362693f, 0.033019860729181616f, 0.8436167369798112f},
    {0.7671642137700407f, 0.9947310578428864f, 0.27068275024613775f},
    {0.8960948709339388f, 0.3054944473843747f, 0.9003400467273743f},
    {0.887167705557818f, 0.04174775564537614f, 0.023453860381219105f},
    {0.8955690695545836f, 0.5526255219718645f, 0.7766426587470275f},
    {0.7969032539507577f, 0.5412723098802467f, 0.2739497760594608f},
    {0.024549123517983773f, 0.5315718292563267f, 0.030816755579450295f},
    {0.0692859232693025f, 0.17041131427331369f, 0.4168790322258952f},
    {0.9316962861670711f, 0.5366689751210622f, 0.8277162741275317f},
    {0.6157563160204369f, 0.6879127476183661f, 0.38732376398813084f},
    {0.5442881037623789f, 0.566501717277981f, 0.2917773865951766f},
    {0.7182008337900609f, 0.9181097509852861f, 0.7068646781470372f},
    {0.4278427235733512f, 0.39260570488075675f, 0.047908036603587334f},
    {0.15408133161197002f, 0.5057158402534847f, 0.4555940328187523f},
    {0.7084500085539918f, 0.20730456002013609f, 0.3373127389495427f},
    {0.6735552898459425f, 0.8987815433338199f, 0.34703403111782394f},
    {0.7856982671216963f, 0.7357809725192843f, 0.4039287189303675f},
    {0.8644805093894239f, 0.46528183560721637f, 0.7187225821376186f},
    {0.45234495023105226f, 0.5994303796841106f, 0.198912716419543f},
    {0.8641450982493037f, 0.6494623676372437f, 0.7270020686325259f},
    {0.4245629453414176f, 0.18442067598861878f, 0.7016423342283974f},
    {0.3316929651732644f, 0.21868583079327553f, 0.5965249619434845f},
    {0.7460384278581733f, 0.2946929885000049f, 0.2824452197818982f},
    {0.2919543903633295f, 0.8081139387019008f, 0.0897275377638862f},
    {0.40699033326612744f, 0.3085112741299718f, 0.42325365213910593f},
    {0.23097462805919589f, 0.4589701493399654f, 0.4293335707615408f},
    {0.3694782130156854f, 0.3273241800129426f, 0.67181214974846f},
    {0.3315505385541684f, 0.4754941906471706f, 0.03961323951299989f},
    {0.5485487127904544f, 0.536139246491255f, 0.054048457960203744f},
    {0.28270192544691486f, 0.1812574048585217f, 0.6407008260619754f},
    {0.8505219043806931f, 0.10986032660040401f, 0.8409536696735895f},
    {0.281157603441184f, 0.8330354955404438f, 0.567466237766066f},
    {0.9792695517802339f, 0.9630644984458311f, 0.9614098394443065f},
    {0.9190954230375934f, 0.9338222770835688f, 0.9884638938273446f},
    {0.946271210659881f, 0.9040148075325474f, 0.9306458940339445f},
    {0.9471572772734405f, 0.989670432926029f, 0.9585782226827051f},
    {0.9656048949461008f, 0.949751264713645f, 0.9214510692605884f},
    {0.9916275209337916f, 0.9459612779536327f, 0.9979868529860259f},
    {0.997479842507994f, 0.9538585002951966f, 0.9637382808087588f},
    {0.9149857085004401f, 0.9010843114959556f, 0.9538961786350197f},
    {0.9201990049118085f, 0.9836938603211449f, 0.9655152985641049f},
    {0.9326212544277089f, 0.9703374244168818f, 0.9321114303629425f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 25: collinear", "[votess]") {

  const int k = 127;
  std::vector<std::array<float, 3>> xyzset = {
    {0.01f, 0.5f, 0.5f},
    {0.017716535433070866f, 0.5f, 0.5f},
    {0.02543307086614173f, 0.5f, 0.5f},
    {0.0331496062992126f, 0.5f, 0.5f},
    {0.040866141732283465f, 0.5f, 0.5f},
    {0.04858267716535433f, 0.5f, 0.5f},
    {0.05629921259842519f, 0.5f, 0.5f},
    {0.06401574803149605f, 0.5f, 0.5f},
    {0.07173228346456692f, 0.5f, 0.5f},
    {0.07944881889763779f, 0.5f, 0.5f},
    {0.08716535433070866f, 0.5f, 0.5f},
    {0.09488188976377952f, 0.5f, 0.5f},
    {0.10259842519685038f, 0.5f, 0.5f},
    {0.11031496062992124f, 0.5f, 0.5f},
    {0.11803149606299211f, 0.5f, 0.5f},
    {0.12574803149606298f, 0.5f, 0.5f},
    {0.13346456692913386f, 0.5f, 0.5f},
    {0.1411811023622047f, 0.5f, 0.5f},
    {0.1488976377952756f, 0.5f, 0.5f},
    {0.15661417322834645f, 0.5f, 0.5f},
    {0.16433070866141733f, 0.5f, 0.5f},
    {0.17204724409448818f, 0.5f, 0.5f},
    {0.17976377952755906f, 0.5f, 0.5f},
    {0.18748031496062992f, 0.5f, 0.5f},
    {0.19519685039370077f, 0.5f, 0.5f},
    {0.20291338582677165f, 0.5f, 0.5f},
    {0.2106299212598425f, 0.5f, 0.5f},
    {0.2183464566929134f, 0.5f, 0.5f},
    {0.22606299212598424f, 0.5f, 0.5f},
    {0.23377952755905512f, 0.5f, 0.5f},
    {0.24149606299212598f, 0.5f, 0.5f},
    {0.24921259842519686f, 0.5f, 0.5f},
    {0.2569291338582677f, 0.5f, 0.5f},
    {0.2646456692913386f, 0.5f, 0.5f},
    {0.2723622047244094f, 0.5f, 0.5f},
    {0.2800787401574803f, 0.5f, 0.5f},
    {0.2877952755905512f, 0.5f, 0.5f},
    {0.29551181102362206f, 0.5f, 0.5f},
    {0.3032283464566929f, 0.5f, 0.5f},
    {0.31094488188976377f, 0.5f, 0.5f},
    {0.31866141732283465f, 0.5f, 0.5f},
    {0.3263779527559055f, 0.5f, 0.5f},
    {0.33409448818897636f, 0.5f, 0.5f},
    {0.34181102362204724f, 0.5f, 0.5f},
    {0.3495275590551181f, 0.5f, 0.5f},
    {0.35724409448818895f, 0.5f, 0.5f},
    {0.3649606299212598f, 0.5f, 0.5f},
    {0.3726771653543307f, 0.5f, 0.5f},
    {0.38039370078740153f, 0.5f, 0.5f},
    {0.3881102362204724f, 0.5f, 0.5f},
    {0.3958267716535433f, 0.5f, 0.5f},
    {0.4035433070866142f, 0.5f, 0.5f},
    {0.411259842519685f, 0.5f, 0.5f},
    {0.4189763779527559f, 0.5f, 0.5f},
    {0.42669291338582677f, 0.5f, 0.5f},
    {0.43440944881889765f, 0.5f, 0.5f},
    {0.4421259842519685f, 0.5f, 0.5f},
    {0.44984251968503935f, 0.5f, 0.5f},
    {0.45755905511811024f, 0.5f, 0.5f},
    {0.46527559055118106f, 0.5f, 0.5f},
    {0.47299212598425194f, 0.5f, 0.5f},
    {0.4807086614173228f, 0.5f, 0.5f},
    {0.4884251968503937f, 0.5f, 0.5f},
    {0.49614173228346453f, 0.5f, 0.5f},
    {0.5038582677165354f, 0.5f, 0.5f},
    {0.5115748031496062f, 0.5f, 0.5f},
    {0.5192913385826772f, 0.5f, 0.5f},
    {0.527007874015748f, 0.5f, 0.5f},
    {0.5347244094488188f, 0.5f, 0.5f},
    {0.5424409448818898f, 0.5f, 0.5f},
    {0.5501574803149606f, 0.5f, 0.5f},
    {0.5578740157480315f, 0.5f, 0.5f},
    {0.5655905511811024f, 0.5f, 0.5f},
    {0.5733070866141732f, 0.5f, 0.5f},
    {0.5810236220472441f, 0.5f, 0.5f},
    {0.5887401574803149f, 0.5f, 0.5f},
    {0.5964566929133858f, 0.5f, 0.5f},
    {0.6041732283464567f, 0.5f, 0.5f},
    {0.6118897637795275f, 0.5f, 0.5f},
    {0.6196062992125984f, 0.5f, 0.5f},
    {0.6273228346456693f, 0.5f, 0.5f},
    {0.6350393700787401f, 0.5f, 0.5f},
    {0.6427559055118109f, 0.5f, 0.5f},
    {0.6504724409448819f, 0.5f, 0.5f},
    {0.6581889763779527f, 0.5f, 0.5f},
    {0.6659055118110236f, 0.5f, 0.5f},
    {0.6736220472440945f, 0.5f, 0.5f},
    {0.6813385826771653f, 0.5f, 0.5f},
    {0.6890551181102362f, 0.5f, 0.5f},
    {0.6967716535433071f, 0.5f, 0.5f},
    {0.7044881889763779f, 0.5f, 0.5f},
    {0.7122047244094488f, 0.5f, 0.5f},
    {0.7199212598425196f, 0.5f, 0.5f},
    {0.7276377952755905f, 0.5f, 0.5f},
    {0.7353543307086614f, 0.5f, 0.5f},
    {0.7430708661417322f, 0.5f, 0.5f},
    {0.7507874015748031f, 0.5f, 0.5f},
    {0.758503937007874f, 0.5f, 0.5f},
    {0.7662204724409448f, 0.5f, 0.5f},
    {0.7739370078740158f, 0.5f, 0.5f},
    {0.7816535433070866f, 0.5f, 0.5f},
    {0.7893700787401574f, 0.5f, 0.5f},
    {0.7970866141732283f, 0.5f, 0.5f},
    {0.8048031496062992f, 0.5f, 0.5f},
    {0.81251968503937f, 0.5f, 0.5f},
    {0.8202362204724409f, 0.5f, 0.5f},
    {0.8279527559055118f, 0.5f, 0.5f},
    {0.8356692913385826f, 0.5f, 0.5f},
    {0.8433858267716535f, 0.5f, 0.5f},
    {0.8511023622047243f, 0.5f, 0.5f},
    {0.8588188976377953f, 0.5f, 0.5f},
    {0.8665354330708661f, 0.5f, 0.5f},
    {0.8742519685039369f, 0.5f, 0.5f},
    {0.8819685039370079f, 0.5f, 0.5f},
    {0.8896850393700787f, 0.5f, 0.5f},
    {0.8974015748031495f, 0.5f, 0.5f},
    {0.9051181102362205f, 0.5f, 0.5f},
    {0.9128346456692913f, 0.5f, 0.5f},
    {0.9205511811023621f, 0.5f, 0.5f},
    {0.928267716535433f, 0.5f, 0.5f},
    {0.9359842519685039f, 0.5f, 0.5f},
    {0.9437007874015747f, 0.5f, 0.5f},
    {0.9514173228346456f, 0.5f, 0.5f},
    {0.9591338582677165f, 0.5f, 0.5f},
    {0.9668503937007874f, 0.5f, 0.5f},
    {0.9745669291338582f, 0.5f, 0.5f},
    {0.982283464566929f, 0.5f, 0.5f},
    {0.99f, 0.5f, 0.5f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

TEST_CASE("votess regression 26: concentric", "[votess]") {

  const int k = 99;
  std::vector<std::array<float, 3>> xyzset = {
    {0.40238984382618886f, 0.4858841897492403f, 0.5165227513655791f},
    {0.45319193992700685f, 0.43960761148989275f, 0.5645117425144239f},
    {0.5371342147474568f, 0.42008539213144347f, 0.4527273277219851f},
    {0.575627635974477f, 0.4898024672163182f, 0.5646256218696404f},
    {0.5761257374745464f, 0.5497550934526335f, 0.4584151136892723f},
    {0.41437304308174056f, 0.4617709328966436f, 0.46526438891676697f},
    {0.5690966213792733f, 0.4296242377026381f, 0.5165199574767785f},
    {0.4994544683607957f, 0.4002386359636483f, 0.4931172214304727f},
    {0.4012603611856268f, 0.4909959304328567f, 0.5130157772736466f},
    {0.5007324256162516f, 0.5807998785115984f, 0.4410861375801281f},
    {0.4660455011980813f, 0.5593764477373045f, 0.4270511859917541f},
    {0.4717334391104149f, 0.40486432803177697f, 0.5122558334938936f},
    {0.5967000213718129f, 0.4848475588614399f, 0.5204819284793548f},
    {0.402850956359529f, 0.4865916867874049f, 0.4804480063283865f},
    {0.4457883122892459f, 0.5032943642960391f, 0.4160342922411973f},
    {0.42080900378791436f, 0.4542291806265283f, 0.5404205172260137f},
    {0.566515856158264f, 0.49582547421814016f, 0.42544656806001674f},
    {0.4338016412037604f, 0.45707528240522066f, 0.4385569701911375f},
    {0.44102947279745097f, 0.5600713521010159f, 0.5539806407724954f},
    {0.406122407540914f, 0.5343294474394634f, 0.4970868105817029f},
    {0.5128024908302468f, 0.40799470209963457f, 0.4629713437077922f},
    {0.5450296833341488f, 0.41853473336885416f, 0.5365477489257903f},
    {0.4266148568799781f, 0.4525899047085782f, 0.45134916615604415f},
    {0.5249455536339602f, 0.442330298520385f, 0.5777941185768392f},
    {0.5595664945118436f, 0.501872289404937f, 0.41969852265397184f},
    {0.5023146631902892f, 0.40205810850762735f, 0.5200506415162164f},
    {0.557005385640607f, 0.5477881973696428f, 0.5668331818794059f},
    {0.48579600713131416f, 0.5868749050817639f, 0.45255532217813205f},
    {0.5528928768249394f, 0.5837376333683115f, 0.48620317648674066f},
    {0.45530494585134845f, 0.5412821733458083f, 0.579360785646916f},
    {0.5838751174340207f, 0.550931887386808f, 0.5192589595421649f},
    {0.5594267916174732f, 0.43344339880385363f, 0.4548483081682365f},
    {0.4757815827446316f, 0.5749911240094983f, 0.5615613481450571f},
    {0.47839473690669526f, 0.40402393805841147f, 0.48206098829775035f},
    {0.5529126423158678f, 0.549049962365336f, 0.430758729971843f},
    {0.42639022512292285f, 0.5475079318398884f, 0.548214079425439f},
    {0.5877763558686151f, 0.45353752212147047f, 0.48831456035001664f},
    {0.5642613365974147f, 0.42439426715745626f, 0.5124198945267526f},
    {0.541617487292478f, 0.4268098907089608f, 0.44604453082933887f},
    {0.4963720485354834f, 0.52329269114442f, 0.40281827071191945f},
    {0.4971950912712665f, 0.5908148834161182f, 0.45822932323818133f},
    {0.4950522389358355f, 0.4334219554836245f, 0.5744505449867726f},
    {0.4254375728759569f, 0.44675117555890975f, 0.5400625405711335f},
    {0.4369484507997593f, 0.5467563768426921f, 0.561954365205317f},
    {0.5563071992596643f, 0.5554429774178661f, 0.561282750971007f},
    {0.525169120951069f, 0.5915988802050216f, 0.4687564327302952f},
    {0.445210173461935f, 0.5206775825482026f, 0.5810586977929637f},
    {0.4937605283234359f, 0.5683524492440597f, 0.42727440838648617f},
    {0.44314711628813186f, 0.510917816395802f, 0.5815386466578417f},
    {0.4182554921651931f, 0.5061541934287568f, 0.44272905324611234f},
    {0.4983514724043862f, 0.5999278201844096f, 0.49657755789547864f},
    {0.5144801354161619f, 0.5489227756463989f, 0.586005160899691f},
    {0.5471978114601266f, 0.546559418153184f, 0.5748637908111212f},
    {0.5057819205349929f, 0.5914425462385027f, 0.5400603311562241f},
    {0.5929320432737852f, 0.4641949307267818f, 0.4909649378917823f},
    {0.5590028003878984f, 0.5526716922494489f, 0.4388088047022682f},
    {0.42090339547062405f, 0.44733874351785785f, 0.4688468425734157f},
    {0.45875359733193655f, 0.5215372120955353f, 0.4114851268876473f},
    {0.5261279746996754f, 0.5489677623156233f, 0.4168165449629931f},
    {0.5098562184827795f, 0.5843830578085897f, 0.4472519714862068f},
    {0.5804953298427695f, 0.44161677711062597f, 0.4894216656058998f},
    {0.45179472881757676f, 0.5464101678854099f, 0.5743125033024531f},
    {0.4050553176342442f, 0.5041082618333514f, 0.46887718722264377f},
    {0.47796518072501293f, 0.4790996472098438f, 0.40472333972705765f},
    {0.4992268324887463f, 0.5007320056982958f, 0.40000566826235995f},
    {0.42348237327960636f, 0.4477452743285254f, 0.5376097918909083f},
    {0.5252368212275599f, 0.4540173722058447f, 0.41486069770386674f},
    {0.5101981415971379f, 0.40102744461046513f, 0.4899784638088678f},
    {0.44696155029871804f, 0.41547852966664195f, 0.5065607854691232f},
    {0.5663387820497093f, 0.4886346696885639f, 0.5739594163245838f},
    {0.44208600072128046f, 0.5010170640091117f, 0.5815164662405445f},
    {0.5504619201725577f, 0.5862700619302109f, 0.5033273152925442f},
    {0.5819124577575766f, 0.5456731071537237f, 0.534703264213006f},
    {0.453257509677628f, 0.4499337856053687f, 0.42714045172625775f},
    {0.5140277023975502f, 0.5818364371547616f, 0.4442683113546655f},
    {0.4679107926727837f, 0.43546682417059923f, 0.5693235312897617f},
    {0.5905803918303097f, 0.4847211254338113f, 0.539518965166844f},
    {0.447324846281595f, 0.4647135948870328f, 0.4226682613996946f},
    {0.4175414341375169f, 0.5369758208024765f, 0.5428179120449104f},
    {0.5439064171082625f, 0.5366609168345151f, 0.4179743716051621f},
    {0.5424514575666826f, 0.5857371989683587f, 0.4708966245338413f},
    {0.40585378862598737f, 0.48639836143670945f, 0.5308461717610685f},
    {0.5803678010650195f, 0.5169768108692174f, 0.4429666374418948f},
    {0.5318629003180697f, 0.4818623601887503f, 0.5930364530998368f},
    {0.4588917910276669f, 0.43450437492078725f, 0.5634069258880305f},
    {0.445982744884555f, 0.41774186454397905f, 0.48223105796363097f},
    {0.5345375239915049f, 0.5609987195107383f, 0.5713184103481457f},
    {0.40539759680797943f, 0.48958045477483736f, 0.5306890597378799f},
    {0.48327873502800217f, 0.572061460671916f, 0.4327129642236624f},
    {0.458343810069212f, 0.5191163707425493f, 0.5888781537279185f},
    {0.444155013493388f, 0.5384928062641403f, 0.426517748074874f},
    {0.5608888976299853f, 0.5768541407012168f, 0.48035354478582104f},
    {0.5077415927308162f, 0.4445226763682778f, 0.4171607924672663f},
    {0.44061058552145166f, 0.4586793674890335f, 0.430967378893824f},
    {0.48540905062768996f, 0.5797495923448229f, 0.4414585043131862f},
    {0.5298873032390983f, 0.4985180247248312f, 0.5954177805986808f},
    {0.5725616836148955f, 0.5227577997826238f, 0.5649375439944091f},
    {0.5633453099358148f, 0.5609289071363267f, 0.547697379218448f},
    {0.5122318926772087f, 0.5143772953478151f, 0.5982022106676573f},
    {0.5689226558814546f, 0.43607243951119634f, 0.5341018257018145f},
  };

  for (const auto& gr : {1,2,3,4,6,8,16,24,32} ) {
    test_votess(xyzset, k, gr);
  }

}

///////////////////////////////////////////////////////////////////////////////
/// Internal Functions                                                      ///
///////////////////////////////////////////////////////////////////////////////

#include <iostream>
class __internal__suppress_stdout {
  public:
    __internal__suppress_stdout() : buf(std::cout.rdbuf()) {
      std::cout.rdbuf(__tmp__buf.rdbuf());
    }
    ~__internal__suppress_stdout() {
      std::cout.rdbuf(buf);
    }
  private:
    std::streambuf* buf;
    std::stringstream __tmp__buf;
};

#include <voro++.hh>
template <typename T>
static std::pair<std::vector<std::array<T, 3>>, std::vector<std::vector<int>>>
run_voro(
  const std::vector<std::array<T,3>>& xyzset,
  const struct votess::vtargs vtargs
) {
  std::vector<std::array<T, 3>> coords;
  std::vector<std::vector<int>> neighbor_list;
  const double tolerance = 1e-8;

  using namespace voro;
  container con(
    0, 1, 0, 1, 0, 1,
    vtargs.xyzset.grid_resolution,
    vtargs.xyzset.grid_resolution,
    vtargs.xyzset.grid_resolution,
    false, false, false,
    xyzset.size()
  );
  
  for (size_t i = 0; i < xyzset.size(); i++) {
    con.put(i,xyzset[i][0],xyzset[i][1], xyzset[i][2]);
  }

  c_loop_all cl(con);
  voronoicell_neighbor c;
  if (cl.start()) do if (con.compute_cell(c, cl)) {
    std::vector<int> neighbors;
    std::vector<int> filtered_neighbors;
    std::vector<double> face_areas;
    double x, y, z;

    cl.pos(x, y, z);
    c.neighbors(neighbors);
    c.face_areas(face_areas);

    for (size_t i = 0; i < face_areas.size(); i++) {
      if (face_areas[i] >= tolerance) {
        filtered_neighbors.push_back(neighbors[i]);
      }
    }

    neighbor_list.push_back(filtered_neighbors);
    coords.push_back({
      static_cast<T>(x),
      static_cast<T>(y),
      static_cast<T>(z)
    });

  } while(cl.inc());

  return {coords, neighbor_list};
}

template <typename T>
static void run_test(
  std::vector<std::array<T,3>>& xyzset,
  struct votess::vtargs vtargs,
  const enum votess::device device
) {
    __internal__suppress_stdout s; // to preventstdout 

    (void)xyzset::sort<int,T>(xyzset, vtargs.xyzset);

    auto [vcoord, vneighbor] = run_voro<T>(xyzset, vtargs);
    auto dnn = votess::tesellate<int, T>(xyzset, vtargs, device);

    std::vector<int> test_dnn(0);
    std::vector<int> test_vneighbor(0);

    for (size_t i = 0; i < xyzset.size(); i++) {
        auto it = std::find_if(
            vcoord.begin(),
            vcoord.end(),
            [&](const std::array<T, 3>& elem) {
                return (elem[0] == xyzset[i][0]) &&
                       (elem[1] == xyzset[i][1]) &&
                       (elem[2] == xyzset[i][2]);
            });

        if (it == vcoord.end()) {
            CAPTURE(i);
            WARN("Matching coordinate not found in vcoord");
            continue;
        }

        const size_t index = std::distance(vcoord.begin(), it);
        CAPTURE(index);

        test_dnn.clear();
        test_vneighbor.clear();
        for (const auto& j : vneighbor[index]) {
            if (j < 0) continue;
            test_vneighbor.push_back(j);
        }
        for (size_t j = 0; j < dnn[i].size(); j++) {
            test_dnn.push_back(dnn[i][j]);
        }

        std::sort(test_vneighbor.begin(), test_vneighbor.end());
        std::sort(test_dnn.begin(), test_dnn.end());

        CAPTURE(test_vneighbor, test_dnn);

        bool cond = std::includes(
          test_dnn.begin(),
          test_dnn.end(),
          test_vneighbor.begin(),
          test_vneighbor.end()
        );
        CAPTURE(cond);
        REQUIRE(cond);
    }
}

template <typename T>
static void test_votess(
  std::vector<std::array<T,3>>& xyzset,
  const int k,
  const int gr
) {
  SECTION("(CPU) case : grid_resolution = " + std::to_string(gr)) {
    struct votess::vtargs vtargs(k,gr);
    run_test(xyzset, vtargs, votess::device::cpu);
  }
  SECTION("(GPU) case : grid_resolution = " + std::to_string(gr)) {
    struct votess::vtargs vtargs(k,gr);
    run_test(xyzset, vtargs, votess::device::gpu);
  }
}

///////////////////////////////////////////////////////////////////////////////
/// End                                                                     ///
///////////////////////////////////////////////////////////////////////////////